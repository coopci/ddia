/*
  filename: angular.integralui.treeview.min.js
  version : 3.2.5
  Copyright © 2014-2017 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui").factory("IntegralUITreeViewService",["$rootScope",function(c){var p=null;return{addItem:function(e,k,n){c.$broadcast(e+"-add-item",k,n)},clearItems:function(e,k){c.$broadcast(e+"-clear-items",k)},insertItemAt:function(e,k,n,g){c.$broadcast(e+"-insert-item-at",k,n,g)},insertItemBefore:function(e,k,n){c.$broadcast(e+"-insert-item-before",k,n)},insertItemAfter:function(e,k,n){c.$broadcast(e+"-insert-item-after",k,n)},removeItem:function(e,k){c.$broadcast(e+"-remove-item",
k)},removeItemAt:function(e,k,n){c.$broadcast(e+"-remove-item-at",k,n)},exportToJSON:function(e,k,n,g){c.$broadcast(e+"-export-json",k,n,g);e=this.getTempData();this.clearTempData();return e?e:""},loadData:function(e,k,n,g,h){c.$broadcast(e+"-load-data",k,n,g,h);k=this.getTempData();this.clearTempData();return k?k:null},openEditor:function(e,k){c.$broadcast(e+"-open-editor",k)},closeEditor:function(e,k){c.$broadcast(e+"-close-editor",k)},collapse:function(e,k){c.$broadcast(e+"-collapse",k)},expand:function(e,
k){c.$broadcast(e+"-expand",k)},toggle:function(e,k){c.$broadcast(e+"-toggle",k)},findItemById:function(e,k){c.$broadcast(e+"-find-item-by-id",k);var n=this.getTempData();this.clearTempData();return n?n:null},findItemByText:function(e,k){c.$broadcast(e+"-find-item-by-text",k);var n=this.getTempData();this.clearTempData();return n?n:null},getItemParent:function(e,k){c.$broadcast(e+"-get-item-parent",k);var n=this.getTempData();this.clearTempData();return n?n:null},getItemAt:function(e,k){c.$broadcast(e+
"-get-item-at",k);var n=this.getTempData();this.clearTempData();return n?n:null},filter:function(e,k){c.$broadcast(e+"-filter",k)},focus:function(e,k){c.$broadcast(e+"-focus",k)},clearTempData:function(){p=null},ensureVisible:function(e,k,n){c.$broadcast(e+"-ensure-visible",k,n)},getCheckList:function(e,k){c.$broadcast(e+"-get-check-list",k);var n=this.getTempData();this.clearTempData();return n?n:[]},getItemLevel:function(e,k){c.$broadcast(e+"-get-item-level",k);var n=this.getTempData();this.clearTempData();
return n?n:0},getFlatList:function(e,k){c.$broadcast(e+"-get-flat-list",k);var n=this.getTempData();this.clearTempData();return n?n:[]},getFullPath:function(e,k){c.$broadcast(e+"-get-full-path",k);var n=this.getTempData();this.clearTempData();return n?n:""},getList:function(e,k,n){c.$broadcast(e+"-get-list",k,n);e=this.getTempData();this.clearTempData();return e?e:[]},getTempData:function(){return p},setTempData:function(c){p=c},beginLoad:function(e,k,n){c.$broadcast(e+"-begin-load",k,n)},endLoad:function(e,
k){c.$broadcast(e+"-end-load",k)},moveItem:function(e,k,n,g,h){c.$broadcast(e+"-move-item",k,n,g,h)},clearSelection:function(e){c.$broadcast(e+"-clear-selection")},selectedItem:function(e,k){if(k)c.$broadcast(e+"-set-selected-item",k);else{c.$broadcast(e+"-get-selected-item");var n=this.getTempData();this.clearTempData();return n?n:null}},selectedItems:function(e,k){if(k)c.$broadcast(e+"-set-selected-items",k);else{c.$broadcast(e+"-get-selected-items");var n=this.getTempData();this.clearTempData();
return n?n:null}},getScrollPos:function(e){c.$broadcast(e+"-get-scroll-pos");e=this.getTempData();this.clearTempData();return e?e:{x:0,y:0}},setScrollPos:function(e,k){c.$broadcast(e+"-set-scroll-pos",k)},scrollTo:function(e,k,n){c.$broadcast(e+"-scroll-to",k,n)},sort:function(e,k,n){c.$broadcast(e+"-sort",k,n)},updateCheckValues:function(e,k){c.$broadcast(e+"-update-check",k)},refresh:function(e,k,n){c.$broadcast(e+"-refresh",k,n)},resumeLayout:function(e){c.$broadcast(e+"-resume-layout")},suspendLayout:function(e){c.$broadcast(e+
"-suspend-layout")},updateLayout:function(e){c.$broadcast(e+"-update-layout")},updateView:function(e){c.$broadcast(e+"-update-view")}}}]).controller("IntegralUITreeViewController",["$scope","$element","$timeout","$window","$q","IntegralUIInternalService","IntegralUIDataService","IntegralUITreeViewService","IntegralUIDragDrop","IntegralUIFilter",function(c,p,e,k,n,g,h,m,T,a){var b=this;b.hoverItem=null;this.suppressProcess=!1;b.defaultCheckBoxStyle={general:"iui-checkbox",box:{general:"iui-checkbox-box",
disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}};b.defaultStyle={general:"iui-treeview",item:{general:{disabled:"iui-treeview-item-disabled",focused:"iui-treeview-item-focused",normal:"iui-treeview-item",hovered:"iui-treeview-item-hovered",selected:"iui-treeview-item-selected"},checkBox:{general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",
indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}},expandBox:{general:"iui-treeview-expand-box",animated:"iui-treeview-expand-box-load",expanded:"iui-treeview-expand-box-open",collapsed:"iui-treeview-expand-box-close"},content:{disabled:"iui-treeview-item-content-disabled",focused:"iui-treeview-item-content-focused",normal:"iui-treeview-item-content",hovered:"iui-treeview-item-content-hovered",selected:"iui-treeview-item-content-selected"},fixed:{disabled:"iui-treeview-item-fixed-disabled",
normal:"iui-treeview-item-fixed",hovered:"iui-treeview-item-fixed-hovered"}}};b.defaultCheckBoxSettings={autoCheck:!1,style:b.defaultCheckBoxStyle,threeState:!1};this.updateOptions=function(d){d?(b.options={allowAnimation:g.isFieldAvailable(d.allowAnimation,!0),allowDrag:g.isFieldAvailable(d.allowDrag,!1),allowDrop:g.isFieldAvailable(d.allowDrop,!0),allowFocus:g.isFieldAvailable(d.allowFocus,!0),animationSpeed:200,autoCheck:g.isFieldAvailable(d.autoCheck,!1),autoExpand:g.isFieldAvailable(d.autoExpand,
!0),autoSize:g.isFieldAvailable(d.autoSize,!1),checkBoxSettings:b.defaultCheckBoxSettings,controlStyle:b.defaultStyle,editorSettings:{activate:"click"},enabled:g.isFieldAvailable(d.enabled,!0),hoverSelection:g.isFieldAvailable(d.hoverSelection,!1),indent:g.isFieldAvailable(d.indent,15),itemIcon:g.isFieldAvailable(d.itemIcon,""),itemSpacing:g.isFieldAvailable(d.itemSpacing,1),labelEdit:g.isFieldAvailable(d.labelEdit,!1),loadItems:[],maxItems:g.isFieldAvailable(d.maxItems,0),mouseWheelSpeed:g.isFieldAvailable(d.mouseWheelSpeed,
"normal"),pathSeparator:g.isFieldAvailable(d.pathSeparator,"\\"),rtl:g.isFieldAvailable(d.rtl,!1),selectedIndex:-1,selectedItem:g.isFieldAvailable(d.selectedItem,b.options.selectedItem?b.options.selectedItem:null),selectedItems:[],selectionMode:g.isFieldAvailable(d.selectionMode,"one"),showCheckBoxes:g.isFieldAvailable(d.showCheckBoxes,!1),showExpandBoxes:g.isFieldAvailable(d.showExpandBoxes,!0),showIcons:g.isFieldAvailable(d.showIcons,!0),showLines:g.isFieldAvailable(d.showLines,!1),showStatusIcons:g.isFieldAvailable(d.showStatusIcons,
!1),sorting:g.isFieldAvailable(d.sorting,"none")},b.updateDataFields(d.dataFields),b.updateControlStyle(d.controlStyle),b.updateCheckBoxSettings(d.checkBoxSettings),b.updateTemplateSettings(d.templateSettings)):(b.options={allowAnimation:!0,allowDrag:!1,allowDrop:!0,allowFocus:!0,animationSpeed:200,autoCheck:!1,autoExpand:!0,autoSize:!1,checkBoxSettings:b.defaultCheckBoxSettings,controlStyle:b.defaultStyle,editorSettings:{activate:"click"},enabled:!0,hoverSelection:!1,indent:15,itemIcon:"",itemSpacing:1,
labelEdit:!1,loadItems:[],maxItems:0,mouseWheelSpeed:"normal",pathSeparator:"\\",rtl:!1,selectedIndex:-1,selectedItem:null,selectedItems:[],selectionMode:"one",showCheckBoxes:!1,showExpandBoxes:!0,showIcons:!0,showLines:!1,showStatusIcons:!1,sorting:"none",templateSettings:{url:null}},b.updateDataFields())};b.options={};this.updateDataFields=function(d){b.options.dataFields=d?{allowDrag:d.allowDrag?d.allowDrag:"allowDrag",allowDrop:d.allowDrop?d.allowDrop:"allowDrop",allowEdit:d.allowEdit?d.allowEdit:
"allowEdit",allowFocus:d.allowFocus?d.allowFocus:"allowFocus",autoCheck:d.autoCheck?d.autoCheck:"autoCheck",checkBoxSettings:d.checkBoxSettings?d.checkBoxSettings:"checkBoxSettings",checked:d.checked?d.checked:"checked",checkState:d.checkState?d.checkState:"checkState",content:d.content?d.content:"content",contextMenu:d.contextMenu?d.contextMenu:"contextMenu",enabled:d.enabled?d.enabled:"enabled",expanded:d.expanded?d.expanded:"expanded",fixed:d.fixed?d.fixed:"fixed",fixChildren:d.fixChildren?d.fixChildren:
"fixChildren",hasChildren:d.hasChildren?d.hasChildren:"hasChildren",icon:d.icon?d.icon:"icon",id:d.id?d.id:"id",items:d.items?d.items:"items",pid:d.pid?d.pid:"pid",selected:d.selected?d.selected:"selected",showCheckBox:d.showCheckBox?d.showCheckBox:"showCheckBox",statusIcon:d.statusIcon?d.statusIcon:"statusIcon",style:d.style?d.style:"style",templateObj:d.templateObj?d.templateObj:"templateObj",text:d.text?d.text:"text",tooltip:d.tooltip?d.tooltip:"tooltip",value:d.value?d.value:"value"}:{allowDrag:"allowDrag",
allowDrop:"allowDrop",allowEdit:"allowEdit",allowFocus:"allowFocus",autoCheck:"autoCheck",checkBoxSettings:"checkBoxSettings",checked:"checked",checkState:"checkState",content:"content",contextMenu:"contextMenu",enabled:"enabled",expanded:"expanded",fixed:"fixed",fixChildren:"fixChildren",hasChildren:"hasChildren",icon:"icon",id:"id",items:"items",pid:"pid",selected:"selected",showCheckBox:"showCheckBox",statusIcon:"statusIcon",style:"style",templateObj:"templateObj",text:"text",tooltip:"tooltip",
value:"value"};b.dataObj&&b.dataObj.updateDataFields(b.getDataFields(b.options.dataFields))};this.updateTemplateSettings=function(d){b.options.templateSettings=d?{display:g.isFieldAvailable(d.display,"block"),url:g.isFieldAvailable(d.url,null)}:{display:"block",url:null}};b.updateOptions();c.$on(c.name+"-add-item",function(d,a,c){b.dataObj.insertAt(a,-1,c,b.itemIsAdded)});c.$on(c.name+"-clear-items",function(d,a){b.dataObj.clear(a,b.listIsCleared)});c.$on(c.name+"-insert-item-at",function(d,a,c,q){b.dataObj.insertAt(a,
c,q,b.itemIsAdded)});c.$on(c.name+"-insert-item-after",function(d,a,c){b.dataObj.insertByRef(a,c,!0,b.itemIsAdded)});c.$on(c.name+"-insert-item-before",function(d,a,c){b.dataObj.insertByRef(a,c,!1,b.itemIsAdded)});c.$on(c.name+"-remove-item",function(d,a){b.dataObj.removeAt(a,-1,null,b.itemIsRemoved)});c.$on(c.name+"-remove-item-at",function(d,a,c){b.dataObj.removeAt(null,a,c,b.itemIsRemoved)});this.listIsCleared=function(d){d||(b.clearPrevSelection(),b.options.selectedItem=null,b.setScrollPos({x:0,
y:0}));b.updateCurrentLayout()};this.itemIsAdded=function(){b.updateCurrentLayout()};this.itemIsRemoved=function(d){d&&(d[b.options.dataFields.selected]=!1,d==b.options.selectedItem&&(b.options.selectedItem=null));b.updateCurrentLayout()};this.objIsRemoved=function(){b.updateCurrentLayout()};this.getCheckValue=function(d){return"checked"==d[b.options.dataFields.checkState]?"checked":1==b.options.checkBoxSettings.threeState&&"indeterminate"==d[b.options.dataFields.checkState]?"indeterminate":"unchecked"};
this.changeCheckValue=function(d){if(1==b.options.autoCheck||1==b.options.checkBoxSettings.autoCheck){var a=b.getCheckValue(d);if(!1!==(1==b.options.checkBoxSettings.threeState?b.callCheckValueChanging(d,a):b.callCheckValueChanging(d,"checked"==a?!0:!1))){if(1==b.options.checkBoxSettings.threeState)switch(a){case "checked":a="unchecked";break;case "indeterminate":a="checked";break;case "unchecked":a="indeterminate"}else a="unchecked"==a||"indeterminate"==a?"checked":"unchecked";d[b.options.dataFields.checkState]=
a;d[b.options.dataFields.checked]="checked"==a?!0:!1;c.$apply()}}};this.callCheckValueChanging=function(d,a){var l=!0;b.allowEvents&&(l=1==b.options.checkBoxSettings.threeState?angular.isDefined(c.events)&&c.events.itemCheckstateChanging?c.events.itemCheckstateChanging({item:d,value:a}):c.itemCheckstateChanging({e:{item:d,value:a}}):angular.isDefined(c.events)&&c.events.itemCheckedChanging?c.events.itemCheckedChanging({item:d,value:a}):c.itemCheckedChanging({e:{item:d,value:a}}));return l};this.callCheckValueChanged=
function(d,a){b.allowEvents&&(retValue=1==b.options.checkBoxSettings.threeState?angular.isDefined(c.events)&&c.events.itemCheckstateChanged?c.events.itemCheckstateChanged({item:d,value:a}):c.itemCheckstateChanged({e:{item:d,value:a}}):angular.isDefined(c.events)&&c.events.itemCheckedChanged?c.events.itemCheckedChanged({item:d,value:a}):c.itemCheckedChanged({e:{item:d,value:a}}))};var w=[],H=!1;this.fillCheckList=function(d){if(b.allowEvents&&d&&1==b.options.checkBoxSettings.threeState&&!H){H=!0;w.length=
0;w.push({item:d,value:d[b.options.dataFields.checkState]});b.updateListChildItemCheckValue(d);b.updateListParentItemCheckValue(d);for(var a=0,a=0;a<w.length;a++)w[a].item[b.options.dataFields.checkState]=w[a].value;var c=e(function(){a==w.length&&(H=!1);e.cancel(c)},1)}};this.getItemCheckValue=function(d){for(var a="unchecked",c=!1,q=0;q<w.length;q++)if(w[q].item==d){c=!0;a=w[q].value;break}c||(a=d[b.options.dataFields.checkState]);return a};this.updateListParentItemCheckValue=function(d){for(d=
b.getParent(d);d;){var a=d[b.options.dataFields.items];if(a){for(var c=0,q=0,e=0;e<a.length;e++){var g=b.getItemCheckValue(a[e]);"checked"==g?c++:"indeterminate"==g&&q++}e={item:d};e.value=c==a.length?"checked":0<c||0<q?"indeterminate":"unchecked";w.push(e)}d=b.getParent(d)}};this.updateListChildItemCheckValue=function(d){if(d){var a=d[b.options.dataFields.items];if(a)for(var c=0;c<a.length;c++){var q={item:a[c]};"checked"==b.getItemCheckValue(d)?q.value="checked":q.value="unchecked";w.push(q);b.updateListChildItemCheckValue(a[c])}}};
this.updateParentItemCheckValue=function(d){for(d=b.getParent(d);d;){var a=d[b.options.dataFields.items];if(a){for(var c=0,q=0,e=0;e<a.length;e++)"checked"==a[e][b.options.dataFields.checkState]?c++:"indeterminate"==a[e][b.options.dataFields.checkState]&&q++;d[b.options.dataFields.checkState]=c==a.length?"checked":0<c||0<q?"indeterminate":"unchecked"}d=b.getParent(d)}};this.updateItemCheckValue=function(d,a){if("checked"==a||"unchecked"==a)d[b.options.dataFields.checkState]=a;var l=d[b.options.dataFields.items];
if(l&&0<l.length)for(var c=0;c<l.length;c++)b.updateItemCheckValue(l[c],d[b.options.dataFields.checkState]);void 0!=d[b.options.dataFields.checkState]&&(l=b.getParent(d))&&l[b.options.dataFields.checkState]!=d[b.options.dataFields.checkState]&&b.updateParentItemCheckValue(d)};this.updateCheckValues=function(d){if(1==b.options.checkBoxSettings.threeState){d=b.dataObj.getList(d);for(var a=0;a<d.length;a++)b.updateItemCheckValue(d[a])}};c.$on(c.name+"-update-check",function(d,a){b.updateCheckValues(a)});
c.$on(c.name+"-get-check-list",function(d,l){b.updateCheckValues();void 0==l&&(l=1==b.options.checkBoxSettings.threeState?"checked":!0);var c=1==b.options.checkBoxSettings.threeState?b.options.dataFields.checkState:b.options.dataFields.checked,q={operation:"=",value:l},c=a.filter(b.getFullList(),c,q);m.setTempData(c)});this.updateCheckBoxSettings=function(d){b.options.checkBoxSettings=d?{autoCheck:g.isFieldAvailable(d.autoCheck,!1),style:Ja(d.style),threeState:g.isFieldAvailable(d.threeState,!1)}:
{autoCheck:!1,style:b.defaultCheckBoxStyle,threeState:!1}};var C=function(d){return d?a.createTree(d.conditions,d.formula):null},J=function(d){var l=!0;d&&b.filterParams&&(l=(l=d[b.options.dataFields.value])?l:d[b.options.dataFields.text],l=b.filterParams.callback?b.filterParams.callback(l,d):a.match(l,b.filterParams.conditions,b.filterParams.formula,C(b.filterParams),b.filterParams.caseSensitive));return l},y=0;b.currentList=[];b.indentList=[];b.parentList=[];b.longestItem=null;b.isThereChildItems=
!1;b.currentTopList=[];b.currentBottomList=[];this.updateLongestItem=function(){b.longestItem=null;for(var d=y=0;d<b.currentList.length;d++){var a=b.currentList[d];if(a[b.options.dataFields.text]){var c=a[b.options.dataFields.text].length;0<b.options.indent&&(c+=b.indentList[d]/b.options.indent);y<c&&(y=c,b.longestItem=a)}}};var A=function(d,a,c,q,e){d.type="item";d[b.options.dataFields.id]||(d[b.options.dataFields.id]=g.getUniqueId());c&&(d[b.options.dataFields.pid]=c);if(c=J(d))if(q)b.fullList.push(d);
else{q=a;0!=b.options.showStatusIcons&&(q+=15);switch(d[b.options.dataFields.fixed]){case "top":b.currentTopList.push(d);break;case "bottom":b.currentBottomList.push(d);break;default:b.currentList.push(d),b.indentList.push(q),b.parentList.push({parent:e})}d[b.options.dataFields.text]&&(e=d[b.options.dataFields.text].length,0<b.options.indent&&(e+=a/b.options.indent),0!=b.options.showStatusIcons&&(e+=15),y<e&&(y=e,b.longestItem=d))}return c};this.isThereVisibleChildren=function(d){var a=!1;if(d&&(d=
d[b.options.dataFields.items]))for(var c=0;c<d.length;c++)if(J(d[c])&&!b.isItemFixed(d[c])){a=!0;break}return a};this.isItemFixed=function(d){return"top"==d[b.options.dataFields.fixed]||"bottom"==d[b.options.dataFields.fixed]?!0:!1};this.isThereChildItems=!1;var N=function(d,a,c,q,e){if(!d[b.options.dataFields.items])return c=A(d,a,c,q,e);if((c=A(d,a,c,q,e))&&!b.isItemFixed(d)){e=0;var l;if(q||b.isItemExpanded(d)||b.isItemFixed(d)&&d[b.options.dataFields.fixChildren]){var u=d[b.options.dataFields.items];
if(u){b.applySorting(u);for(var g=0;g<u.length;g++)(l=N(u[g],a+b.options.indent,d[b.options.dataFields.id],q,d))&&e++}}q||b.isThereChildItems||!(0<e||!b.isItemExpanded(d)&&d[b.options.dataFields.items]&&0<d[b.options.dataFields.items].length&&b.isThereVisibleChildren(d))||(b.isThereChildItems=!0)}return c};b.fullList=[];this.getFullList=function(d){b.fullList.length=0;d=b.dataObj.getList(d);for(var a=0;a<d.length;a++)N(d[a],0,null,!0,null);return b.fullList};this.getCurrentList=function(){return b.currentList};
this.updateCurrentList=function(){b.currentList.length=0;b.indentList.length=0;b.parentList.length=0;b.longestItem=null;b.currentTopList.length=0;b.currentBottomList.length=0;b.isThereChildItems=!1;y=0;var d=b.dataObj.getList();if(d){b.applySorting(d);for(var a=0;a<d.length;a++)N(d[a],0,null,!1)}};this.dataEvents={clear:function(d){return angular.isDefined(c.events)&&c.events.clear?c.events.clear({parent:d.e.parent}):c.clear(d)},objAdded:function(d){return angular.isDefined(c.events)&&c.events.itemAdded?
c.events.itemAdded({item:d.e.item}):c.itemAdded(d)},objAdding:function(d){return angular.isDefined(c.events)&&c.events.itemAdding?c.events.itemAdding({item:d.e.item}):c.itemAdding(d)},objRemoved:function(d){return angular.isDefined(c.events)&&c.events.itemRemoved?c.events.itemRemoved({item:d.e.item}):c.itemRemoved(d)},objRemoving:function(d){return angular.isDefined(c.events)&&c.events.itemRemoving?c.events.itemRemoving({item:d.e.item}):c.itemRemoving(d)}};this.getDataFields=function(d){return{content:d.content?
d.content:"content",icon:d.icon?d.icon:"icon",id:d.id?d.id:"id",pid:d.pid?d.pid:"pid",objects:d.items?d.items:"items",statusIcon:d.statusIcon?d.statusIcon:"statusIcon",text:d.text?d.text:"text"}};b.dataObj=new h({objects:c.items,events:b.dataEvents,fields:b.getDataFields(b.options.dataFields)});c.$on(c.name+"-load-data",function(d,a,c,q,e){m.setTempData(b.loadData(a,c,q,e))});c.$on(c.name+"-export-json",function(d,a,c,e){m.setTempData(b.exportToJSON(a,c,e))});this.exportToJSON=function(d,a,c){c=c?
c:null;var l=!1!==a?b.getFullList():b.dataObj.getList();d=d?d:[b.options.dataFields.allowDrag,b.options.dataFields.allowDrop,b.options.dataFields.allowEdit,b.options.dataFields.allowFocus,b.options.dataFields.autoCheck,b.options.dataFields.checkBoxSettings,b.options.dataFields.checked,b.options.dataFields.checkState,b.options.dataFields.content,b.options.dataFields.contextMenu,b.options.dataFields.enabled,b.options.dataFields.expanded,b.options.dataFields.fixed,b.options.dataFields.fixChildren,b.options.dataFields.hasChildren,
b.options.dataFields.icon,b.options.dataFields.id,b.options.dataFields.pid,b.options.dataFields.selected,b.options.dataFields.showCheckBox,b.options.dataFields.statusIcon,b.options.dataFields.style,b.options.dataFields.templateObj,b.options.dataFields.text,b.options.dataFields.tooltip,b.options.dataFields.value];!1===a&&d.push(b.options.dataFields.items);return JSON.stringify(l,d,c)};this.loadData=function(d,a,u,q){var l=n.defer();b.suspendLayout();b.allowEvents=!1;b.updateDataFields(u);var g=[],
k=b.options.dataFields;b.dataObj.clear(a,b.listIsCleared);if(d)if(0!=q){var m=[];d.forEach(function(d,a){var b=d[k.pid];m[b]?(m[b][k.items]||(m[b][k.items]=[]),m[d[k.id]]=d,m[b][k.items].push(d)):(m[d[k.id]]=d,g.push(d))});m.length=0}else g=d;if(a)for(a[b.options.dataFields.items]=g,d=0;d<a[b.options.dataFields.items].length;d++)a[b.options.dataFields.items][d][b.options.dataFields.pid]=a[b.options.dataFields.id];else if(angular.isDefined(c.items))for(d=c.items.length=0;d<g.length;d++)c.items.push(g[d]);
b.dataObj=new h({objects:c.items,events:b.dataEvents,fields:b.getDataFields(b.options.dataFields)});var p=e(function(){b.getTemplateUrl();b.resumeLayout();b.allowEvents=!0;var d=e(function(){l.resolve();e.cancel(d)},125);e.cancel(p)},100);return l.promise};this.updateData=function(){b.options.dataFields.dataSource&&(b.loadData(b.options.dataFields.dataSource),b.dataObj=new h({objects:c.items,events:b.dataEvents,fields:b.getDataFields(b.options.dataFields)}))};var X=!1;this.dragDropStatus=function(d){if(void 0!=
d)X=d;else return X};this.getDnDSource=function(d){return{text:d.dataTransfer?d.dataTransfer.getData("text"):d.originalEvent.dataTransfer?d.originalEvent.dataTransfer.getData("text"):""}};this.getTouchData=function(d){return d.changedTouches?d.changedTouches:d.originalEvent?d.originalEvent.changedTouches:null};var da=angular.element('<div class="iui-drop-marker" data-element="dropmark"></div>');this.getDropMarkLine=function(){return dropMarkLine};b.getMousePos=function(d){return{x:d.pageX?d.pageX:
d.originalEvent?d.originalEvent.pageX:0,y:d.pageY?d.pageY:d.originalEvent?d.originalEvent.pageY:0}};this.getCtrlName=function(){return angular.isDefined(c.name)?c.name:""};p.bind("dragenter",function(d){d.preventDefault();if(b.options.enabled){var a=T.getData();a.source||(a.source=b.getDnDSource(d));d={event:d,sourceTree:a.sourceCtrl?a.sourceCtrl.getCtrlName():"",dragItem:a.source,targetTree:b.getCtrlName(),targetItem:a.target,mousePos:b.getMousePos(d)};b.callDragEnter(d)}});p.bind("dragover",function(d){d.preventDefault();
var a=!0;d.dataTransfer?a="none"===d.dataTransfer.effectAllowed?!1:!0:d.originalEvent&&d.originalEvent.dataTransfer&&(a="none"===d.originalEvent.dataTransfer.effectAllowed?!1:!0);if(b.options.enabled&&a)if(d.dataTransfer?d.dataTransfer.dropEffect=b.options.allowDrop?"move":"none":d.originalEvent&&d.originalEvent.dataTransfer&&(d.originalEvent.dataTransfer.dropEffect=b.options.allowDrop?"move":"none"),a=T.getData(),a.source||(a.source=b.getDnDSource(d)),T.setData({source:a.source,sourceCtrl:a.sourceCtrl,
target:null,dropPos:-1}),a={event:d,sourceTree:a.sourceCtrl?a.sourceCtrl.getCtrlName():"",dragItem:a.source,targetTree:b.getCtrlName(),targetItem:null,isDropAllowed:b.options.allowDrop,dropPos:-1,mousePos:b.getMousePos(d)},0==b.callDragOver(a))d.dataTransfer?d.dataTransfer.dropEffect="none":d.originalEvent&&d.originalEvent.dataTransfer&&(d.originalEvent.dataTransfer.dropEffect="none"),b.dropMark();else{a=b.getMousePos(d);d=a.y+16;var a=a.x+20,u=b.getDropMarkWindow();u.empty();u.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+
(c.name?c.name:"TreeView")+"</span>");b.updateDropMarkElem(b.getDropMarkWindow(),{top:d,left:a});b.dropMark(!0)}});p.bind("drop",function(d){d.preventDefault();b.dropMark();var a=!0;d.dataTransfer?a="none"===d.dataTransfer.effectAllowed?!1:!0:d.originalEvent&&d.originalEvent.dataTransfer&&(a="none"===d.originalEvent.dataTransfer.effectAllowed?!1:!0);if(b.options.enabled&&a&&(a=T.getData(),a.source||(a.source=b.getDnDSource(d)),a.source)){var u={event:d,sourceTree:a.sourceCtrl?a.sourceCtrl.getCtrlName():
"",dragItem:a.source,targetTree:b.getCtrlName(),targetItem:null,isDropAllowed:b.options.allowDrop,dropPos:-1,mousePos:b.getMousePos(d)};!1!==b.callDragDrop(u)&&(b.drop(a),c.$$phase||c.$apply())}T.clearData();d.stopPropagation()});p.bind("dragleave",function(d){d.preventDefault();if(b.options.enabled){b.dropMark();var a=T.getData();a.source||(a.source=b.getDnDSource(d));d={event:d,sourceTree:a.sourceCtrl?a.sourceCtrl.getCtrlName():"",dragItem:a.source,targetTree:b.getCtrlName(),targetItem:a.target,
mousePos:b.getMousePos(d)};b.callDragLeave(d);b.cancelScrollTimer()}});p.bind("dragend",function(d){d.preventDefault();b.options.enabled&&(b.dropMark(),T.getData().source||T.clearData(),b.dragDropStatus(!1))});p.bind("mouseleave",function(d){d.preventDefault();b.dropMark();b.hoverItem=null});this.containsMousePos=function(d,a){return T.hitTest(d,a,{left:0,top:0,right:p[0].clientWidth,bottom:p[0].clientHeight})};this.isPopupActive=function(){return!1};var ea=function(d,a){var c=b.options.dataFields;
d[c.items]||(d[c.items]=[]);d[c.items].length=0;if(d[a.rows]&&0<d[a.rows].length)for(var l=0;l<d[a.rows].length;l++)d[c.items].push(ea(d[a.rows][l],a));return d},B=function(a,c){var d=!1;c.sourceCtrl&&(d=c.sourceCollection.removeAt(a,-1,null,c.sourceCtrl.objIsRemoved));d&&("row"==a.type&&(a=ea(a,c.sourceCtrl.options.rowFields)),0===c.dropPos?b.dataObj.insertAt(a,-1,c.target,b.itemIsAdded):1===c.dropPos||2===c.dropPos?1===c.dropPos?b.dataObj.insertByRef(a,c.target,!1,b.itemIsAdded):b.dataObj.insertByRef(a,
c.target,!0,b.itemIsAdded):b.dataObj.insertAt(a,-1,null,b.itemIsAdded))};this.setDropSelection=function(a,c){var d=a;!d&&0<=c&&c<b.currentList.length&&(d=b.currentList[c]);b.clearPrevSelection(d);b.itemSelection(null,d)};this.drop=function(a){if(a&&a.sourceCtrl){a.sourceCtrl.suppressProcess=!0;a.sourceCtrl.suspendLayout();b.suspendLayout();var d=a.source;if(Array.isArray(a.source)){for(var u=[],q=0;q<a.source.length;q++){for(var g=!1,h=a.sourceCollection.getParent(a.source[q]);h;){if(a.sourceCtrl.isObjInSelList(h)){g=
!0;break}h=a.sourceCollection.getParent(h)}g||u.push(a.source[q])}if(0<u.length)if(d=u[u.length-1],q=a.sourceCtrl.getObjCurrentIndex(u[0]),g=a.sourceCtrl.getObjCurrentIndex(d),q<=g)for(q=0;q<u.length;q++)B(u[q],a);else for(q=u.length-1;0<=q;q--)B(u[q],a)}else B(a.source,a);a.sourceCtrl!==b?(b.allowUpdate=!0,a.sourceCtrl.allowUpdate=!0,b.updateCurrentLayout(),a.sourceCtrl.updateCurrentLayout()):(b.allowUpdate=!0,b.updateCurrentLayout());b.updateAutoLayout();a.sourceCtrl.multiSelection(!1);var k=e(function(){if(d){a.sourceCtrl.clearPrevSelection(d);
b.itemSelection(null,d);var l=b.getElemFromItem(d);l&&(l=b.getElement(l))&&l[0].focus();c.$apply();e.cancel(k)}},1);a.sourceCtrl.suppressProcess=!1}};this.isDragAllowed=function(a){return b.options.allowDrag?a&&(a[b.options.dataFields.allowDrag]||void 0===a[b.options.dataFields.allowDrag])?!0:!1:!1};this.isChildOf=function(a,c){var d=!1;if(a&&c){var l=c[b.options.dataFields.items];if(l&&0<l.length)for(var e=0;e<l.length;e++){if(g.isEqual(a[b.options.dataFields.id],l[e][b.options.dataFields.id])){d=
!0;break}else d=b.isChildOf(a,l[e]);if(d)break}}return d};this.isParentOf=function(a,c){var d=b.dataObj.getParent(c);return a&&c&&d&&g.isEqual(a[b.options.dataFields.id],d[b.options.dataFields.id])?!0:!1};this.isDropAllowed=function(a,c,u){var d=b.options.allowDrop;if(d&&a&&c&&(d=b.isItemFixed(c)||!c[b.options.dataFields.allowDrop]&&void 0!==c[b.options.dataFields.allowDrop]?!1:!0))if(Array.isArray(a))for(var l=0;l<a.length;l++){if(g.isEqual(a[l][b.options.dataFields.id],c[b.options.dataFields.id])||
0===u&&b.isParentOf(c,a[l])||b.isChildOf(c,a[l])){d=!1;break}if(!d)break}else if(g.isEqual(a[b.options.dataFields.id],c[b.options.dataFields.id])||0===u&&b.isParentOf(c,a)||b.isChildOf(c,a))d=!1;return d};this.getDropMarkWindow=function(){for(var a=da,b=angular.element(document.body).children(),c=0;c<b.length;c++){var e=angular.element(b[c]);if(e[0].attributes&&e[0].attributes["data-element"]&&"dropmark"===e[0].attributes["data-element"].value){a=e;break}}return a};this.dropMark=function(a,c){c||
(c=b.getDropMarkWindow());if(c){var d="none";this.options.allowDrop&&(d=a?"block":"none");angular.element(c).css("display",d)}};this.updateDropMarkElem=function(a,b){a&&b&&(a.css("top",b.top+"px"),a.css("left",b.left+"px"),a.css("width",b.width+"px"))};var Za=!1,Y=angular.element('<input type="text" style="position:absolute" />');this.labelEditStatus=function(a){if(void 0!=a)Za=a;else return Za};this.getEditBox=function(){return Y};this.updateEditBox=function(a){Y&&a&&(Y.css("top",a.top+"px"),Y.css("left",
a.left+"px"),Y.css("width",a.width+"px"),Y.css("height",a.height+"px"))};c.$on(c.name+"-open-editor",function(a,c){b.openEditor(c)});c.$on(c.name+"-close-editor",function(a,c){b.closeEditor(c)});this.updateEditorSettings=function(a){b.options.editorSettings=a?{activate:g.isFieldAvailable(a.activate,"click")}:{activate:"click"}};this.allowEvents=!0;this.callAfterCollapse=function(a){angular.isDefined(c.events)&&c.events.afterCollapse&&c.events.afterCollapse({item:a});c.afterCollapse({e:{item:a}})};
this.callAfterExpand=function(a){angular.isDefined(c.events)&&c.events.afterExpand&&c.events.afterExpand({item:a});c.afterExpand({e:{item:a}})};this.callAfterEdit=function(a){angular.isDefined(c.events)&&c.events.afterEdit&&c.events.afterEdit({item:a});c.afterEdit({e:{item:a}})};this.callAfterLabelEdit=function(a){angular.isDefined(c.events)&&c.events.afterLabelEdit&&c.events.afterLabelEdit({item:a});c.afterLabelEdit({e:{item:a}})};this.callAfterSelect=function(a){angular.isDefined(c.events)&&c.events.afterSelect?
c.events.afterSelect({item:a}):c.afterSelect({e:{item:a}});angular.isDefined(c.events)&&c.events.selectionChanged?c.events.selectionChanged({item:a}):c.selectionChanged({e:{item:a}})};this.callBeforeCollapse=function(a){return angular.isDefined(c.events)&&c.events.beforeCollapse?c.events.beforeCollapse({item:a}):c.beforeCollapse({e:{item:a}})};this.callBeforeExpand=function(a){return angular.isDefined(c.events)&&c.events.beforeExpand?c.events.beforeExpand({item:a}):c.beforeExpand({e:{item:a}})};this.callBeforeEdit=
function(a){return angular.isDefined(c.events)&&c.events.beforeEdit?c.events.beforeEdit({item:a}):c.beforeEdit({e:{item:a}})};this.callBeforeLabelEdit=function(a){return angular.isDefined(c.events)&&c.events.beforeLabelEdit?c.events.beforeLabelEdit({item:a}):c.beforeLabelEdit({e:{item:a}})};this.callChange=function(){angular.isDefined(c.events)&&c.events.change?c.events.change():c.change()};this.callDragEnter=function(a){angular.isDefined(c.events)&&c.events.dragEnter?c.events.dragEnter({event:a.event,
sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,mousePos:a.mousePos}):c.dragEnter({e:{event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,mousePos:a.mousePos}})};this.callDragOver=function(a){return angular.isDefined(c.events)&&c.events.dragOver?c.events.dragOver({event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,
mousePos:a.mousePos}):c.dragOver({e:{event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}})};this.callDragDrop=function(a){return angular.isDefined(c.events)&&c.events.dragDrop?c.events.dragDrop({event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}):c.dragDrop({e:{event:a.event,
sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}})};this.callDragLeave=function(a){angular.isDefined(c.events)&&c.events.dragLeave?c.events.dragLeave({event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,mousePos:a.mousePos}):c.dragLeave({e:{event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,
mousePos:a.mousePos}})};this.callEnabledChanged=function(a){angular.isDefined(c.events)&&c.events.enabledChanged?c.events.enabledChanged({enabled:a}):c.enabledChanged({e:{enabled:a}})};this.callItemClick=function(a,b,u){angular.isDefined(c.events)&&c.events.itemClick&&c.events.itemClick({event:a,item:b,mousePos:u});c.itemClick({e:{event:a,item:b,mousePos:u}})};this.callItemDblClick=function(a,b){return angular.isDefined(c.events)&&c.events.itemDblClick?c.events.itemDblClick({item:a,mousePos:b}):c.itemDblclick({e:{item:a,
mousePos:b}})};this.callItemHover=function(a){angular.isDefined(c.events)&&c.events.itemHover?c.events.itemHover({item:a}):c.itemHover({e:{item:a}})};this.callItemRightClick=function(a,b){angular.isDefined(c.events)&&c.events.itemRightClick&&c.events.itemRightClick({item:a,mousePos:b});c.itemRightclick({e:{item:a,mousePos:b}})};this.callKeyDown=function(a,b){angular.isDefined(c.events)&&c.events.keyDown?c.events.keyDown({event:a,item:b}):c.keyDown({e:{event:a,item:b}})};this.callKeyPress=function(a,
b){angular.isDefined(c.events)&&c.events.keyPress?c.events.keyPress({event:a,item:b}):c.keyPress({e:{event:a,item:b}})};this.callKeyUp=function(a,b){angular.isDefined(c.events)&&c.events.keyUp?c.events.keyUp({event:a,item:b}):c.keyUp({e:{event:a,item:b}})};this.callScrollPosChanged=function(){angular.isDefined(c.events)&&c.events.scrollPosChanged?c.events.scrollPosChanged({scrollPos:b.scrollPos}):c.scrollposChanged({e:{scrollPos:b.scrollPos}})};p.bind("click",function(a){b.options.enabled&&1===a.which&&
b.callItemClick(a,null,b.getMousePos(a))});p.bind("dblclick",function(a){a.preventDefault();b.options.enabled&&1===a.which&&b.callItemDblClick(null,b.getMousePos(a));a.stopPropagation()});p.bind("mousedown",function(a){b.options.enabled&&3===a.which&&b.callItemRightClick(null,b.getMousePos(a));a.stopPropagation()});this.expandList=[];this.expandIndentList=[];this.expandParentList=[];var ya=function(a,c,u,e){a.type="item";a[b.options.dataFields.id]||(a[b.options.dataFields.id]=g.getUniqueId());u&&
(a[b.options.dataFields.pid]=u);u=J(a);b.isItemExpanded(a)&&a[b.options.dataFields.items]&&0<a[b.options.dataFields.items].length&&(u=u&&b.isThereVisibleChildren(a));u&&(0!=b.options.showStatusIcons&&(c+=15),b.expandList.push(a),b.expandIndentList.push(c),b.expandParentList.push({parent:e}));return u},Ka=function(a,c,u,e){if(!a[b.options.dataFields.items])return u=ya(a,c+b.options.indent,u,e);if(u=ya(a,c+b.options.indent,u,e)){e=0;var d;if(b.isItemExpanded(a)){var l=a[b.options.dataFields.items];
if(l){b.applySorting(l);for(var q=0;q<l.length;q++)(d=Ka(l[q],c+b.options.indent,a[b.options.dataFields.id],a))&&e++}}!b.isThereChildItems&&(0<e||!b.isItemExpanded(a)&&a[b.options.dataFields.items]&&0<a[b.options.dataFields.items].length&&b.isThereVisibleChildren(a))&&(b.isThereChildItems=!0)}return u};this.expand=function(a){var d=b.getItemFromChildElem(document.activeElement);b.expandList.length=[];b.expandIndentList.length=[];b.expandParentList.length=[];if(!b.isItemExpanded(a)){var c=b.getItemCurrentIndex(a),
q=b.getList(a);if(q){b.applySorting(q);for(var g=0;g<q.length;g++)b.isItemFixed(q[g])||Ka(q[g],b.indentList[c],null,a)}if(0<b.expandList.length){b.allowEvents=!1;c++;Array.prototype.splice.apply(b.currentList,[c,0].concat(b.expandList));Array.prototype.splice.apply(b.indentList,[c,0].concat(b.expandIndentList));Array.prototype.splice.apply(b.parentList,[c,0].concat(b.expandParentList));b.options.autoSize?b.updateAutoLayout():b.getItemScope()?b.updateView():b.updateLayout();var h=e(function(){b.updateViewSize();
b.updateViewSize();b.updateScrollView();d&&b.updateFocus(d);b.allowEvents=!0;e.cancel(h)},1)}}};this.collapse=function(a){var d=b.getItemFromChildElem(document.activeElement);b.expandList.length=[];b.expandIndentList.length=[];if(b.isItemExpanded(a)){var c=null,q=!1,g=a,h=-1,k=b.getItemCurrentIndex(a);for(a=b.getParent(a);a&&!q;){c=b.getList(a);for(h=c.indexOf(g)+1;!q&&h<c.length;)g=c[h],0<b.getItemCurrentIndex(g)&&(q=!0),h++;q||(g=a);a=b.getParent(a)}if(!q&&g)for(c=b.getList(),h=c.indexOf(g)+1;h<
c.length;)if(g=c[h],0<b.getItemCurrentIndex(g)){q=!0;break}else h++;k++;c=b.currentList.length-k;q&&(c=b.getItemCurrentIndex(g)-k);if(0<c){b.currentList.splice(k,c);b.indentList.splice(k,c);b.parentList.splice(k,c);b.options.autoSize?b.updateAutoLayout():b.getItemScope()?b.updateView():b.updateLayout();var m=e(function(){b.updateViewSize();b.updateViewSize();b.updateScrollView();d&&b.updateFocus(d);b.allowEvents=!0;e.cancel(m)},1)}}};this.toggle=function(a,c){if(a){if((a[b.options.dataFields.hasChildren]||
a[b.options.dataFields.items]&&0!==a[b.options.dataFields.items].length)&&!(c&&!1!==a[b.options.dataFields.expanded]||!1===c&&!1===a[b.options.dataFields.expanded])){var d=void 0!==c?c:!1!==a[b.options.dataFields.expanded]?!0:!1;!1!==(void 0!==c?c?b.callBeforeExpand(a):b.callBeforeCollapse(a):d?b.callBeforeCollapse(a):b.callBeforeExpand(a))&&(d=void 0!=c?c:!d,d!=a[b.options.dataFields.expanded]&&(0!=d?b.expand(a):b.collapse(a),a[b.options.dataFields.expanded]=d),b.isItemExpanded(a)?b.callAfterExpand(a):
b.callAfterCollapse(a))}}else{for(var d=b.getFullList(),l=0;l<d.length;l++)d[l][b.options.dataFields.expanded]=c;b.updateCurrentLayout()}};c.$on(c.name+"-collapse",function(a,c){b.toggle(c,!1)});c.$on(c.name+"-expand",function(a,c){b.toggle(c,!0)});c.$on(c.name+"-toggle",function(a,c){b.toggle(c)});this.filterParams=null;c.$on(c.name+"-filter",function(a,c){b.filter(c)});this.filter=function(a){b.filterParams=a;b.updateCurrentLayout();b.callChange()};this.callGotFocus=function(a,b,e,g){angular.isDefined(c.events)&&
c.events.gotFocus?c.events.gotFocus({event:a,item:b,edit:void 0!=e?!0:!1,editValue:g}):c.gotFocus({e:{event:a,item:b,edit:void 0!=e?!0:!1,editValue:g}})};this.callLostFocus=function(a,b,e,g){angular.isDefined(c.events)&&c.events.lostFocus?c.events.lostFocus({event:a,item:b,edit:void 0!=e?!0:!1,editValue:g}):c.lostFocus({e:{event:a,item:b,edit:void 0!=e?!0:!1,editValue:g}})};this.getTabIndex=function(){return p[0].attributes&&p[0].attributes.tabindex?p[0].attributes.tabindex.value:""};this.updateFocus=
function(a){if(1==b.options.allowFocus)var d=e(function(){if(a&&!b.isItemFixed(a)){var c=b.getElemFromItem(a);c&&(c=b.getElement(c))&&c[0].focus()}else p[0].focus();e.cancel(d)},5)};c.$on(c.name+"-focus",function(a,c){b.updateFocus(c)});var oa=!1;this.isItemExpanded=function(a){return a?a[b.options.dataFields.expanded]||void 0===a[b.options.dataFields.expanded]?!0:!1:!0};this.getElement=function(a,b){var d=null;b||(b="content");if(a)for(var c=a.children(),l=0;l<c.length;l++){var e=angular.element(c.eq(l));
if(e[0].attributes&&e[0].attributes["data-element"]&&e[0].attributes["data-element"].value===b){d=e;break}}return d};this.getIndent=function(a){var d=0;if(a&&0<b.options.indent)for(parent=b.dataObj.getParent(a);parent;)d+=b.options.indent,parent=b.dataObj.getParent(parent);return d};this.getItemCurrentIndex=function(a){if(a){switch(a[b.options.dataFields.fixed]){case "top":return b.currentTopList?b.currentTopList.indexOf(a):-1;case "bottom":return b.currentBottomList?b.currentBottomList.indexOf(a):
-1}return b.currentList?b.currentList.indexOf(a):-1}return-1};this.getObjCurrentIndex=function(a){return b.getItemCurrentIndex(a)};this.getObjState=function(a){if(a)switch(a.type){case "item":if(0==b.options.enabled||0==a[b.options.dataFields.enabled])return"disabled";if(1==a[b.options.dataFields.selected]&&b.isObjInSelList(a))return"selected";if(a==b.hoverItem)return"hovered"}return"normal"};this.getItemFromChildElem=function(a){return a?(a=angular.element(a))?b.getItemFromElem(a[0].parentElement):
null:null};this.getItemFromElem=function(a){if(a&&(a=angular.element(a))&&a[0].attributes["data-index"]){var d=a[0].attributes["data-index"].value,c="none";a[0].attributes["data-fixed"]&&(c=a[0].attributes["data-fixed"].value);switch(c){case "top":if(0<=d&&d<b.currentTopList.length)return b.currentTopList[d];break;case "bottom":if(0<=d&&d<b.currentBottomList.length)return b.currentBottomList[d];break;default:if(b.isIndexInRange(d))return b.currentList[d]}}};this.isIndexInRange=function(a){return 0<=
a&&a<b.currentList.length};this.isItemEnabled=function(a){return a&&1==b.options.enabled&&g.isEnabled(a[b.options.dataFields.enabled])};this.mouseButtonStatus=function(a){oa=a};c.$on(c.name+"-ensure-visible",function(a,c,e){b.ensureVisible(c,e)});c.$on(c.name+"-find-item-by-id",function(a,c){m.setTempData(b.findItemById(c))});c.$on(c.name+"-find-item-by-text",function(a,c){m.setTempData(b.findItemByText(c))});c.$on(c.name+"-get-full-path",function(a,c){m.setTempData(b.getFullPath(c))});c.$on(c.name+
"-get-item-level",function(a,c){m.setTempData(b.getLevel(c))});c.$on(c.name+"-get-item-parent",function(a,c){m.setTempData(b.getParent(c))});c.$on(c.name+"-get-item-at",function(a,c){c?m.setTempData(b.getItemAt(c.x,c.y)):m.setTempData(null)});c.$on(c.name+"-get-flat-list",function(a,c){c?m.setTempData(b.getFullList()):m.setTempData(b.currentList)});c.$on(c.name+"-get-list",function(a,c,e){1==e?m.setTempData(b.getFullList(c)):m.setTempData(b.getList(c))});this.ensureVisible=function(a,c){if(a){for(var d=
[],l=b.getParent(a);l;)d.push(l),l=b.getParent(l);for(l=d.length-1;0<=l;l--)d[l][b.options.dataFields.expanded]=!0;b.updateCurrentLayout();var g=e(function(){c=void 0!=c?c:"center";b.scrollTo(a,c);e.cancel(g)},100)}};this.findItemById=function(a){return b.dataObj.findObjectById(a)};this.findItemByText=function(a){return b.dataObj.findObjectByText(a)};this.getFullPath=function(a){var d="";if(a)for(d=a[b.options.dataFields.text],a=b.getParent(a);a;)d=[a[b.options.dataFields.text],b.options.pathSeparator,
d].join(""),a=b.getParent(a);return d};this.getLevel=function(a){var b=0;for(a=this.getParent(a);a;)b++,a=this.getParent(a);return b};this.getParent=function(a){return b.dataObj.getParent(a)};this.getList=function(a){return b.dataObj.getList(a)};this.getFirstItem=function(){for(var a=null,c=0;c<b.currentList.length;c++)if(b.isItemEnabled(b.currentList[c])){a=b.currentList[c];break}return a};this.getPrevItem=function(a){var d=null;if(0<=a&&a<b.currentList.length)for(--a;0<=a;a--)if(b.isItemEnabled(b.currentList[a])){d=
b.currentList[a];break}return d};this.getNextItem=function(a){var d=null;for(a+=1;a<b.currentList.length;a++)if(b.isItemEnabled(b.currentList[a])){d=b.currentList[a];break}return d};this.getLastItem=function(){for(var a=null,c=b.currentList.length-1;0<=c;c--)if(b.isItemEnabled(b.currentList[c])){a=b.currentList[c];break}return a};this.updateSelectionStatus=function(a){switch(a){case "shift":switch(b.options.selectionMode){case "multi-simple":b.multiSelection(!0);b.shiftKeyStatus(!1);break;case "multi-extended":b.multiSelection(!0);
b.shiftKeyStatus(!0);break;default:b.multiSelection(!1),b.shiftKeyStatus(!1)}break;case "ctrl":switch(b.options.selectionMode){case "multi-simple":b.multiSelection(!0);break;case "multi-extended":b.multiSelection(!0);break;default:b.multiSelection(!1)}}};p.bind("keydown",function(a){if(b.options.enabled)switch(a.keyCode){case 16:b.updateSelectionStatus("shift");break;case 17:b.updateSelectionStatus("ctrl");break;default:(a.ctrlKey||a.metaKey)&&b.updateSelectionStatus("ctrl"),a.shiftKey&&b.updateSelectionStatus("shift")}});
b.allowUpdate=!0;this.suspendLayout=function(){b.allowUpdate=!1};this.resumeLayout=function(){b.allowUpdate=!0;b.updateLayout()};c.$on(c.name+"-refresh",function(a,c,e){b.refresh(c,e)});c.$on(c.name+"-resume-layout",function(a){b.resumeLayout()});c.$on(c.name+"-suspend-layout",function(a){b.suspendLayout()});c.$on(c.name+"-update-layout",function(a){b.updateLayout()});c.$on(c.name+"-update-view",function(a){b.updateView()});c.$on(c.name+"-begin-load",function(a,c,e){c?(0>b.options.loadItems.indexOf(c)&&
b.options.loadItems.push(c),b.updateView()):b.beginLoad(e)});c.$on(c.name+"-end-load",function(a,c){b.endLoad(c)});this.callLoadComplete=function(){angular.isDefined(c.events)&&c.events.loadComplete?c.events.loadComplete():c.loadComplete()};this.callUpdateComplete=function(){angular.isDefined(c.events)&&c.events.updateComplete?c.events.updateComplete():c.updateComplete()};c.$on(c.name+"-get-scroll-pos",function(a){m.setTempData(b.getScrollPos())});c.$on(c.name+"-set-scroll-pos",function(a,c){b.setScrollPos(c)});
c.$on(c.name+"-scroll-to",function(a,c,e){b.scrollTo(c,e)});var D=!1,U=!1;this.shiftKeyStatus=function(a){if(void 0!=a)D=a;else return D};this.multiSelection=function(a){if(void 0!=a)U=a;else return U};this.isItemSelected=function(a){return g.isSelected(a)};this.clearPrevSelection=function(a){for(var d=0;d<b.options.selectedItems.length;d++)a&&!g.isEqual(b.options.selectedItems[d][b.options.dataFields.id],a[b.options.dataFields.id])?b.options.selectedItems[d][b.options.dataFields.selected]=!1:a||
(b.options.selectedItems[d][b.options.dataFields.selected]=!1);b.options.selectedItems.length=0;a&&b.isItemEnabled(a)&&b.options.selectedItems.push(a);b.refresh()};this.selectionCancelled=!1;this.shiftFirstSelectedItem=null;this.itemSelection=function(a,l,e){if(l){if("none"!==b.options.selectionMode)if(b.isItemEnabled(l)){var d=b.itemSelection(),u=!0;d&&(u=!g.isEqual(d[b.options.dataFields.id],l[b.options.dataFields.id])||a&&(a.ctrlKey||a.metaKey));var h=!0,h=angular.isDefined(c.events)&&c.events.beforeSelect?
c.events.beforeSelect({item:l}):c.beforeSelect({e:{item:l}});b.selectionCancelled=0==h;if(0!=h)if(u){var k=a&&(a.shiftKey||a.ctrlKey||a.metaKey)?!0:!1,u=!0;"multi-extended"===b.options.selectionMode&&(u=!b.isObjInSelList(l)||!k||D||a&&a.shiftKey);u&&("one"==b.options.selectionMode?b.clearPrevSelection():oa&&(D||a&&a.shiftKey)?b.clearPrevSelection():U||k||"multi-simple"===b.options.selectionMode||k||1!=b.options.selectedItems.length&&b.isObjInSelList(l)||b.clearPrevSelection());b.options.selectedItem=
l;if(oa&&(D||a&&a.shiftKey)&&"one"!=b.options.selectionMode){if(b.shiftFirstSelectedItem||(b.shiftFirstSelectedItem=d),a=b.getItemCurrentIndex(b.shiftFirstSelectedItem),e=b.getItemCurrentIndex(l),a>e&&(d=a,a=e,e=d),b.isIndexInRange(a)&&b.isIndexInRange(e))for(;a<=e;a++)b.currentList[a][b.options.dataFields.selected]=!0,b.options.selectedItems.push(b.currentList[a])}else oa&&(U||k||"multi-simple"===b.options.selectionMode)?(a=null===l[b.options.dataFields.selected]||"undefined"===l[b.options.dataFields.selected]?
!1:l[b.options.dataFields.selected],l[b.options.dataFields.selected]=!a,l[b.options.dataFields.selected]?b.isObjInSelList(l)||b.options.selectedItems.push(l):b.options.selectedItems=b.options.selectedItems.filter(function(a){return a!=l})):(l[b.options.dataFields.selected]=!0,b.isObjInSelList(l)||b.options.selectedItems.push(l)),b.shiftFirstSelectedItem=null;angular.isDefined(c.selectedItem)&&(c.selectedItem=l);b.callAfterSelect(l);b.refresh(null,null,!0)}else U||k||"multi-simple"===b.options.selectionMode?
(a=null===l[b.options.dataFields.selected]||"undefined"===l[b.options.dataFields.selected]?!1:l[b.options.dataFields.selected],e&&"undefined"!==e&&(a=e),l[b.options.dataFields.selected]=!a,l[b.options.dataFields.selected]?b.isObjInSelList(l)||b.options.selectedItems.push(l):b.options.selectedItems=b.options.selectedItems.filter(function(a){return a!=l}),b.shiftFirstSelectedItem=null,b.callAfterSelect(l),b.refresh(null,null,!0)):U||k||"multi-simple"===b.options.selectionMode||(k||1!=b.options.selectedItems.length&&
b.isObjInSelList(l)||b.clearPrevSelection(l),b.shiftFirstSelectedItem=null)}else b.clearPrevSelection()}else return b.options.selectedItem};this.updateSelection=function(a,c){var d=a&&(a.shiftKey||a.ctrlKey||a.metaKey)?!0:!1;!("multi-extended"==b.options.selectionMode&&0<b.options.selectedItems.length)||D||a.shiftKey||U||d||b.selectionCancelled||(b.clearPrevSelection(),c[b.options.dataFields.selected]=!0,b.options.selectedItems.push(c),b.callAfterSelect(c),b.refresh(null,null,!0));b.selectionCancelled=
!1};this.selectFirstItem=function(){for(var a=null,c=0;c<b.currentList.length;c++)if(b.isItemEnabled(b.currentList[c])){a=b.currentList[c];break}this.itemSelection(null,a);return b.options.selectedItem};this.isObjInSelList=function(a){var d=!1,c=b.options.selectedItems;if(a&&c)for(var e=0;e<c.length;e++)if(g.isEqual(c[e][b.options.dataFields.id],a[b.options.dataFields.id])){d=!0;break}return d};this.getItemAt=function(a,c){var d,e,l=null,h=p.find("li");if(h&&0<h.length)for(var k=0;k<h.length;k++)if(d=
angular.element(h[k]),e=g.getPageRect(d),g.checkHit(a,c,e)){l=b.getItemFromElem(d);break}return l};this.resetSelection=function(){switch(b.options.selectionMode){case "none":b.clearPrevSelection();break;default:b.clearPrevSelection(b.itemSelection())}};c.$on(c.name+"-clear-selection",function(a){b.clearPrevSelection();b.options.selectedItem=null});c.$on(c.name+"-get-selected-item",function(a){m.setTempData(b.itemSelection())});c.$on(c.name+"-set-selected-item",function(a,c){var d=e(function(){b.itemSelection(null,
c);e.cancel(d)},1)});c.$on(c.name+"-get-selected-items",function(a){m.setTempData(b.options.selectedItems)});c.$on(c.name+"-set-selected-items",function(a,c){if(c&&Array.isArray(c))var d=e(function(){for(var a=b.options.selectedItems.length=0;a<c.length;a++)c[a][b.options.dataFields.selected]=!0,b.options.selectedItems.push(c[a]);0<c.length?(b.options.selectedItem=c[c.length-1],b.callAfterSelect(b.options.selectedItem)):b.options.selectedItem=null;b.refresh(null,null,!0);e.cancel(d)},1)});c.$on(c.name+
"-move-item",function(a,c,e,g,h){b.moveItem(c,e,g,h)});c.$watch("options",function(a,c){a!==c&&(b.updateOptions(a),b.updateLayout())},!0);c.$watch("allowDrag",function(a,c){a!==c&&(b.options.allowDrag=a,b.updateView())});c.$watch("allowDrop",function(a,c){a!==c&&(b.options.allowDrop=a,b.updateView())});c.$watch("allowFocus",function(a,c){a!==c&&(b.options.allowFocus=a)});c.$watch("autoCheck",function(a,c){a!==c&&(b.options.autoCheck=a,b.updateView())});c.$watch("autoExpand",function(a,c){a!==c&&(b.options.autoExpand=
a)});c.$watch("autoSize",function(a,c){a!==c&&(b.options.autoSize=a,b.updateLayout())});c.$watch("checkBoxSettings",function(a,c){a!==c&&b.updateCheckBoxSettings(a)});c.$watch("controlStyle",function(a,c){a!==c&&b.updateControlStyle(a)});c.$watch("editorSettings",function(a,c){a!==c&&b.updateEditorSettings(a)});c.$watch("enabled",function(a,c){a!==c&&(b.options.enabled=a,b.updateView(),b.callEnabledChanged(a))});c.$watch("fields",function(a,c){a!==c&&(b.options.dataFields=a,b.UpdateData())});c.$watch("hoverSelection",
function(a,c){a!==c&&(b.options.hoverSelection=a)});c.$watch("indent",function(a,c){a!==c&&(b.options.indent=a,b.updateLayout())});c.$watch("itemIcon",function(a,c){a!==c&&(b.options.itemIcon=a,b.updateLayout())});c.$watch("labelEdit",function(a,c){a!==c&&(b.options.labelEdit=a)});c.$watch("maxItems",function(a,c){a!==c&&(b.options.maxItems=a)});c.$watch("mouseWheelSpeed",function(a,c){a!==c&&(b.options.mouseWheelSpeed=a)});c.$watch("pathSeparator",function(a,c){a!==c&&(b.options.pathSeparator=a)});
c.$watch("rtl",function(a,c){a!==c&&(b.options.rtl=a,b.updateLayout())});c.$watch("selectionMode",function(a,c){a!==c&&(b.options.selectionMode=a,b.resetSelection())});c.$watch("showCheckBoxes",function(a,c){a!==c&&(b.options.showCheckBoxes=a,b.updateLayout())});c.$watch("showExpandBoxes",function(a,c){a!==c&&(b.options.showExpandBoxes=a,b.updateLayout())});c.$watch("showIcons",function(a,c){a!==c&&(b.options.showIcons=a,b.updateLayout())});c.$watch("showLines",function(a,c){a!==c&&(b.options.showLines=
a,b.updateLayout())});c.$watch("showStatusIcons",function(a,c){a!==c&&(b.options.showStatusIcons=a,b.updateLayout())});c.$watch("selectedItem",function(a,c){a!==c&&(c&&(c[b.options.dataFields.selected]=!1),b.options.selectedItem=a,b.callAfterSelect(a))});c.$watch("templateSettings",function(a,c){a!==c&&(b.updateTemplateSettings(a),b.updateLayout())});this.sortComparer=null;c.$watch("sorting",function(a,c){a!==c&&(b.options.sorting=a)});c.$on(c.name+"-sort",function(a,c,e){b.sort(c,e)});this.sort=
function(a,c){b.sortComparer=c;if("ascending"==a||"descending"==a||"none"==a)b.options.sorting=a;b.updateCurrentLayout();b.callChange()};this.isSortingAllowed=function(){return"ascending"==b.options.sorting||"descending"==b.options.sorting};this.applySorting=function(a){a&&(b.sortComparer?a.sort(b.sortComparer):b.isSortingAllowed()&&a.sort(function(a,c){var d,e;(d=a[b.options.dataFields.value])||(d=a[b.options.dataFields.text]);g.isObject(d)&&(d=d.value?d.value:d.text);(e=c[b.options.dataFields.value])||
(e=c[b.options.dataFields.text]);g.isObject(e)&&(e=e.value?e.value:e.text);d=void 0!=d?d:null;e=void 0!=e?e:null;switch(b.options.sorting){case "ascending":if(d<e)return-1;if(d>e)return 1;break;case "descending":if(d>e)return-1;if(d<e)return 1;break;default:return 0}}))};var Ja=function(a){if(a){var c=g.isFieldAvailable(a.general,"iui-checkbox");a=(a=a.box)?{general:g.isFieldAvailable(a.general,"iui-checkbox-box"),disabled:g.isFieldAvailable(a.disabled,"iui-checkbox-disabled"),checked:g.isFieldAvailable(a.checked,
"iui-checkbox-checked"),indeterminate:g.isFieldAvailable(a.indeterminate,"iui-checkbox-indeterminate"),unchecked:g.isFieldAvailable(a.unchecked,"iui-checkbox-unchecked")}:b.options.controlStyle.item.checkBox.box;return{general:c,box:a}}return b.options.controlStyle.item.checkBox};this.getExpandBoxStyle=function(a){return a?{general:g.isFieldAvailable(a.general,"iui-treeview-expand-box"),animated:g.isFieldAvailable(a.animated,"iui-treeview-expand-box-load"),expanded:g.isFieldAvailable(a.expanded,"iui-treeview-expand-box-open"),
collapsed:g.isFieldAvailable(a.collapsed,"iui-treeview-expand-box-close")}:b.options.controlStyle.item.expandBox};var za=function(a){if(a){var c;c=a.general;c=g.isString(c)?c:c?{disabled:g.isFieldAvailable(c.disabled,"iui-treeview-item-disabled"),focused:g.isFieldAvailable(c.focused,"iui-treeview-item-focused"),normal:g.isFieldAvailable(c.normal,"iui-treeview-item"),hovered:g.isFieldAvailable(c.hovered,"iui-treeview-item-hovered"),selected:g.isFieldAvailable(c.selected,"iui-treeview-item-selected")}:
b.options.controlStyle.item.general;var d=Ja(a.checkBox),e=b.getExpandBoxStyle(a.expandBox),h;h=a.content;h=g.isString(h)?h:h?{disabled:g.isFieldAvailable(h.disabled,"iui-treeview-item-content-disabled"),focused:g.isFieldAvailable(h.focused,"iui-treeview-item-content-focused"),normal:g.isFieldAvailable(h.normal,"iui-treeview-item-content"),hovered:g.isFieldAvailable(h.hovered,"iui-treeview-item-content-hovered"),selected:g.isFieldAvailable(h.selected,"iui-treeview-item-content-selected")}:b.options.controlStyle.item.content;
a=a.fixed;a=g.isString(a)?a:a?{disabled:g.isFieldAvailable(a.disabled,"iui-treeview-item-fixed-disabled"),normal:g.isFieldAvailable(a.normal,"iui-treeview-item-fixed"),hovered:g.isFieldAvailable(a.hovered,"iui-treeview-item-fixed-hovered")}:b.options.controlStyle.item.fixed;return{general:c,checkBox:d,expandBox:e,content:h,fixed:a}}return b.options.controlStyle.item};this.updateControlStyle=function(a){b.options.controlStyle=a?{general:g.isFieldAvailable(a.general,"iui-treeview"),item:za(a.item)}:
{general:g.isFieldAvailable(b.defaultStyle.general,"iui-treeview"),item:za(b.defaultStyle.item)}};this.getCurrentItemStyle=function(a,c){var d=b.options.controlStyle.item;if(a)switch(a.style){case "initial":break;case "parent":return b.getCurrentItemStyle(b.getParent(a),c);default:null!=a.style&&(d=a.style)}if(c){if(g.isString(d.general))return d.general;if(b.isItemFixed(a))switch(c){case "disabled":return d.fixed&&d.fixed.disabled?d.fixed.disabled:b.options.controlStyle.item.fixed.disabled;case "hovered":return d.fixed&&
d.fixed.hovered?d.fixed.hovered:b.options.controlStyle.item.fixed.hovered;default:return d.fixed&&d.fixed.normal?d.fixed.normal:b.options.controlStyle.item.fixed.normal}else switch(c){case "disabled":return d.general&&d.general.disabled?d.general.disabled:b.options.controlStyle.item.general.disabled;case "focused":return d.general&&d.general.focused?d.general.focused:b.options.controlStyle.item.general.focused;case "hovered":return d.general&&d.general.hovered?d.general.hovered:b.options.controlStyle.item.general.hovered;
case "selected":return d.general&&d.general.selected?d.general.selected:b.options.controlStyle.item.general.selected;default:return d.general&&d.general.normal?d.general.normal:b.options.controlStyle.item.general.normal}}else return d?d:b.options.controlStyle.item};this.getCurrentItemContentStyle=function(a,c){var d=b.options.controlStyle.item.content;if(a)switch(a.style){case "initial":break;case "parent":return b.getCurrentItemContentStyle(b.getParent(a),c);default:null!=a.style&&a.style.content&&
(d=a.style.content)}if(c){if(g.isString(d))return d;switch(c){case "disabled":return d&&d.disabled?d.disabled:b.options.controlStyle.item.content.disabled;case "focused":return d&&d.focused?d.focused:b.options.controlStyle.item.content.focused;case "hovered":return d&&d.hovered?d.hovered:b.options.controlStyle.item.content.hovered;case "selected":return d&&d.selected?d.selected:b.options.controlStyle.item.content.selected;default:return d&&d.normal?d.normal:b.options.controlStyle.item.content.normal}}else return d?
d:b.options.controlStyle.item.content}}]).directive("iuiTreeview",["$compile","$timeout","$interval","IntegralUIInternalService","IntegralUIDragDrop","$window",function(c,p,e,k,n,g){return{restrict:"EA",controller:"IntegralUITreeViewController",transclude:!0,replace:!0,template:'<div class="iui-treeview" data-element="treeview"><ul class="iui-treeview-block-top"></ul><ul class="iui-treeview-block"></ul><ul class="iui-treeview-block-bottom"></ul></div>',scope:{allowAnimation:"=",allowDrag:"=",allowDrop:"=",
allowFocus:"=",animationSpeed:"=",autoCheck:"=",autoExpand:"=",autoSize:"=",checkboxSettings:"=",controlStyle:"=",editorSettings:"=",enabled:"=",fields:"=",hoverSelection:"=",itemIcon:"=",indent:"=",items:"=",labelEdit:"=",maxItems:"=",mouseWheelSpeed:"@",name:"@",options:"=?",pathSeparator:"@",rtl:"=",selectedIndex:"=",selectedItem:"=",selectionMode:"@",showCheckBoxes:"=",showExpandBoxes:"=",showIcons:"=",showLines:"=",showStatusIcons:"=",sorting:"@",templateSettings:"=",afterCollapse:"&",afterEdit:"&",
afterExpand:"&",afterLabelEdit:"&",afterSelect:"&",beforeCollapse:"&",beforeEdit:"&",beforeExpand:"&",beforeLabelEdit:"&",beforeSelect:"&",change:"&",clear:"&",dragDrop:"&",dragEnter:"&",dragLeave:"&",dragOver:"&",enabledChanged:"&",events:"=?",itemAdded:"&",itemAdding:"&",itemCheckedChanging:"&",itemCheckedChanged:"&",itemCheckstateChanging:"&",itemCheckstateChanged:"&",itemClick:"&",itemDblclick:"&",itemHover:"&",loadComplete:"&",gotFocus:"&",keyDown:"&",keyPress:"&",keyUp:"&",lostFocus:"&",itemRemoved:"&",
itemRemoving:"&",itemRightclick:"&",scrollposChanged:"&",selectionChanged:"&",updateComplete:"&"},link:function(h,m,T,a,b){var w=this,H=m.children().eq(0),C=m.children().eq(1),J=m.children().eq(2),y=angular.element('<div class="iui-scrollbar-vertical"><div class="iui-scroll-button-thumb-vertical"></div></div>'),A=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),N=angular.element('<div class="iui-scrollbar-corner"></div>'),X=null,
da=null,ea=null,B=a.getEditBox(),Za=function(){var b="iui-treeview-block";a.options.rtl&&(b+=" "+b+"-rtl");return b};h.$on("$destroy",function(a){w.s2t();Z&&(p.cancel(Z),Z=null);m.unbind("click dblclick dragenter dragleave dragend drop keydown mousedown mouseleave mousemove mousewheel scroll touchstart touchmove touchend");angular.element(g).unbind("dragenter",qb);angular.element(g).unbind("dragover",rb);angular.element(g).unbind("dragend",sb);angular.element(g).unbind("keyup",tb);angular.element(g).unbind("mousemove",
ub);angular.element(g).unbind("mouseup",vb);B&&B.unbind("blur focus keydown mousedown");H&&H.unbind("dragover");J&&J.unbind("dragover");za();v&&v.$destroy()});m.append(a.getDropMarkWindow());a.dropMark();var Y=function(b){b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none");a.dropMark()};H.bind("dragover",function(a){Y(a);a.stopPropagation()});J.bind("dragover",function(a){Y(a);a.stopPropagation()});var ya=
function(){X&&(p.cancel(X),X=null)};a.addDropMark=function(){var b;b=m[0];for(var c=null;b;){if(b===document.getElementsByTagName("body")[0]){c=b;break}b=b.offsetParent}if(b=c)angular.element(b).append(a.getDropMarkWindow()),a.dropMark()};a.removeDropMark=function(){a.getDropMarkWindow().remove()};var Ka=function(b,c){a.labelEditStatus()&&a.closeEditor();b.preventDefault();var d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===
b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d){var f=a.getItemFromChildElem(c);if(f){var d=c[0].getBoundingClientRect(),r=jb(),e=a.getMousePos(b);e.x-=d.left+r.x;e.y-=d.top+r.y;var r=n.getDropPos(e,{x:0,y:0,width:c[0].offsetWidth,height:c[0].offsetHeight}),e=n.getData(),d=a.isDropAllowed(e.source,f,r),g={event:b,sourceTree:e.sourceCtrl?e.sourceCtrl.getCtrlName():"",dragItem:e.source,targetTree:a.getCtrlName(),targetItem:f,isDropAllowed:d,dropPos:r,mousePos:a.getMousePos(b)},g=a.callDragOver(g);
if(d&&0!=g){var h=a.getMousePos(b),g=h.y+16,h=h.x+20,k=a.getDropMarkWindow();k.empty();var l="iui-drop-marker-move-in";switch(r){case 1:l="iui-drop-marker-move-up";break;case 2:l="iui-drop-marker-move-down"}k.append("<span class='"+l+"'></span><span class='iui-drop-marker-title'>"+f[a.options.dataFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:g,left:h});a.dropMark(d);n.setData({source:e.source,sourceList:e.sourceList,target:f,dropPos:r})}else b.dataTransfer?b.dataTransfer.dropEffect=
"none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none"),a.dropMark()}}},oa=function(b,c){b.preventDefault();ya();a.dropMark();var d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d){var f=a.getItemFromChildElem(c);if(f){var r=n.getData(),e=r.source;e||(e=a.getDnDSource(b));(d=a.isDropAllowed(e,f,r.dropPos))&&e&&(d={event:b,
sourceTree:r.sourceCtrl?r.sourceCtrl.getCtrlName():"",dragItem:e,targetTree:a.getCtrlName(),targetItem:f,isDropAllowed:d,dropPos:r.dropPos,mousePos:a.getMousePos(b)},!1!==a.callDragDrop(d)&&(a.drop(r),h.$$phase||h.$apply()))}}n.clearData();a.dragDropStatus(!1);b.stopPropagation()},D=angular.element('<div style="opacity:0.75;position:absolute;z-index:999"></div>'),U=function(){D&&(D.remove(),D.css("top","-9999999px"),D.css("left","-9999999px"))},Ja=function(b){var c="";if(a.options.showExpandBoxes){var d=
a.defaultStyle.item.expandBox.general;b[a.options.dataFields.style]&&b[a.options.dataFields.style].expandBox&&b[a.options.dataFields.style].expandBox.general!=d?d+=" "+b[a.options.dataFields.style].expandBox.general:a.options.controlStyle.item.expandBox.general!=d&&(d+=" "+a.options.controlStyle.item.expandBox.general);var f=a.getCurrentItemStyle(b),f=a.getExpandBoxStyle(f.expandBox);if(a.isThereChildItems||b&&b[a.options.dataFields.hasChildren])c=d;d=b[a.options.dataFields.hasChildren]&&(a.isThereVisibleChildren(b)||
!b[a.options.dataFields.items]||b[a.options.dataFields.items]&&0==b[a.options.dataFields.items].length);b&&!a.isItemFixed(b)&&(d||a.isThereVisibleChildren(b))&&(0<=a.options.loadItems.indexOf(b)?c+=" "+f.animated:(c=b[a.options.dataFields.hasChildren]&&void 0===b[a.options.dataFields.expanded]?c+(" "+f.expanded):0!=b[a.options.dataFields.expanded]?c+(" "+f.collapsed):c+(" "+f.expanded),!0===a.options.rtl&&(c+="-rtl"),a.options.enabled&&a.isItemEnabled(b)||(c+="-disabled")))}return c},za=function(){var b=
C.find("li");if(0<b.length)for(var c=0;c<b.length;c++){currentElem=angular.element(b[c]);currentElem.unbind("dragover drop dragenter dragleave dragend");var d=a.getElement(currentElem,"expandbox");d&&d.unbind("click dblclick touchend");(d=a.getElement(currentElem))&&d.unbind("blur click dragstart dragover drop dragenter dragleave dragend dblclick focus keydown keypress keyup mouseenter mouseleave mousedown mouseup touchstart touchmove touchend")}for(d=0;2>d;){if((b=0==d?H.find("li"):J.find("li"))&&
0<b.length)for(c=0;c<b.length;c++){currentElem=angular.element(b[c]);var t=a.getElement(currentElem);t&&t.unbind("click dblclick mouseenter mouseleave mousedown touchstart")}d++}},d=function(){var b=C.find("li");if(0<b.length){var c,d=b.length-1,t="content";a.getTemplateUrl()&&(t="template-content");for(var pa=0;pa<=d;pa++)c=angular.element(b[pa]),l(c),u(a.getElement(c,"expandbox")),q(a.getElement(c,"icon")),Pb(a.getElement(c,t))}for(d=0;2>d;){if((b=0==d?H.find("li"):J.find("li"))&&0<b.length)for(t=
"content",a.getTemplateUrl()&&(t="template-content"),pa=0;pa<b.length;pa++)c=angular.element(b[pa]),Qb(a.getElement(c,t));d++}},l=function(b){b&&(b.bind("dragover",function(b){var c=a.getItemFromElem(this);if(c&&a.isItemEnabled(c)){if(a.isScrollBarVisible("vertical")){var c=a.getMousePos(b),d=m[0].getBoundingClientRect();c.x-=angular.element(g)[0].pageXOffset;c.y-=angular.element(g)[0].pageYOffset;c.y<d.top+40?$a(b,!1):c.y>d.bottom-40?$a(b,!0):qa()}else qa();b.stopPropagation()}}),b.bind("dragend",
function(b){var c=a.getItemFromElem(this);c&&a.isItemEnabled(c)&&(b.preventDefault(),a.dragDropStatus(!1),a.dropMark(),n.getData().source||n.clearData())}))},u=function(b){b&&(b.bind("dblclick",function(b){var c=angular.element(this);(c=a.getItemFromChildElem(c))&&a.isItemEnabled(c)&&(a.toggle(c),b.stopPropagation())}),b.bind("click",function(b){var c=angular.element(this);(c=a.getItemFromChildElem(c))&&a.isItemEnabled(c)&&(a.toggle(c),b.stopPropagation())}),b.bind("touchend",function(b){b.preventDefault();
var c=angular.element(this);(c=a.getItemFromChildElem(c))&&a.isItemEnabled(c)&&(a.toggle(c),b.stopPropagation())}))},q=function(b){b&&(b.bind("dragover",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&Ka(b,angular.element(this))}),b.bind("drop",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&oa(b,angular.element(this))}))};a.dragIcon=document.createElement("img");a.dragIcon.width=1;var Ya={x:0,y:0},va={x:0,y:0},wa=!1,ib=!1,ca=null,jb=function(){return{x:angular.element(g)[0].pageXOffset,
y:angular.element(g)[0].pageYOffset}},xa=function(a){var b=jb();return{x:a.x-b.x,y:a.y-b.y}},Pb=function(b){if(b){b.bind("dragstart",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c))if(c=angular.element(this),a.labelEditStatus())b.preventDefault();else{document.activeElement&&document.activeElement.blur();n.clearData();if(c=a.getItemFromChildElem(c))if(ab(),a.isDragAllowed(c)){a.dragDropStatus(!0);a.addDropMark();b.dataTransfer?(b.dataTransfer.effectAllowed="move",b.dataTransfer.setData("text",
c[a.options.dataFields.id]?c[a.options.dataFields.id].toString():"")):b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="move",b.originalEvent.dataTransfer.setData("text",c[a.options.dataFields.id]?c[a.options.dataFields.id].toString():""));c={source:c,sourceCtrl:a,sourceCollection:a.dataObj};switch(a.options.selectionMode){case "multi-simple":c.source=a.options.selectedItems;break;case "multi-extended":c.source=a.options.selectedItems}n.setData(c)}else b.dataTransfer?
b.dataTransfer.effectAllowed="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="none");b.stopPropagation()}});b.bind("dragover",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&Ka(b,angular.element(this))});b.bind("drop",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&oa(b,angular.element(this))});b.bind("dragenter",function(b){b.preventDefault();var c=angular.element(this),d=a.getItemFromChildElem(c);if(d&&
a.isItemEnabled(d)&&(La||(a.hoverItem=d,a.refresh(d)),a.options.autoExpand))var f=p(function(){X||(X=p(function(){X&&a.toggle(d,!0)},750));p.cancel(f)},1);c=n.getData();c.source||(c.source=a.getDnDSource(b));c={event:b,sourceTree:c.sourceCtrl?c.sourceCtrl.getCtrlName():"",dragItem:c.source,targetTree:a.getCtrlName(),targetItem:c.target,mousePos:a.getMousePos(b)};a.callDragEnter(c);b.stopPropagation()});b.bind("dragleave",function(b){b.preventDefault();a.hoverItem=null;var c=angular.element(this);
(c=a.getItemFromChildElem(c))&&a.isItemEnabled(c)&&a.refresh(c);ya();c=n.getData();c.source||(c.source=a.getDnDSource(b));c={event:b,sourceTree:c.sourceCtrl?c.sourceCtrl.getCtrlName():"",dragItem:c.source,targetTree:a.getCtrlName(),targetItem:c.target,mousePos:a.getMousePos(b)};a.callDragLeave(c);b.stopPropagation()});b.bind("dragend",function(b){(b=a.getItemFromChildElem(this))&&a.isItemEnabled(b)&&a.dragDropStatus(!1)});b.bind("touchstart",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c)&&
(b.preventDefault(),(c=a.getTouchData(b))&&0<c.length)){ib=!0;var d=p(function(){ib=!1;p.cancel(d)},750);Ya=xa({x:c[0].pageX,y:c[0].pageY});a.mouseButtonStatus(!0);c=Ya;if((c=a.getItemAt(c.x,c.y))&&a.isItemEnabled(c)){var f=angular.element(this);a.itemSelection(b,c);ca=c;f[0].focus();a.changeCheckValue(c);"click"==a.options.editorSettings.activate&&Ma(b,angular.element(this))}}});b.bind("touchmove",function(b){var c,d,f=a.getItemFromChildElem(this);if(f&&a.isItemEnabled(f)&&(f=a.getTouchData(b))&&
0<f.length){va=xa({x:f[0].pageX,y:f[0].pageY});var f=Math.abs(va.x-Ya.x),t=Math.abs(va.y-Ya.y),e=m[0].getBoundingClientRect();if(n.hitTest(va.x,va.y,e)){if(b.preventDefault(),D&&D.css("display","block"),!ib)if(!wa&&(2<f||2<t)&&ca&&a.isItemEnabled(ca))if(angular.element(this),a.labelEditStatus())b.preventDefault();else{wa=!0;n.clearData();if((f=a.getTouchData(b))&&0<f.length&&(xa({x:f[0].pageX,y:f[0].pageY}),ca&&(ab(),a.isDragAllowed(ca)))){a.dragDropStatus(!0);a.addDropMark();f={source:ca,sourceCtrl:a,
sourceCollection:a.dataObj};switch(a.options.selectionMode){case "multi-simple":f.source=a.options.selectedItems;break;case "multi-extended":f.source=a.options.selectedItems}n.setData(f);if(f=a.getElemFromItem(ca))if(f=a.getElement(f))D.empty(),D.append(f.clone()),D.css("display","none"),m.append(D)}b.stopPropagation()}else if(wa){angular.element(this);a.labelEditStatus()&&a.closeEditor();b.preventDefault();if((f=a.getTouchData(b))&&0<f.length){var e=jb(),r=xa({x:f[0].pageX,y:f[0].pageY});if(f=a.getItemAt(r.x,
r.y)){if(t=a.getElemFromItem(f)){var E=t[0].getBoundingClientRect(),E=n.getDropPos({x:r.x-E.left,y:r.y-E.top},{x:0,y:0,width:t[0].offsetWidth,height:t[0].offsetHeight}),t=n.getData(),g=a.isDropAllowed(t.source,f,E),k={event:b,sourceTree:t.sourceCtrl?t.sourceCtrl.getCtrlName():"",dragItem:t.source,targetTree:a.getCtrlName(),targetItem:f,isDropAllowed:g,dropPos:E,mousePos:r},k=a.callDragOver(k);d=m[0].getBoundingClientRect();c=r.x-d.left;d=r.y-d.top;D.css("top",d-16+"px");D.css("left",c+"px");D.css("display",
"block");if(g&&0!=k){c=r;r=c.y+e.y+16;e=c.x+e.x+20;c=a.getDropMarkWindow();c.empty();d="iui-drop-marker-move-in";switch(E){case 1:d="iui-drop-marker-move-up";break;case 2:d="iui-drop-marker-move-down"}c.append("<span class='"+d+"'></span><span class='iui-drop-marker-title'>"+f[a.options.dataFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:r,left:e});a.dropMark(g);n.setData({source:t.source,sourceList:t.sourceList,target:f,dropPos:E})}else a.dropMark()}}else f=n.getData(),t=
{source:f.source,sourceCtrl:f.sourceCtrl,target:null,dropPos:-1},n.setData(t),k={event:b,sourceTree:f.sourceCtrl?f.sourceCtrl.getCtrlName():"",dragItem:f.source,targetTree:a.getCtrlName(),targetItem:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:r},d=m[0].getBoundingClientRect(),c=r.x-d.left,d=r.y-d.top,D.css("top",d-16+"px"),D.css("left",c+"px"),k=a.callDragOver(k),0==k?a.dropMark():(c=r,r=c.y+16,e=c.x+20,c=a.getDropMarkWindow(),c.empty(),c.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+
(h.name?h.name:"TreeView")+"</span>"),a.updateDropMarkElem(a.getDropMarkWindow(),{top:r,left:e}),a.dropMark(!0))}b.stopPropagation()}}else b.preventDefault(),a.dropMark(),a.cancelScrollTimer(),D&&D.css("display","none")}});b.bind("touchend",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c)){if((c=a.getTouchData(b))&&0<c.length){var c=xa({x:c[0].pageX,y:c[0].pageY}),d=m[0].getBoundingClientRect();if(n.hitTest(c.x,c.y,d))if(wa){angular.element(this);b.preventDefault();ya();a.dropMark();
U();if((c=a.getTouchData(b))&&0<c.length){var d=xa({x:c[0].pageX,y:c[0].pageY}),f=a.getItemAt(d.x,d.y);if(f){var c=n.getData(),t=c.source,e=a.isDropAllowed(t,f,c.dropPos);e&&t&&(d={event:b,sourceTree:c.sourceCtrl?c.sourceCtrl.getCtrlName():"",dragItem:t,targetTree:a.getCtrlName(),targetItem:f,isDropAllowed:e,dropPos:c.dropPos,mousePos:d},d=a.callDragDrop(d),!1!==d&&(a.drop(c),h.$$phase||h.$apply()))}else c=n.getData(),c.source&&(d={event:b,sourceTree:c.sourceCtrl?c.sourceCtrl.getCtrlName():"",dragItem:c.source,
targetTree:a.getCtrlName(),targetItem:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:d},d=a.callDragDrop(d),!1!==d&&(a.drop(c),h.$$phase||h.$apply())),n.clearData()}n.clearData();a.dragDropStatus(!1);b.stopPropagation()}else a.mouseButtonStatus(!1),(c=a.getItemAt(c.x,c.y))&&a.updateSelection(b,c),ab()}c=wa;a.removeDropMark();U();va={x:0,y:0};wa=!1;ca=null;c&&b.stopPropagation()}});b.bind("dblclick",function(b){b.preventDefault();if(1===b.which){var c=a.getItemFromChildElem(this);if(c){var d=
"dblclick"==a.options.editorSettings.activate;d&&Ma(b,angular.element(this),0);0==a.callItemDblClick(c,a.getMousePos(b))||d||a.toggle(c)}}b.stopPropagation()});b.bind("mouseenter",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&(angular.element(this),a.hoverItem=c,a.refresh(c),a.callItemHover(c),a.options.hoverSelection&&(ea=p(function(){ea&&a.itemSelection(b,c)},500)))});b.bind("mouseleave",function(b){a.hoverItem=null;(b=a.getItemFromChildElem(this))&&a.isItemEnabled(b)&&a.refresh(b);
ea&&(p.cancel(ea),ea=null)});var c=function(b,c){b.preventDefault();focusDelayTime=0;var d=a.getItemCurrentIndex(c),f=K+x-2,f=f<a.currentList.length-1?f:a.currentList.length-1;d===f&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+Math.floor(m[0].clientHeight/4)}),focusDelayTime=1);var t=a.getNextItem(d);if(t){a.itemSelection(b,t);h.$apply();var e=p(function(){a.updateFocus(t);p.cancel(e)},focusDelayTime)}},d=function(b,c){b.preventDefault();focusDelayTime=0;var d=a.getItemCurrentIndex(c),f=K;d===
(0<f?f:0)&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-Math.floor(m[0].clientHeight/4)}),focusDelayTime=1);var t=a.getPrevItem(a.getItemCurrentIndex(c));if(t){a.itemSelection(b,t);h.$apply();var e=p(function(){a.updateFocus(t);p.cancel(e)},focusDelayTime)}};b.bind("keydown",function(f){var e=a.getItemFromChildElem(this);if(e&&a.isItemEnabled(e)){a.callKeyDown(f,e);var r=0;switch(f.keyCode){case 9:r=a.currentList.length;0<r&&(f.shiftKey?k.isEqual(e[a.options.dataFields.id],a.currentList[0][a.options.dataFields.id])||
d(f,e):k.isEqual(e[a.options.dataFields.id],a.currentList[r-1][a.options.dataFields.id])||c(f,e));break;case 13:Ma(f,b,0);break;case 16:a.updateSelectionStatus(f,"shift");break;case 17:a.updateSelectionStatus(f,"ctrl");break;case 33:f.preventDefault();r=a.getItemCurrentIndex(e);e=r-x;e=0<e?e:0;if(e!==r){var r=1,t=a.getPrevItem(e+1);if(t){a.scrollTo(t);a.itemSelection(f,t);h.$apply();var E=p(function(){a.updateFocus(t);p.cancel(E)},r)}}break;case 34:f.preventDefault();r=a.getItemCurrentIndex(e);e=
r+x;e=e<a.currentList.length-1?e:a.currentList.length-1;e!==r&&(r=1,t=a.getNextItem(e-1))&&(a.scrollTo(t,"bottom"),a.itemSelection(f,t),h.$apply(),E=p(function(){a.updateFocus(t);p.cancel(E)},r));break;case 35:f.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:I.y});var g=a.getLastItem();g&&(a.itemSelection(f,g),E=p(function(){a.updateFocus(g);p.cancel(E)},1));break;case 36:f.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:0});var l=a.getFirstItem();l&&(a.itemSelection(f,l),E=p(function(){a.updateFocus(l);
p.cancel(E)},1));break;case 37:f.preventDefault();e[a.options.dataFields.items]&&0<e[a.options.dataFields.items].length&&(a.toggle(e,!1),a.updateFocus(e));break;case 32:f.preventDefault();a.itemSelection(f,e,e.selected);h.$apply();break;case 38:d(f,e);break;case 39:f.preventDefault();e[a.options.dataFields.items]&&0<e[a.options.dataFields.items].length&&(a.toggle(e,!0),a.updateFocus(e));break;case 40:c(f,e);break;default:(f.ctrlKey||f.metaKey)&&a.updateSelectionStatus(f,"ctrl"),f.shiftKey&&a.updateSelectionStatus(f,
"shift")}}});b.bind("keyup",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c)){switch(b.keyCode){case 16:a.multiSelection(!1);a.shiftKeyStatus(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||(a.multiSelection(!1),a.shiftKeyStatus(!1))}a.callKeyUp(b,c)}});b.bind("keypress",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&a.callKeyPress(b,c)});b.bind("click",function(b){if(1===b.which){var c=a.getItemFromChildElem(this);
c&&a.isItemEnabled(c)&&a.callItemClick(b,c,a.getMousePos(b))}b.stopPropagation()});b.bind("mousedown",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c)){a.mouseButtonStatus(!0);a.itemSelection(b,c);switch(b.which){case 1:a.changeCheckValue(c);"click"==a.options.editorSettings.activate&&Ma(b,angular.element(this));break;case 3:a.callItemRightClick(c,a.getMousePos(b))}b.stopPropagation()}});b.bind("mouseup",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&
(a.mouseButtonStatus(!1),a.updateSelection(b,c),1===b.which&&ab())});b.bind("focus",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&a.callGotFocus(b,c)});b.bind("blur",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&a.callLostFocus(b,c)})}},Qb=function(b){b&&(b.bind("touchstart",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&(b.preventDefault(),a.changeCheckValue(c))}),b.bind("mouseenter",function(b){(b=a.getItemFromChildElem(this))&&
a.isItemEnabled(b)&&(angular.element(this),a.hoverItem=b,a.refresh(b),a.callItemHover(b))}),b.bind("mouseleave",function(b){a.hoverItem=null;(b=a.getItemFromChildElem(this))&&a.isItemEnabled(b)&&a.refresh(b)}),b.bind("click",function(b){if(1===b.which){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&a.callItemClick(b,c,a.getMousePos(b))}b.stopPropagation()}),b.bind("dblclick",function(b){b.preventDefault();if(1===b.which){var c=a.getItemFromChildElem(this);c&&a.callItemDblClick(c,a.getMousePos(b))}b.stopPropagation()}),
b.bind("mousedown",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c)){switch(b.which){case 1:a.changeCheckValue(c);break;case 3:a.callItemRightClick(c,a.getMousePos(b))}b.stopPropagation()}}))};a.openEditor=function(b){if(b){var c=a.getElemFromItem(b);c&&0!=b[a.options.dataFields.allowEdit]&&(b=a.getElement(c))&&Ma(null,b,0)}};a.closeEditor=function(b){b?(b=a.getElemFromItem(b))&&(b=a.getElement(b))&&Aa(null,b,!1):Aa(null,null,!1)};var Ma=function(b,c,d){a.options.labelEdit&&
(void 0===d&&(d=500),da=p(function(){if(da)var a=p(function(){Aa(b,c,!0);p.cancel(a)},d);p.cancel(da)},d/3))},ab=function(){da&&(p.cancel(da),da=null)},Ba=null,Aa=function(b,c,d){if(a.dragDropStatus())d=B[0].value,a.labelEditStatus(!1),B.unbind("blur focus keydown mousedown"),B.remove(),Ba=null;else{var f=a.getItemFromChildElem(c);if(f)if(c&&f[a.options.dataFields.text]&&""!=f[a.options.dataFields.text]&&c.css("height","auto"),d){if(d="",0!=a.callBeforeLabelEdit(f)){Ba=f;a.labelEditStatus(!0);B.unbind("blur focus keydown mousedown");
m.append(B);f[a.options.dataFields.text]&&""!=f[a.options.dataFields.text]||(b=k.getMargin(c[0].parentElement),d=k.getPadding(c[0]),c.css("height",z-(b.top+b.bottom+2)-(d.top+d.bottom)+"px"));d=m[0].getBoundingClientRect();var e=c[0].getBoundingClientRect();b=c[0].offsetHeight-4;d=e.top-d.top-1;var e=a.scrollPos.x+c[0].offsetLeft,r=m[0].clientWidth-c[0].offsetLeft-6;F&&(r-=16);a.updateEditBox({top:d,left:e,width:r,height:b});B[0].value=f[a.options.dataFields.text];B.bind("keydown",function(b){switch(b.keyCode){case 13:f[a.options.dataFields.text]=
B[0].value?B[0].value:"null";Aa(b,c,!1);break;case 27:Aa(b,c,!1)}b.stopPropagation()});B.bind("focus",function(b){var c=angular.element(this);a.callGotFocus(b,Ba,!0,c[0].value)});B.bind("blur",function(a){Aa(a)});B.bind("mousedown",function(a){a.stopPropagation()});var E=p(function(){B[0].focus();B[0].select();p.cancel(E)},10)}}else d=B[0].value,a.labelEditStatus(!1),B.unbind("blur focus keydown mousedown"),B.remove(),a.updateView(),a.updateFocus(f),a.callAfterLabelEdit(f),a.callLostFocus(b,f,!0,
d),Ba=null;else d=B[0].value,a.labelEditStatus(!1),B.unbind("blur focus keydown mousedown"),B.remove(),a.callAfterLabelEdit(),a.updateView(),a.callLostFocus(b,Ba,!0,d),Ba=null}};a.getElemFromItem=function(b){var c=null;if(b){var d=a.getItemCurrentIndex(b);switch(b[a.options.dataFields.fixed]){case "top":b=H.find("li");break;case "bottom":b=J.find("li");break;default:b=C.find("li")}if(b&&0<b.length)for(var f=0;f<b.length;f++){var e=angular.element(b[f]);if(e[0].attributes["data-index"]&&e[0].attributes["data-index"].value.toString()===
d.toString()){c=e;break}}}return c};var wb=function(b){var c="";b[a.options.dataFields.icon]?c=b[a.options.dataFields.icon]:a.options.itemIcon&&(c=a.options.itemIcon);return c},xb=function(b){return"iui-treeview-status-icon "+b[a.options.dataFields.statusIcon]},yb=function(b){return b?b[a.options.dataFields.icon]||a.options.itemIcon:!1},K=0,v=null,x=100,z=0,P=0,aa=0,O=0,ra=0,Q=null,R=null,Na=!1,Ca=!1,Oa=9,Pa=9,bb=0,fa=0,sa=0,Qa=1,cb=0,Ra=0,ga=0,Da=0,db=1,L=null,M=null,G=!1,F=!1;this.scrollMousePos=
null;var I={x:0,y:0},Ra=0;h.verScrollVisibility=!1;h.$watch("verScrollVisibility",function(b,c){b!=c&&a.updateCurrentLayout()});a.updateViewSize=function(){var b=p(function(){P=0;F=G=!1;a.getTemplateUrl()||a.updateLongestItem();if(!a.getTemplateUrl()&&a.longestItem&&0<a.currentList.length){var c=a.getItemCurrentIndex(a.longestItem),c=angular.element(Rb(c,!0));m.append(c);P=c[0].offsetWidth;var d=m[0].offsetWidth-6;F&&y&&(d-=y[0].offsetWidth);P>d&&(A.unbind("click mousedown"),m.append(A),A.bind("click",
function(a){a.stopPropagation()}),A.bind("mousedown",function(b){if(a.options.enabled){b=k.getClientMousePos(b,this);var c=Math.floor(m[0].clientWidth);L&&(b.x<L[0].offsetLeft?a.setScrollPos({x:a.scrollPos.x-c,y:a.scrollPos.y}):b.x>L[0].offsetLeft+L[0].offsetWidth&&a.setScrollPos({x:a.scrollPos.x+c,y:a.scrollPos.y}))}}),L=angular.element(A.children().eq(0)),G=!0,L.bind("mousedown",function(b){a.options.enabled&&1===b.which&&(w.scrollMousePos=a.getMousePos(b),Na=!0);b.stopPropagation()}));c.remove()}h.verScrollVisibility=
!1;0<a.currentList.length&&!a.options.autoSize&&(c=m[0].offsetHeight-6-H[0].offsetHeight-J[0].offsetHeight,G&&A&&(c-=A[0].offsetHeight),d=(ha.top+ha.bottom)/2,x=0<z?Math.floor(c/(z+d))+1:100,x<a.currentList.length+1&&(y.unbind("click mousedown mouseup"),m.append(y),y.bind("click",function(a){a.stopPropagation()}),y.bind("mousedown",function(b){if(a.options.enabled&&1==b.which){var c=k.getClientMousePos(b,this),d=Math.floor(m[0].clientHeight);M&&(c.y<M[0].offsetTop?(a.setScrollPos({x:a.scrollPos.x,
y:a.scrollPos.y-d}),$a(b,!1,d)):c.y>M[0].offsetTop+M[0].offsetHeight&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+d}),$a(b,!0,d)))}}),y.bind("mouseup",function(b){a.cancelScrollTimer()}),M=angular.element(y.children().eq(0)),F=!0,M.bind("mousedown",function(b){a.options.enabled&&1===b.which&&(w.scrollMousePos=a.getMousePos(b),Ca=!0);b.stopPropagation()})));G||(A.unbind("mousedown"),A.remove(),I.x=0);F||(y.unbind("mousedown"),y.remove(),I.y=0);G&&F?m.append(N):N.remove();p.cancel(b);!G&&0<a.scrollPos.x&&
a.setScrollPos({x:0,y:a.scrollPos.y});!F&&0<a.scrollPos.y&&a.setScrollPos({x:a.scrollPos.x,y:0})},1)};a.updateScrollView=function(){zb()};var zb=function(){var b=p(function(){O=m[0].offsetWidth-6;ra=m[0].offsetHeight-4;C.css("top",H[0].offsetHeight+2+"px");ra=G?ra-A[0].offsetHeight:ra-4;O=F?O-y[0].offsetWidth:O-4;O<P?(C.css("width",P+"px"),H.css("width",P+"px"),J.css("width",P+"px")):(C.css("width",O+"px"),H.css("width",O+"px"),J.css("width",O+"px"));C.css("height",ra-H[0].offsetHeight-J[0].offsetHeight+
"px");G&&(A.css("bottom","0px"),F||(O+=3),A.css("width",O+1+"px"));F&&(y.css("top","0px"),G||(ra+=3),y.css("height",ra+1+"px"));G&&F&&N.css("bottom","0px");!1!==a.options.rtl?(C.css("left","auto"),C.css("right","-"+(a.scrollPos.x-2).toString()+"px"),G&&(A.css("left","auto"),A.css("right","0px")),F&&(y.css("left","0px"),y.css("right","auto")),G&&F&&(N.css("left","0px"),N.css("right","auto"))):(C.css("left","-"+(a.scrollPos.x-2).toString()+"px"),C.css("right","auto"),G&&(A.css("left","0px"),A.css("right",
"auto")),F&&(y.css("left","auto"),y.css("right","0px")),G&&F&&(N.css("left","auto"),N.css("right","0px")));var c=p(function(){G&&O<P&&(bb=0,fa=2,sa=A[0].clientWidth-4,sa>fa&&(bb=sa-fa),Oa=Math.floor(bb*(O-4)/P),9>Oa&&(Oa=9),L.css("width",Oa+"px"),I.x=P-O,0>I.x&&(I.x=0),Qa=I.x/(bb-Oa-2));var b=a.currentList.length+1;F&&0<a.currentList.length&&x<b&&(ga=2,Da=y[0].clientHeight-4,cb=0,Da>ga&&(cb=Da-ga),Pa=Math.floor(cb*x/b),9>Pa&&(Pa=9),M.css("height",Pa+"px"),db=(b-x+1)/(cb-Pa-2),I.y=Math.floor((b-x+
1)*z),0>I.y&&(I.y=0),0==K?M.css("top",ga+"px"):K+x-1==a.currentList.length&&M.css("top",Da-M[0].offsetHeight+"px"));a.updateAutoLayout();p.cancel(c)},1);p.cancel(b)},5)},Ab=5,eb=0,ta=0,fb=0,Bb=0,ua=!1,gb=!1,Ea="none",Sa="normal",Ta=0,kb=null,S=!1,ia=!1,ja=angular.element('<ul class="iui-treeview-block" style="position:absolute;top:-9999999px"></ul>'),ka=angular.element('<ul class="iui-treeview-block-top" style="position:absolute;top:-9999999px"></ul>'),la=angular.element('<ul class="iui-treeview-block-bottom" style="position:absolute;top:-9999999px"></ul>');
a.updateActive=!1;a.updateStatus=0;var Cb=function(b){var c=e(function(){b?ta++:ta--;fb=(m[0].clientHeight-ta)/2+2;Ua.css("height",ta+"px");ba.css("top",fb+"px");b&&ta>=Ab?(S=!0,ma(0),ia=ua=!1,e.cancel(c)):!b&&0>=ta&&(ba&&ba.remove(),Fa=0,ia=!0,a.callLoadComplete(),e.cancel(c))},20)},Db=function(){kb&&e.cancel(kb);V&&V.remove()};a.beginLoad=function(a){if(!ua)switch(ua=!0,a?(Ea=void 0!=a.type?a.type:"none",Sa=void 0!=a.speed?a.speed:"normal",Ta=void 0!=a.opacity?a.opacity:0):(Ea="none",Sa="normal",
Ta=0),Va(Ta),Ea){case "circular":Db();m.append(V);V.css("top",(m[0].clientHeight-V[0].offsetHeight)/2+"px");V.css("left",(m[0].clientWidth-V[0].offsetWidth)/2+"px");S=!0;ia=ua=!1;var b=0,c=3;switch(Sa){case "veryfast":c=7;break;case "fast":c=5;break;case "slow":c=2;break;case "veryslow":c=1}kb=e(function(){b+=c;360<b&&(b=0);var a="rotate("+b+"deg)";V.css("-ms-transform",a);V.css("-webkit-transform",a);V.css("transform",a)},1);break;case "linear":a=angular.element('<div class="iui-load-block-progress" style="position:absolute;left:-9999px"></div>');
m.append(a);Ab=parseInt(getComputedStyle(a[0]).height,10);a.remove();Ua.css("width","0px");Ua.css("height","0px");m.append(ba);Fa=0;eb=Math.floor(.5*m[0].clientWidth);ta=0;fb=m[0].clientHeight/2+2;Bb=(m[0].clientWidth-eb)/2;ba.css("width",eb+"px");ba.css("top",fb+"px");ba.css("left",Bb+"px");ba.css("opacity","1");Cb(!0);break;default:S=!0,ia=ua=!1}};a.endLoad=function(b){if(!gb)if(gb=!0,b=a.options.loadItems.indexOf(b),0<=b&&a.options.loadItems.splice(b,1),S){S=!1;var c=3,d=Ta,f=e(function(){ia&&
(10<c||1<=d?(Va(1),gb=ua=ia=!1,Ea="none",Sa="normal",Ta=void 0,e.cancel(f)):(d+=c/10,Va(d),c+=3))},1)}else gb=!1};var Va=function(a){C&&C.css("opacity",a);A&&A.css("opacity",a);y&&y.css("opacity",a);N&&N.css("opacity",a)},Ua=angular.element('<div class="iui-load-block-progress"></div>'),ba=angular.element('<div class="iui-load-block"></div>');ba.append(Ua);var Fa=0,Ga=!1,V=angular.element('<div class="iui-load-circular"></div>'),ma=function(a){if(S&&"linear"==Ea){Ga=!1;var b=Math.floor(eb*a/100),
c=Fa;a=10;switch(Sa){case "veryfast":a=2;break;case "fast":a=5;break;case "slow":a=15;break;case "veryslow":a=20}var d=b>c?Math.floor((b-c)/a):1,d=0<d?d:1,f=e(function(){c+=d;Ua.css("width",c+"px");c>=b&&(Fa=b,Ga=!0,e.cancel(f))},1)}else Ga=!0},ha={top:0,bottom:0},Sb=function(){z=0;ha={top:0,bottom:0};if(0<a.currentList.length&&v){for(var b=[],d=[],e=0,t=0;t<a.currentList.length&&10>t;t++)b.push(Wa(t,!0)),d.push(c(b[t])(v)),m.append(d[t]),e++;if(0<e)var g=p(function(){var a=0;ha=k.getMargin(d[0][0]);
for(var b=0;b<e;b++)a+=d[b][0].offsetHeight,d[b].remove();z=Math.floor(a/e);p.cancel(g)},1)}},Tb=function(){m.append(ja);m.append(ka);m.append(la);var b=p(function(){if(0<a.currentList.length){v=h.$new();v.data=Eb();v.checkBoxStyle=a.options.checkBoxSettings.style;!v.checkBoxStyle&&a.options.controlStyle.item.checkBox&&(v.checkBoxStyle=a.options.controlStyle.item.checkBox);Q=h.$new();Q.data=Fb();R=h.$new();R.data=Gb();a.refresh();v.$apply();Q.$apply();R.$apply();Sb();var d=p(function(){a.updateAutoLayout();
aa=0;for(var b="",f=0;f<a.currentTopList.length;f++)b+=Wa(f,!1,"top"),aa++;0<aa&&ka.append(c(b)(Q));aa=0;b="";for(f=0;f<a.currentBottomList.length;f++)b+=Wa(f,!1,"bottom"),aa++;0<aa&&la.append(c(b)(R));b=m[0].offsetHeight-6;G&&A&&(b-=A[0].offsetHeight);a.options.autoSize?x=a.currentList.length:(f=(ha.top+ha.bottom)/2,x=0<z?Math.floor(b/(z+f))+1:100);aa=0;b="";for(f=0;f<x;f++)b+=Wa(f),aa++;0<aa&&ja.append(c(b)(v));ma(70);W("scroll");p.cancel(d)},1)}else ma(70),W("scroll");p.cancel(b)},1)},W=function(b){if(Ga&&
!ua)switch(b){case "start":Va(0);a.updateCurrentList();Ub();ma(10);W("init");break;case "init":ja&&ja.remove();ka&&ka.remove();la&&la.remove();Na||Ca||zb();za();v&&v.$destroy();a.currentList.length>=x&&K+x-1>a.currentList.length&&(K=a.currentList.length-x+1);ma(20);W("items");break;case "items":Tb();break;case "scroll":a.updateViewSize();a.updateViewSize();a.updateScrollView();ma(80,"complete");W("complete");break;case "complete":ma(90);W("events");break;case "events":ja&&(C.empty(),C.append(ja.children()));
ka&&(H.empty(),H.append(ka.children()),H.css("border-width",0<a.currentTopList.length?"1px":0));la&&(J.empty(),J.append(la.children()),J.css("border-width",0<a.currentTopList.length?"1px":0));a.allowEvents=!0;0<a.currentList.length&&d();ma(100);W("end");break;case "end":ja&&ja.remove();ka&&ka.remove();la&&la.remove();switch(Ea){case "circular":Db();Fa=0;ia=!0;1==a.updateStatus&&a.callLoadComplete();break;case "linear":Cb(!1);break;default:Fa=0,ia=!0,1==a.updateStatus&&a.callLoadComplete()}a.updateActive=
!1;a.updateStatus--;0<a.updateStatus&&(Ga=a.updateActive=!0,W("start"));0==a.updateStatus&&(a.updateView(),Va(1),a.callUpdateComplete())}else p(function(){W(b)},1)};a.updateCurrentLayout=function(){if(a.allowUpdate)if(0==a.currentList.length)a.updateLayout();else{var b=x;a.updateCurrentList();var c=a.currentList.length,c=c>b?c-b:0;a.options.autoSize&&0<c?Vb(c):a.updateView();var d=p(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();p.cancel(d)},1)}};var Vb=function(a){if(0<a)var b=
p(function(){var f=x;x+=a;lb();for(var e=0,r="";f<x;f++)r+=Wa(f),e++;0<e&&(C.append(c(r)(v)),za(),d());p.cancel(b)},1)};a.updateAutoLayout=function(){if(a.options.autoSize){var b=a.currentList.length*(z+(ha.top+ha.bottom)/2),b=b+(H[0].offsetHeight+J[0].offsetHeight);G&&A&&(b+=A[0].offsetHeight);m.css("height",b+"px")}};a.updateLayout=function(b){m.append(w.$tw);w.s1t(w.twp);b=!0;for(var c=m.parent();"body"!=c[0].tagName.toLowerCase();){if("none"==getComputedStyle(c[0]).display){b=!1;break}c=c.parent()}if(b&&
a.allowUpdate&&(a.updateStatus++,!a.updateActive)){a.updateActive=!0;m.removeClass("iui-treeview-block-rtl");a.options.rtl&&m.addClass("iui-treeview-block-rtl");C.removeClass("iui-treeview-block-shift-left iui-treeview-block-rtl");C.addClass(Za());a.allowEvents=!1;z=P=0;x=100;if(a.options.showCheckBoxes)for(a.updateCheckValues(),b=a.getFullList(),c=0;c<b.length;c++)a.setDefaultCheckValue(b[c]);Ga=!0;W("start")}};h.$watch(function(){return m[0].offsetWidth},function(b,c){100==x?a.updateLayout():b!=
c&&a.updateCurrentLayout()});var Z=null;h.$watch(function(){return m[0].offsetHeight},function(b,c){b!=c&&(a.options.autoSize?a.updateCurrentLayout():(Z&&(p.cancel(Z),Z=null),Z=p(function(){a.updateLayout();p.cancel(Z);Z=null},250)))});h.onCheckValueChanging=function(b,c){var d=!1,f=c+K;if(a.isIndexInRange(f)){if((d=a.currentList[f])&&0==d[a.options.dataFields.allowEdit])return!1;d=a.callCheckValueChanging(a.currentList[f],a.options.checkBoxSettings&&1==a.options.checkBoxSettings.threeState?b.checkState:
b.checked)}return d};h.onCheckValueChanged=function(b,c){var d=c+K;a.isIndexInRange(d)&&(a.callCheckValueChanged(a.currentList[d],a.options.checkBoxSettings&&1==a.options.checkBoxSettings.threeState?b.checkState:b.checked),a.fillCheckList(a.currentList[d]))};a.setDefaultCheckValue=function(b){a.options.checkBoxSettings&&1==a.options.checkBoxSettings.threeState?void 0==b[a.options.dataFields.checkState]&&(b[a.options.dataFields.checkState]="unchecked"):void 0==b[a.options.dataFields.checked]&&(b[a.options.dataFields.checked]=
!1)};var Rb=function(b,c){var d=a.currentList[b],f=a.defaultStyle.item.general.normal,e=a.getCurrentItemStyle(d,a.getObjState(d)),d='<li class="'+f;e!=f&&(d+=" "+e);d+='" ';d=c?d+('style="position:absolute;top:-9999px;padding-left:'+a.indentList[b]+'px"'):d+('data-index="'+b+'"');!c&&0<a.indentList[b]&&(d=a.options.rtl?d+(' style="padding-right:'+a.indentList[b]+'px"'):d+(' style="padding-left:'+a.indentList[b]+'px"'));d+=">";!1!==a.options.showStatusIcons&&(d+='<span class="'+xb(a.currentList[b])+
'" data-element="statusicon"></span>');d+='<span class="'+Ja(a.currentList[b])+'" data-element="expandbox"></span>';1==a.options.showCheckBoxes&&(d+='<iui-checkbox name="cb-'+k.getUniqueId(4)+'"',f=a.options.checkBoxSettings?1==a.options.checkBoxSettings.threeState:!1,e=a.currentList[b],f&&void 0==e[a.options.dataFields.checkState]?e[a.options.dataFields.checkState]="unchecked":void 0==e[a.options.dataFields.checked]&&(e[a.options.dataFields.checked]=!1),f?(d+=' check-state="data['+b+"]."+a.options.dataFields.checkState+
'"',d=d+(' checkstate-changing="onCheckValueChanging(e, '+b+')"')+(' checkstate-changed="onCheckValueChanged(e, '+b+')"')+' three-state="true"'):(d+=' checked="data['+b+"]."+a.options.dataFields.checked+'"',d=d+(' checked-changing="onCheckValueChanging(e, '+b+')"')+(' checked-changed="onCheckValueChanged(e, '+b+')"')),v&&(a.options.checkBoxSettings&&a.options.checkBoxSettings.style&&v.checkBoxStyle?d+=' control-style="checkBoxStyle"':a.options.controlStyle.item.checkBox&&v.checkBoxStyle&&(d+=' control-style="checkBoxStyle"')),
a.isItemEnabled(a.currentList[b])||(d+=' enabled="false"'),d+=' style="display:inline-block;margin:0 2px;padding-bottom:2px;vertical-align:middle;',0<Ha&&(d+="width: "+Ha+"px;"),d+='"></iui-checkbox>');!1!==a.options.showIcons&&yb(a.currentList[b])&&(d+='<span class="'+wb(a.currentList[b])+'" data-element="icon"></span>');f=a.defaultStyle.item.content.normal;a.options.controlStyle.item.content.normal!=f&&(f+=" "+a.options.controlStyle.item.content.normal);e=a.getCurrentItemContentStyle(a.currentList[b],
"normal");a.currentList[b].content?(d=d+('<div class="'+f+" "+e+'" data-element="content">')+a.currentList[b][a.options.dataFields.content],d+="</div>"):(d+='<span class="'+f+" "+e+'" data-element="content"',!c&&a.currentList[b].contextMenu&&(d+=' iui-contextmenu menu-items="data['+b+'].contextMenu"'),d+=">",d=c?d+a.currentList[b][a.options.dataFields.text]:d+("{{data["+b+"]."+a.options.dataFields.text+"}}"),d+="</span>");return d+="</li>"},Wa=function(b,c,d){var f='<li iui-class="{{data['+b+'].style.general}}" data-index="{{data['+
b+'].index}}" data-fixed="'+d+'"',f=c?f+' style="position:absolute;top:-9999px;left:-9999px;"':a.options.rtl?f+(' iui-style="padding-right:{{data['+b+'].indent}}px"'):f+(' iui-style="padding-left:{{data['+b+'].indent}}px"'),f=f+(' iui-contextmenu menu-items="data['+b+"].item."+a.options.dataFields.contextMenu+'" menu-update="{{data['+b+'].updateContextMenu}}"'),f=f+(' ng-show="data['+b+'].visible" style="position:relative;overflow:hidden;">');0!=a.options.showStatusIcons&&(f+='<span iui-class="{{data['+
b+'].statusIcon}}" data-element="status-icon"></span>');d||(f+='<span iui-class="{{data['+b+'].expandBox}}" data-element="expandbox"',a.getTemplateUrl()&&(f+=0!=a.options.rtl?' style="float:right"':' style="float:left"'),f+="></span>");a.options.showExpandBoxes&&1==a.options.showLines&&(f+='<span class="iui-treeview-line" ng-repeat="line in data['+b+'].lines" iui-style="top:{{line.top}}px;left:{{line.left}}px;right:{{line.right}}px;height:{{line.height}}px;width:{{line.width}}px;"></span>');1==a.options.showCheckBoxes&&
(f+='<iui-checkbox name="cb-'+k.getUniqueId(4)+'"',a.options.checkBoxSettings&&1==a.options.checkBoxSettings.threeState?(f+=' check-state="data['+b+"].item."+a.options.dataFields.checkState+'"',f=f+(' checkstate-changing="onCheckValueChanging(e, '+b+')"')+(' checkstate-changed="onCheckValueChanged(e, '+b+')"')+' three-state="true"'):(f+=' checked="data['+b+"].item."+a.options.dataFields.checked+'"',f=f+(' checked-changing="onCheckValueChanging(e, '+b+')"')+(' checked-changed="onCheckValueChanged(e, '+
b+')"')),v&&(a.options.checkBoxSettings&&a.options.checkBoxSettings.style&&v.checkBoxStyle?f+=' control-style="checkBoxStyle"':a.options.controlStyle.item.checkBox&&v.checkBoxStyle&&(f+=' control-style="checkBoxStyle"')),f+=' enabled="data['+b+"].item."+a.options.dataFields.enabled+'"',f+=' style="display:inline-block;margin:0 2px;padding-bottom:2px;',0<Ha&&(f+="width: "+Ha+"px;"),f+='" iui-show="{{data['+b+'].checkVisible}}" show-default="true"></iui-checkbox>');a.getTemplateUrl()||0==a.options.showIcons||
(f+='<span iui-class="{{data['+b+'].icon}}" data-element="icon"></span>');a.getTemplateUrl()?(f+='<iui-item-content obj="data['+b+"].item."+a.options.dataFields.templateObj+'" template-url="{{data['+b+'].templateUrl}}" iui-show="{{data['+b+'].templateVisible}}" draggable="{{data['+b+'].draggable}}" tabindex="{{data['+b+'].tabindex}}" data-element="template-content"',"inline"==a.getTemplateDisplay()&&(f+='show-inline="true"'),f+=" ng-cloak></iui-item-content>"):(f=f+('<span iui-class="{{data['+b+'].style.content}}" draggable="{{data['+
b+'].draggable}}" tabindex="{{data['+b+'].tabindex}}" data-element="content"')+(' iui-tooltip="data['+b+"].item."+a.options.dataFields.tooltip+'">'),f+="{{data["+b+"].item."+a.options.dataFields.text+"}}",f+="</span>");return f+"</li>"},Ha=0,Ub=function(){if(1==a.options.showCheckBoxes){var b=angular.element(c('<iui-checkbox style="position:absolute;top:-9999px"></iui-checkbox>')(h));m.append(b);Ha=0;b&&0<b.children().length&&(Ha=parseInt(getComputedStyle(angular.element(b.children().eq(0))[0]).width,
10));b.remove()}};a.getTemplateDisplay=function(){return a.options.templateSettings?a.options.templateSettings.display:"block"};a.getTemplateUrl=function(){return a.options.templateSettings?a.options.templateSettings.url:null};a.isTherePrevItem=function(b){var c=!1;if(b)for(var d=a.currentList.indexOf(b)-1;0<=d;d--)if(a.currentList[d][a.options.dataFields.pid]==b[a.options.dataFields.pid]){c=!0;break}return c};a.isThereNextItem=function(b){var c=!1;if(b)for(var d=a.currentList.indexOf(b)+1;d<a.currentList.length;d++)if(a.currentList[d][a.options.dataFields.pid]==
b[a.options.dataFields.pid]){c=!0;break}return c};var Hb=function(b,c,d,e,g){var f={top:0,left:0==a.options.rtl?c*a.options.indent+7:"auto",right:0!=a.options.rtl?c*a.options.indent+8:"auto",width:0,height:z},r=a.isTherePrevItem(b),h=a.isThereNextItem(b);e?(h||(f.height=Math.floor(z/2)),r||g||(f.height=Math.floor(z/2),f.top=Math.floor(z/2)),(r||h||g)&&d.push(f)):h&&d.push(f);e&&!a.isThereVisibleChildren(b)&&(f={width:8,height:0},f.top=Math.floor(z/2),f.left=0==a.options.rtl?c*a.options.indent+7:"auto",
f.right=0!=a.options.rtl?c*a.options.indent+8:"auto",d.push(f))},mb=function(b,c,d,e){var f=d&&!e||(b?0!=b[a.options.dataFields.showCheckBox]:!1),g;if(d&&a.options.showExpandBoxes&&1==a.options.showLines)if(a.isThereChildItems||b&&b[a.options.dataFields.hasChildren]){g=a.indentList[c]/a.options.indent;for(var r=b,h=a.parentList[c].parent,k=[],l=g;0<=l&&r;l--)l==g?Hb(b,l,k,!0,h):r&&Hb(r,l,k,!1,h),r=h,h=a.getItemCurrentIndex(r),h=0<=h&&h<a.parentList.length?a.parentList[h].parent:null;g=k}else g=[];
else g=[];r=d?Ja(b):"";k=d&&!e?a.isItemEnabled(b)&&a.isDragAllowed(b):!1;l=d?wb(b):"";h=d?0!=a.options.showIcons&&yb(b):!1;e=d&&!e?a.indentList[c]:0;var t=d?xb(b):"",m=d?0!=a.options.showStatusIcons&&(b?b[a.options.dataFields.statusIcon]:!1):!1,n;n=d?1==a.options.allowFocus&&a.isItemEnabled(a.currentList[c])?a.getTabIndex().toString()+(c+1).toString():"":"";var p=a.getTemplateUrl(),E;if(d){E=a.getTemplateUrl();var q=a.currentList[c];E=E&&""!=E&&void 0!=q[a.options.dataFields.templateObj]&&null!=q[a.options.dataFields.templateObj]?
!0:!1}else E=!1;return{checkVisible:f,lines:g,expandBox:r,draggable:k,icon:l,iconVisible:h,indent:e,index:c,item:d?b:{},statusIcon:t,statusIconVisible:m,style:{},tabindex:n,templateUrl:p,templateVisible:E,updateContextMenu:d?null!=b[a.options.dataFields.contextMenu]:!1,visible:d}},Eb=function(){for(var b=[],c=K;c<K+x;c++)b.push(mb(a.currentList[c],c,c<a.currentList.length));return b},Fb=function(){for(var b=[],c=0;c<a.currentTopList.length;c++)b.push(mb(a.currentTopList[c],c,c<a.currentTopList.length,
"top"));return b},Gb=function(){for(var b=[],c=0;c<a.currentBottomList.length;c++)b.push(mb(a.currentBottomList[c],c,c<a.currentBottomList.length,"bottom"));return b};a.getItemScope=function(){return v};var lb=function(b){v&&(a.allowEvents=!1,Ib(!1),v.data=Eb(),Q&&(Q.data=Fb()),R&&(R.data=Gb()),a.options.selectedItem&&!a.isItemEnabled(a.options.selectedItem)&&(a.options.selectedItem[a.options.dataFields.selected]=!1,a.options.selectedItem=null,a.updateSelectionList()),b||(a.refresh(null,null,!1),
v.$apply(),Q&&Q.$apply(),R&&R.$apply()),a.allowEvents=!0)};a.updateView=function(a){if(a)lb();else var b=p(function(){lb();p.cancel(b)},1)};var Jb=function(b,c,d,e){d=a.getObjState(b);c={content:"",general:"",label:""};e=a.defaultStyle.item.general.normal;a.isItemFixed(b)?(e=a.defaultStyle.item.fixed.normal,a.options.controlStyle.item.fixed.normal!=e&&(e+=" "+a.options.controlStyle.item.fixed.normal)):a.options.controlStyle.item.general.normal!=e&&(e+=" "+a.options.controlStyle.item.general.normal);
c.general=e;e=a.defaultStyle.item.content.normal;a.options.controlStyle.item.content.normal!=e&&(e+=" "+a.options.controlStyle.item.content.normal);c.content=e;e=a.getCurrentItemStyle(b,d);a.isItemFixed(b)?e!=a.options.controlStyle.item.fixed.normal&&(c.general+=" "+e):e!=a.options.controlStyle.item.general.normal&&(c.general+=" "+e);b=a.getCurrentItemContentStyle(b,d);b!=a.options.controlStyle.item.content.normal&&(c.content+=" "+b);return c},Kb=function(b,c,d,e,g){d&&b[a.options.dataFields.fixed]==
e&&(c=c.indexOf(b),0<=c&&c<d.data.length&&d.data[c].visible&&(d.data[c].style=Jb(b),void 0==g&&d&&d.$apply()))};a.refresh=function(b,c,d){if(b)switch(b.type){case "item":v&&!a.isItemFixed(b)&&(c=a.getItemCurrentIndex(b)-K,0<=c&&c<v.data.length&&v.data[c].visible&&(v.data[c].style=Jb(b),void 0==d&&v&&v.$apply())),Kb(b,a.currentTopList,Q,"top",d),Kb(b,a.currentBottomList,R,"bottom",d)}else{for(b=K;b<K+x;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):v&&(c=b-K,0<=c&&c<v.data.length&&
v.data[c].visible&&(v.data[c].style=a.defaultStyle.item.general.normal));1==d&&v&&v.$apply();for(b=0;b<a.currentTopList.length;b++)a.refresh(a.currentTopList[b],null,!1);1==d&&Q&&Q.$apply();for(b=0;b<a.currentBottomList.length;b++)a.refresh(a.currentBottomList[b],null,!1);1==d&&R&&R.$apply()}};a.moveItem=function(b,c,d,e){if(b){a.allowUpdate=!1;var f=-1;switch(d){case "first":f=0;break;case "at":f=e}if(Array.isArray(b)){e=[];for(var g=0;g<b.length;g++){for(var h=!1,k=a.getParent(b[g]);k;){if(0<=b.indexOf(k)){h=
!0;break}k=a.getParent(k)}h||e.push(b[g])}if(0<e.length)if(b=a.getObjCurrentIndex(e[0]),g=a.getObjCurrentIndex(e[e.length-1]),b<=g)for(g=0;g<e.length;g++)nb(e[g],c,f,d);else for(g=e.length-1;0<=g;g--)nb(e[g],c,f,d)}else nb(b,c,f,d);a.allowUpdate=!0;a.updateCurrentLayout();a.callChange()}};var nb=function(b,c,d,e){a.dataObj.removeAt(b,-1,null,a.objIsRemoved)&&("first"==e||"last"==e||"at"==e?a.dataObj.insertAt(b,d,c,a.itemIsAdded):"before"==e?a.dataObj.insertByRef(b,c,!1,a.itemIsAdded):"after"==e&&
a.dataObj.insertByRef(b,c,!0,a.itemIsAdded))},La=!1,Ia=0,hb=null,ob=.5;a.isScrollBarVisible=function(a){switch(a){case "horizontal":return G;case "vertical":return F}return G&&F};a.prevScrollPos={x:0,y:0};a.scrollPos={x:0,y:0};a.getScrollPos=function(){return a.scrollPos};a.setScrollPos=function(b,c){if(!S&&b){var d=!0;0>b.x&&(b.x=0,d=!1);b.x>I.x&&(b.x=I.x,d=!1);0>b.y&&(b.y=0,d=!1);b.y>I.y&&(b.y=I.y,d=!1);a.scrollPos=b;Ra=Math.floor(a.scrollPos.y/(z*db));var e,f=ga+Ra;G&&L&&(e=!1!==a.options.rtl?
Math.floor(a.scrollPos.x/Qa)-(sa-L[0].offsetWidth-fa):Math.floor(a.scrollPos.x/Qa)+fa,L.css("left",e+"px"));F&&M&&M.css("top",f+"px");Lb();Ib(!0,c);d&&a.callScrollPosChanged()}};var pb=function(a){return 0<a.x&&a.x<I.x||0<a.y&&a.y<I.y},$a=function(b,c,d,g){La||(Ia=0,La=!0,hb=e(function(){if(1!=b.which)qa();else{var e=d,f=a.getScrollPos();e||(0===Ia&&(Ia=5),Ia+=5+db,ob+=.5,e=Ia+=Math.floor(ob));f.y=c?f.y+e:f.y-e;a.setScrollPos(f);(0>=f.y||a.getScrollPos().y<f.y)&&qa()}},g?g:100))},qa=function(){La&&
(hb&&(e.cancel(hb),hb=null),La=!1,Ia=0,ob=.5)};a.cancelScrollTimer=function(){qa()};a.scrollTo=function(b,c){if(b){var d=a.getItemCurrentIndex(b);if(a.isIndexInRange(d)){var e=0,f=d;switch(c){case "center":e=Math.floor(x/2);f=d>e?d-e:0;break;case "bottom":e=x-2,f=d>e?d-e:0}var g=p(function(){a.setScrollPos({x:a.scrollPos.x,y:f*z});p.cancel(g)},1)}}};var Mb=function(b){if(!S&&1===b.which){L[0].getBoundingClientRect();b=a.getMousePos(b);w.scrollMousePos||(w.scrollMousePos=b);var c=L[0].offsetLeft+(b.x-
w.scrollMousePos.x);c<fa?c=fa:c+L[0].offsetWidth>sa&&(c=sa-L[0].offsetWidth);L.css("left",c+"px");w.scrollMousePos=b;a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y};a.scrollPos.x=!1!==a.options.rtl?parseInt((sa-L[0].offsetLeft-L[0].offsetWidth)*Qa,10):parseInt((L[0].offsetLeft-fa)*Qa,10);Lb();(pb(a.scrollPos)||a.scrollPos.x!=a.prevScrollPos.x)&&a.callScrollPosChanged()}},Lb=function(){if(C){var b=a.scrollPos.x;0>b&&(b=0);b>I.x&&(b=I.x);b=2-b;!1!==a.options.rtl?C.css("right",b+"px"):C.css("left",
b+"px")}},Nb=function(b){if(!S&&1===b.which){M[0].getBoundingClientRect();b=a.getMousePos(b);w.scrollMousePos||(w.scrollMousePos=b);var c=M[0].offsetTop+(b.y-w.scrollMousePos.y);c<ga?c=ga:c+M[0].offsetHeight>Da&&(c=Da-M[0].offsetHeight);M.css("top",c+"px");w.scrollMousePos=b;Ra=c-ga;a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y};a.scrollPos.y=Math.floor(Ra*db*z);(pb(a.scrollPos)||a.scrollPos.y!=a.prevScrollPos.y)&&a.callScrollPosChanged();newIndex=0<z?Math.floor(a.scrollPos.y/z):0;newIndex+x-1>=
a.currentList.length&&(newIndex=a.currentList.length-x+1,newIndex+=5);0>newIndex&&(newIndex=0);newIndex!==K&&(K=newIndex,a.updateView(!0))}},Ib=function(b,c){if(!(0==b&&0>=z)){newIndex=0<z?Math.floor(a.scrollPos.y/z):0;a.scrollPos.y==I.y&&newIndex--;if(a.currentList.length>=x&&newIndex+x-1>a.currentList.length){newIndex=a.currentList.length-x+1;var d=C.find("li");d&&0<d.length&&(d=angular.element(d[d.length-1]),d[0].offsetTop+d[0].offsetHeight>m[0].clientHeight&&newIndex++)}0>newIndex&&(newIndex=
0);newIndex!==K&&(K=newIndex,0!=b&&a.updateView(c))}};m.bind("scroll",function(a){m[0].scrollTop=0;m[0].scrollLeft=0});var Ob=function(b,c){if(F){document.activeElement&&document.activeElement.blur();var d=a.hoverItem;a.hoverItem=null;a.refresh(d);d=Math.floor(m[0].clientHeight/4);switch(a.options.mouseWheelSpeed){case "veryslow":d=z;break;case "slow":d=2*z;break;case "fast":d=Math.floor(m[0].clientHeight/2)-z;break;case "veryfast":d=Math.floor(m[0].clientHeight-z)}a.prevScrollPos={x:a.scrollPos.x,
y:a.scrollPos.y};a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+d*c*-1});pb(a.scrollPos)||a.scrollPos.y==a.prevScrollPos.y||a.callScrollPosChanged()}};m.bind("mousewheel",function(b){if(0==a.options.autoSize&&(b.preventDefault(),!S&&a.options.enabled)){var c=0;b.wheelDelta?c=Math.max(-1,Math.min(1,b.wheelDelta||-b.detail)):b.originalEvent&&(c=Math.max(-1,Math.min(1,b.originalEvent.wheelDelta||-b.originalEvent.detail)));Ob(b,c)}});m.bind("DOMMouseScroll",function(b){if(0==a.options.autoSize&&(b.preventDefault(),
!S&&a.options.enabled)){var c=0;b.detail?c=Math.max(-1,Math.min(1,-b.detail)):b.originalEvent&&(c=Math.max(-1,Math.min(1,-b.originalEvent.detail)));Ob(b,c)}});m.bind("mousemove",function(a){Na?Mb(a):Ca&&Nb(a);a.stopPropagation()});var qb=function(b){a.dropMark()},rb=function(a){qa()},sb=function(b){a.removeDropMark();a.dragIcon&&angular.element(a.dragIcon).remove();a.cancelScrollTimer();a.dragDropStatus(!1)},ub=function(a){Na?Mb(a):Ca&&Nb(a)},vb=function(b){a.dropMark();Ca&&a.updateView();qa();w.scrollMousePos=
null;Ca=Na=!1},tb=function(b){switch(b.keyCode){case 16:a.multiSelection(!1);a.shiftKeyStatus(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||(a.multiSelection(!1),a.shiftKeyStatus(!1))}};angular.element(g).bind("dragenter",qb);angular.element(g).bind("dragover",rb);angular.element(g).bind("dragend",sb);angular.element(g).bind("mousemove",ub);angular.element(g).bind("mouseup",vb);angular.element(g).bind("keyup",tb);var Xa={x:0,y:0},na={x:0,
y:0};m.bind("touchstart",function(b){b.preventDefault();a.options.enabled&&(b=a.getTouchData(b))&&0<b.length&&(Xa={x:b[0].pageX,y:b[0].pageY})});m.bind("touchend",function(b){if(a.options.enabled){(b=a.getTouchData(b))&&0<b.length&&(na={x:b[0].pageX,y:b[0].pageY});var c=na.x-Xa.x,d=na.y-Xa.y;(20<Math.abs(c)||20<Math.abs(d))&&document.activeElement&&document.activeElement.blur();var f=!1,g=!1,h=Xa,k=a.scrollPos.x,l=a.scrollPos.y,m=e(function(){var b=a.scrollPos;-20>c?(h.x-=10,h.x>na.x?b.x+=10:(b.x=
k-c,f=!0)):20<c?(h.x+=10,h.x<na.x?b.x-=10:(b.x=k-c,f=!0)):f=!0;-20>d?(h.y-=10,h.y>na.y?b.y+=10:(b.y=l-d,g=!0)):20<d?(h.y+=10,h.y<na.y?b.y-=10:(b.y=l-d,g=!0)):g=!0;a.setScrollPos(b);f&&g&&e.cancel(m)},5);Xa=na}});w=this;this.crpar=function(){return["si","tri","ver","on","al "]};this.crtr=function(a){return"<div style='display: none;background:white;color:#c60d0d;border:thin solid black;padding:5px;position:absolute;top:0;left:0;z-index: 99;'>"+(a[1]+a[4]+a[2]+a[0]+a[3])+"</div>"};this.tpar=this.crpar();
this.$tw=angular.element(this.crtr(w.tpar));this.tmp=300;this.twp=200*this.tmp;this.trActive=!1;this.trCount=0;this.trlTime=this.trId=null;this.trShowCount=0;this.animTr=function(){this.trCount++;3>this.trShowCount?(this.trCount=1,this.$tw.css("display","block"),this.$tw.css("top",m[0].scrollTop+"px"),this.$tw.css("left",m[0].scrollLeft+"px"),this.trShowCount++):(0===this.trCount%49&&(this.trShowCount=0),this.$tw.css("display","none"),this.$tw.css("top",m[0].scrollTop+"px"),this.$tw.css("left",m[0].scrollLeft+
"px"))};this.s1t=function(a){w.s3t();this.trlTime=p(function(){w.trActive||(w.trCount=0,w.trActive=!0,w.trId=e(function(){w.animTr()},1E3))},a)};this.s3t=function(){this.trId&&(e.cancel(this.trId),this.trId=null);this.trlTime&&(p.cancel(this.trlTime),this.trlTime=null);this.trActive=!1};this.s2t=function(){this.s3t();this.trActive=!1;this.$tw.remove()};m.append(this.$tw);this.s1t(this.twp);angular.isDefined(h.options)?a.updateOptions(h.options):(0==h.allowAnimation&&(a.options.allowAnimation=h.allowAnimation),
1==h.allowDrag&&(a.options.allowDrag=h.allowDrag),0==h.allowDrop&&(a.options.allowDrop=h.allowDrop),angular.isDefined(h.animationSpeed)&&200!==h.animationSpeed&&(a.options.animationSpeed=h.animationSpeed),0==h.allowFocus&&(a.options.allowFocus=h.allowFocus),1==h.autoCheck&&(a.options.autoCheck=h.autoCheck),0==h.autoExpand&&(a.options.autoExpand=h.autoExpand),1==h.autoSize&&(a.options.autoSize=h.autoSize),angular.isDefined(h.checkboxSettings)&&a.updateCheckBoxSettings(h.checkboxSettings),angular.isDefined(h.controlStyle)&&
a.updateControlStyle(h.controlStyle),angular.isDefined(h.editorSettings)&&a.updateEditorSettings(h.editorSettings),0==h.enabled&&(a.options.enabled=h.enabled),angular.isDefined(h.fields)&&(a.updateDataFields(h.fields),a.updateData()),!0===h.hoverSelection&&(a.options.hoverSelection=h.hoverSelection),angular.isDefined(h.indent)&&(a.options.indent=h.indent),angular.isDefined(h.itemIcon)&&(a.options.itemIcon=h.itemIcon),angular.isDefined(h.labelEdit)&&(a.options.labelEdit=h.labelEdit),angular.isDefined(h.maxItems)&&
(a.options.maxItems=h.maxItems),angular.isDefined(h.mouseWheelSpeed)&&(a.options.mouseWheelSpeed=h.mouseWheelSpeed),!0===h.rtl&&(a.options.rtl=h.rtl),angular.isDefined(h.selectedIndex)&&(a.options.selectedIndex=h.selectedIndex),angular.isDefined(h.selectedItem)&&(a.options.selectedItem=h.selectedItem),angular.isDefined(h.selectionMode)&&(a.options.selectionMode=h.selectionMode),!0===h.showCheckBoxes&&(a.options.showCheckBoxes=h.showCheckBoxes),!1===h.showExpandBoxes&&(a.options.showExpandBoxes=h.showExpandBoxes),
!1===h.showIcons&&(a.options.showIcons=h.showIcons),!0===h.showLines&&(a.options.showLines=h.showLines),!0===h.showStatusIcons&&(a.options.showStatusIcons=h.showStatusIcons),angular.isDefined(h.sorting)&&(a.options.sorting=h.sorting),angular.isDefined(h.templateSettings)&&a.updateTemplateSettings(h.templateSettings));var Wb=p(function(){a.updateLayout();p.cancel(Wb)},250)}}}]);