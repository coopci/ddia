/*
  filename: angular.integralui.combobox.min.js
  version : 1.2.5
  Copyright © 2014-2017 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui").factory("IntegralUIComboBoxService",["$rootScope","IntegralUIPublicService",function(b,k){return{loadData:function(f,k,g){b.$broadcast(f+"-load-data",k,g)},findItemById:function(f,k){b.$broadcast(f+"-find-item-by-id",k);var g=this.getTempData();this.clearTempData();return g?g:null},findItemByText:function(f,k){b.$broadcast(f+"-find-item-by-text",k);var g=this.getTempData();this.clearTempData();return g?g:null},clearTempData:function(){k.clearTempData()},closeDropDown:function(f){b.$broadcast(f+
"-close-drop-down")},getTempData:function(){return k.getTempData()},openDropDown:function(f){b.$broadcast(f+"-open-drop-down")},setTempData:function(b){k.setTempData(b)},getList:function(f){b.$broadcast(f+"-get-list");f=this.getTempData();this.clearTempData();return f?f:[]},selectedItem:function(f,k){if(k)b.$broadcast(f+"-set-selected-item",k);else{b.$broadcast(f+"-get-selected-item");var g=this.getTempData();this.clearTempData();return g?g:null}},refresh:function(f,k){b.$broadcast(f+"-refresh",k)},
resumeLayout:function(f){b.$broadcast(f+"-resume-layout")},suspendLayout:function(f){b.$broadcast(f+"-suspend-layout")},updateLayout:function(f){b.$broadcast(f+"-update-layout")},updateView:function(f){b.$broadcast(f+"-update-view")}}}]).controller("IntegralUIComboBoxController",["$scope","$element","IntegralUIInternalService","IntegralUIDataService","IntegralUIComboBoxService",function(b,k,f,F,g){var d=this;d.defaultCheckBoxStyle={general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",
checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}};d.defaultStyle={general:{disabled:"iui-combobox-disabled",normal:"iui-combobox"},button:{general:{disabled:"iui-combobox-button-disabled",focused:"iui-combobox-button-focused",hovered:"iui-combobox-button-hovered",normal:"iui-combobox-button"},dropdown:{disabled:"iui-combobox-button-dropdown-disabled",focused:"iui-combobox-button-dropdown-focused",hovered:"iui-combobox-button-dropdown-hovered",
normal:"iui-combobox-button-dropdown"}},content:{disabled:"iui-combobox-content-disabled",focused:"iui-combobox-content-focused",hovered:"iui-combobox-content-hovered",normal:"iui-combobox-content"},list:{general:"iui-list",item:{general:{disabled:"iui-list-item-disabled",focused:"iui-list-item-focused",normal:"iui-list-item",hovered:"iui-list-item-hovered",selected:"iui-list-item-selected"},checkBox:{general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",
indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}},content:{disabled:"iui-list-item-content-disabled",focused:"iui-list-item-content-focused",normal:"iui-list-item-content",hovered:"iui-list-item-content-hovered",selected:"iui-list-item-content-selected"}}}};this.updateOptions=function(a){a?(d.options={dropDownHeight:f.isFieldAvailable(a.dropDownHeight,100),dropDownWidth:f.isFieldAvailable(a.dropDownWidth,200),enabled:f.isFieldAvailable(a.enabled,!0),integralHeight:f.isFieldAvailable(a.integralHeight,
!0),itemIcon:f.isFieldAvailable(a.itemIcon,""),maxDropDownItems:f.isFieldAvailable(a.maxDropDownItems,7),rtl:f.isFieldAvailable(a.rtl,!1),selectedItem:f.isFieldAvailable(a.selectedItem,d.options.selectedItem?d.options.selectedItem:null),showIcons:f.isFieldAvailable(a.showIcons,!0)},d.updateDataFields(a.dataFields),d.updateControlStyle(a.controlStyle)):(d.options={controlStyle:d.defaultStyle,dropDownHeight:100,dropDownWidth:200,enabled:!0,integralHeight:!0,itemIcon:"",maxDropDownItems:7,rtl:!1,selectedItem:null,
showIcons:!0},d.updateDataFields())};d.options={};this.updateDataFields=function(a){d.options.dataFields=a?{checkBoxSettings:a.checkBoxSettings?a.checkBoxSettings:"checkBoxSettings",checked:a.checked?a.checked:"checked",checkState:a.checkState?a.checkState:"checkState",content:a.content?a.content:"content",enabled:a.enabled?a.enabled:"enabled",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",items:a.items?a.items:"items",style:a.style?a.style:"style",text:a.text?a.text:"text",value:a.value?a.value:"value"}:
{checkBoxSettings:"checkBoxSettings",checked:"checked",checkState:"checkState",content:"content",enabled:"enabled",icon:"icon",id:"id",items:"items",style:"style",text:"text",value:"value"};d.dataObj&&d.dataObj.updateDataFields(d.options.dataFields)};d.updateOptions();this.getDataFields=function(a){return{content:a.content?a.content:"content",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",objects:a.items?a.items:"items",text:a.text?a.text:"text"}};d.dataObj=new F({objects:b.items,fields:d.getDataFields(d.options.dataFields)});
b.$on(b.name+"-load-data",function(a,b,c){d.loadData(b,c)});this.loadData=function(a,c){d.allowEvents=!1;d.updateDataFields(c);d.dataObj.clear();angular.isDefined(b.items)&&(b.items=a);d.dataObj=new F({objects:b.items,fields:d.getDataFields(d.options.dataFields)});d.updateLayout();d.allowEvents=!0};this.callClick=function(){angular.isDefined(b.events)&&b.events.click?b.events.click():b.click()};this.callDropDownClosing=function(){return angular.isDefined(b.events)&&b.events.dropdownClosing?b.events.dropdownClosing():
b.dropdownClosing()};this.callDropDownClosed=function(){angular.isDefined(b.events)&&b.events.dropdownClosed?b.events.dropdownClosed():b.dropdownClosed()};this.callDropDownOpening=function(){return angular.isDefined(b.events)&&b.events.dropdownOpening?b.events.dropdownOpening():b.dropdownOpening()};this.callDropDownOpened=function(){angular.isDefined(b.events)&&b.events.dropdownOpened?b.events.dropdownOpened():b.dropdownOpened()};this.callEnabledChanged=function(a){angular.isDefined(b.events)&&b.events.enabledChanged?
b.events.enabledChanged({enabled:a}):b.enabledChanged({e:{enabled:a}})};this.callSelectedItemChanged=function(a){angular.isDefined(b.events)&&b.events.selectedItemChanged?b.events.selectedItemChanged({item:a}):b.selectedItemChanged({e:{item:a}})};this.callStyleChanged=function(a){angular.isDefined(b.events)&&b.events.styledChanged?b.events.styleChanged({style:a}):b.styleChanged({e:{style:a}})};b.$on(b.name+"-find-item-by-id",function(a,b){g.setTempData(d.findItemById(b))});b.$on(b.name+"-find-item-by-text",
function(a,b){g.setTempData(d.findItemByText(b))});this.findItemById=function(a){return d.dataObj.findObjectById(a)};this.findItemByText=function(a){return d.dataObj.findObjectByText(a)};b.$on(b.name+"-close-drop-down",function(a){d.closeDropDown()});b.$on(b.name+"-get-list",function(a){g.setTempData(d.getList())});b.$on(b.name+"-open-drop-down",function(a){d.openDropDown()});this.getList=function(){return d.dataObj.getList()};this.isItemEnabled=function(a){return f.isEnabled(a[d.options.dataFields.enabled])};
d.allowUpdate=!0;this.suspendLayout=function(){d.allowUpdate=!1};this.resumeLayout=function(){d.allowUpdate=!0;d.updateLayout()};b.$on(b.name+"-refresh",function(a,b){d.refresh(b)});b.$on(b.name+"-resume-layout",function(a){d.resumeLayout()});b.$on(b.name+"-suspend-layout",function(a){d.suspendLayout()});b.$on(b.name+"-update-layout",function(a){d.updateLayout()});b.$on(b.name+"-update-view",function(a){d.updateView()});b.$on(b.name+"-clear-selection",function(a){d.clearPrevSelection();d.options.selectedItem=
null});b.$on(b.name+"-get-selected-item",function(a){g.setTempData(d.itemSelection())});b.$on(b.name+"-set-selected-item",function(a,b){d.itemSelection(b);d.updateLayout()});this.clearPrevSelection=function(){d.options.selectedItem&&(d.options.selectedItem.selected=!1);d.options.selectedItem=null;d.refresh()};this.itemSelection=function(a,c,f){if(a)d.isItemEnabled(a)&&(d.options.selectedItem=a,a.selected=!0,angular.isDefined(b.selectedItem)&&(b.selectedItem=a),d.callSelectedItemChanged(a),d.refresh());
else return d.options.selectedItem};this.selectItem=function(a){angular.isDefined(b.selectedItem)?b.selectedItem=a:d.options.selectedItem=a;d.updateCombo();d.callSelectedItemChanged(a)};var h=function(a){if(a){var b;b=(b=a.general)?f.isString(b)?b:{disabled:f.isFieldAvailable(b.disabled,"iui-combobox-button-disabled"),focused:f.isFieldAvailable(b.focused,"iui-combobox-button-focused"),hovered:f.isFieldAvailable(b.hovered,"iui-combobox-button-hovered"),normal:f.isFieldAvailable(b.normal,"iui-combobox-button")}:
d.defaultStyle.button.general;a=(a=a.dropdown)?f.isString(a)?a:{disabled:f.isFieldAvailable(a.disabled,"iui-combobox-button-dropdown-disabled"),focused:f.isFieldAvailable(a.focused,"iui-combobox-button-dropdown-focused"),hovered:f.isFieldAvailable(a.hovered,"iui-combobox-button-dropdown-hovered"),normal:f.isFieldAvailable(a.normal,"iui-combobox-button-dropdown")}:d.defaultStyle.button.dropdown;return{general:b,dropdown:a}}return d.defaultStyle.button},l=function(a){return a?f.isString(a)?a:{disabled:f.isFieldAvailable(a.disabled,
"iui-combobox-content-disabled"),focused:f.isFieldAvailable(a.focused,"iui-combobox-content-focused"),hovered:f.isFieldAvailable(a.hovered,"iui-combobox-content-hovered"),normal:f.isFieldAvailable(a.normal,"iui-combobox-content")}:d.defaultStyle.content},c=function(a){return a?f.isString(a)?a:{disabled:f.isFieldAvailable(a.disabled,"iui-combobox-disabled"),normal:f.isFieldAvailable(a.normal,"iui-combobox")}:d.defaultStyle.general},a=function(a){if(a){var b=f.isFieldAvailable(a.general,"iui-list");
var c=a.item;if(c){a=c.general;a=f.isString(a)?a:a?{disabled:f.isFieldAvailable(a.disabled,"iui-list-item-disabled"),focused:f.isFieldAvailable(a.focused,"iui-list-item-focused"),normal:f.isFieldAvailable(a.normal,"iui-list-item"),hovered:f.isFieldAvailable(a.hovered,"iui-list-item-hovered"),selected:f.isFieldAvailable(a.selected,"iui-list-item-selected")}:d.defaultStyle.list.item.general;var g=c.checkBox,e;g?(e=f.isFieldAvailable(g.general,"iui-checkbox"),g=(g=g.box)?{general:f.isFieldAvailable(g.general,
"iui-checkbox-box"),disabled:f.isFieldAvailable(g.disabled,"iui-checkbox-disabled"),checked:f.isFieldAvailable(g.checked,"iui-checkbox-checked"),indeterminate:f.isFieldAvailable(g.indeterminate,"iui-checkbox-indeterminate"),unchecked:f.isFieldAvailable(g.unchecked,"iui-checkbox-unchecked")}:d.defaultStyle.list.item.checkBox.box,e={general:e,box:g}):e=d.defaultStyle.list.item.checkBox;c=c.content;c=f.isString(c)?c:c?{disabled:f.isFieldAvailable(c.disabled,"iui-list-item-content-disabled"),focused:f.isFieldAvailable(c.focused,
"iui-list-item-content-focused"),normal:f.isFieldAvailable(c.normal,"iui-list-item-content"),hovered:f.isFieldAvailable(c.hovered,"iui-list-item-content-hovered"),selected:f.isFieldAvailable(c.selected,"iui-list-item-content-selected")}:d.defaultStyle.list.item.content;a={general:a,checkBox:e,content:c}}else a=d.defaultStyle.list.item;return{general:b,item:a}}return d.defaultStyle.list};this.updateControlStyle=function(b){d.options.controlStyle=b?{general:c(b.general),button:h(b.button),content:l(b.content),
list:a(b.list)}:{general:c(d.defaultStyle.general),button:h(d.defaultStyle.button),content:l(d.defaultStyle.content),list:a(d.defaultStyle.list)}};b.$watch("controlStyle",function(a,b){a!=b&&(d.options.controlStyle=a,d.updateLayout(),d.callStyleChanged(a))});b.$watch("dropdownHeight",function(a,b){a!=b&&(d.options.dropDownHeight=a,d.updateLayout())});b.$watch("dropdownWidth",function(a,b){a!=b&&(d.options.dropDownWidth=a,d.updateLayout())});b.$watch("enabled",function(a,b){a!=b&&(d.options.enabled=
a,d.refresh(),d.callEnabledChanged(a))});b.$watch("fields",function(a,b){a!=b&&(d.options.dataFields=a,d.UpdateData())});b.$watch("integralHeight",function(a,b){a!=b&&(d.options.integralHeight=a)});b.$watch("itemIcon",function(a,b){a!=b&&(d.options.itemIcon=a,d.updateLayout())});b.$watch("maxDropdownItems",function(a,b){a!=b&&(d.options.maxDropDownItems=a)});b.$watch("options",function(a,b){a!=b&&(d.updateOptions(a),d.updateLayout())},!0);b.$watch("showIcons",function(a,b){a!=b&&(d.options.showIcons=
a,d.updateLayout())});b.$watch("rtl",function(a,b){a!=b&&(d.options.rtl=a,d.updateLayout())});b.$watch("selectedItem",function(a,b){a!=b&&d.selectItem(a)})}]).directive("iuiCombobox",["$compile","$timeout","$window","$interval","IntegralUIInternalService","IntegralUIListCtrlService",function(b,k,f,F,g,d){return{restrict:"EA",controller:"IntegralUIComboBoxController",transclude:!0,replace:!0,template:'<div class="iui-combobox" data-element="combobox"><span class="iui-combobox-content"></span><span class="iui-combobox-button iui-combobox-button-dropdown"></span><span></span></div>',
scope:{controlStyle:"=",dropdownHeight:"=",dropdownWidth:"=",enabled:"=",fields:"=",integralHeight:"=",itemIcon:"=",items:"=",maxDropdownItems:"=",name:"@",options:"=?",rtl:"=",selectedItem:"=",showIcons:"=",click:"&",enabledChanged:"&",events:"=?",dropdownClosed:"&",dropdownClosing:"&",dropdownOpened:"&",dropdownOpening:"&",selectedItemChanged:"&",styleChanged:"&"},link:function(h,l,c,a,B){var q=this,m=l.children().eq(0),x=l.children().eq(1),e=g.getUniqueId(4);h.listOptions={};var y=function(){h.listOptions=
{controlStyle:a.options.controlStyle.list,itemIcon:a.options.itemIcon,navSelection:!1,rtl:a.options.rtl,showIcons:a.options.showIcons}},u=null,v='<iui-list name="'+e+'" style="position:absolute;" items="items" fields="fields" options="listOptions" after-select="onItemSelected(e)"></iui-list>',n=null,t=!1,z=0,G=0,H=0,L=function(){if(u&&angular.isDefined(h.items)&&0<h.items.length){var a=g.getUniqueId(4),e=b('<iui-list name="'+a+'" style="position:absolute;top:-99px;height:100px" items="items" item-icon="itemIcon"></iui-list>')(h);
angular.element(u).append(e);d.updateLayout(a);var c=k(function(){if(0<e.children().length){var a=e.children().eq(0);0<a.children().length&&(H=angular.element(a.children().eq(0))[0].offsetHeight)}e.remove();k.cancel(c)},1)}};a.openDropDown=function(){C()};a.closeDropDown=function(){A()};var C=function(c){if(!t&&0!=a.callDropDownOpening()&&(n&&n.remove(),u)){y();v='<iui-list name="'+e+'" style="position:absolute;" items="items" fields="fields" options="listOptions" after-select="onItemSelected(e)" lost-focus="onListLostFocus(e)" tabindex="999"></iui-list>';
n=b(v)(h);L();var g=k(function(){l.css("border-bottom-left-radius","0px");l.css("border-bottom-right-radius","0px");var b=l[0].getBoundingClientRect(),c=angular.element(f)[0].pageXOffset,y=angular.element(f)[0].pageYOffset,y=b.bottom+y-1,b=b.left+c,c=parseInt(getComputedStyle(l[0]).width,10);c<a.options.dropDownWidth&&(c=a.options.dropDownWidth);var w=a.options.dropDownHeight;a.options.integralHeight&&(w=H*a.options.maxDropDownItems);n.css("top",y+"px");n.css("left",b+"px");n.css("width",c+"px");
n.css("height",w+"px");n.css("z-index","999");angular.element(u).append(n);y=a.getList();!a.options.selectedItem&&y&&0<y.length&&(a.options.selectedItem=y[0]);d.selectedItem(e,a.options.selectedItem);d.updateLayout(e);var h=k(function(){d.ensureVisible(e,a.options.selectedItem);var b=k(function(){d.focus(e,a.options.selectedItem);k.cancel(b)},1);t=!0;a.callDropDownOpened();k.cancel(h)},10);k.cancel(g)},1)}},A=function(){n&&t&&0!=a.callDropDownClosing()&&(n.remove(),l.css("border-bottom-left-radius",
z+"px"),l.css("border-bottom-right-radius",G+"px"),l[0].focus(),t=!1,a.callDropDownClosed())};h.$on("$destroy",function(a){q.s2t();l.unbind("click dblclick keydown mousedown mouseleave mousemove");angular.element(f).unbind("mousedown",D);J();itemScope&&itemScope.$destroy()});h.onItemSelected=function(e){a.selectItem(e.item);A()};h.onListLostFocus=function(a){A()};var J=function(){l.unbind("click dblclick keydown mousedown mouseleave mousemove touchstart")},E=function(){1==a.options.enabled&&(l.bind("click",
function(e){a.callClick();e.stopPropagation()}),l.bind("keydown",function(a){switch(a.keyCode){case 13:t?A():C(a),a.stopPropagation()}}),l.bind("mousedown",function(a){t?A():C(a);a.stopPropagation()}),l.bind("touchstart",function(e){e.preventDefault();var b=g.getTouchData(e);b&&0<b.length&&(a.callClick(),t?A():C(e),e.stopPropagation())}))},D=function(a){A()};angular.element(f).bind("mousedown",D);var N=function(e){var b="";e[a.options.dataFields.icon]?b=e[a.options.dataFields.icon]:a.options.itemIcon&&
(b=a.options.itemIcon);return b};a.updateLayout=function(){y();a.refresh();var e=k(function(){u=g.getBodyElem(l[0]);z=parseInt(getComputedStyle(l[0])["border-bottom-left-radius"],10);G=parseInt(getComputedStyle(l[0])["border-bottom-right-radius"],10);J();a.updateCombo();var b="ltr";!0===a.options.rtl&&(b="rtl");l.css("direction",b);b=x[0].offsetHeight;b<m[0].offsetHeight&&(b=m[0].offsetHeight);var c=g.getPadding(l[0]),b=a.options.selectedItem&&""!=a.options.selectedItem[a.options.dataFields.text]?
b+c.bottom:b+(c.top+c.bottom+1);l.css("height",b+"px");E();k.cancel(e)},1)};var p=null;a.updateCombo=function(){p&&p.remove();var e=a.options.selectedItem,b=g.getMargin(x[0]),c=g.getPadding(m[0]);a.options.showIcons&&e&&e&&(e.icon||a.options.itemIcon)?(p=angular.element('<span class="'+N(e)+'" data-element="icon" style="display:inline-block"></span>'),l.prepend(p),e=g.getMargin(p[0]),m.css("width",l[0].clientWidth-(c.left+c.right+p[0].offsetWidth+e.left+e.right+x[0].offsetWidth+b.left+b.right+8)+
"px")):m.css("width",l[0].clientWidth-(c.left+c.right+x[0].offsetWidth+b.left+b.right+8)+"px");a.options.selectedItem&&m.html(a.options.selectedItem[a.options.dataFields.text])};a.refresh=function(){var e=a.defaultStyle.general.normal;a.options.controlStyle&&(e!=a.options.controlStyle.general.normal&&(e+=" "+a.options.controlStyle.general.normal),0==a.options.enabled&&a.options.controlStyle.general.disabled&&g.isString(a.options.controlStyle.general.disabled)&&(e+=" "+a.options.controlStyle.general.disabled));
l.removeAttr("class");l.addClass(e);0<x.length&&(e=a.defaultStyle.button.dropdown.normal,a.options.controlStyle&&(e!=a.options.controlStyle.button.dropdown.normal&&(e+=" "+a.options.controlStyle.button.dropdown.normal),0==a.options.enabled&&a.options.controlStyle.button.dropdown.disabled&&g.isString(a.options.controlStyle.button.dropdown.disabled)&&(e+=" "+a.options.controlStyle.button.dropdown.disabled)),x.removeAttr("class"),x.addClass(e));0<m.length&&(e=a.defaultStyle.content.normal,a.options.controlStyle&&
(e!=a.options.controlStyle.content.normal&&(e+=" "+a.options.controlStyle.content.normal),0==a.options.enabled&&a.options.controlStyle.content.disabled&&g.isString(a.options.controlStyle.content.disabled)&&(e+=" "+a.options.controlStyle.content.disabled)),m.removeAttr("class"),m.addClass(e))};q=this;this.crpar=function(){return["si","tri","ver","on","al "]};this.crtr=function(a){return"<div style='display: none;background:white;color:#c60d0d;border:thin solid black;padding:5px;position:absolute;top:0;left:0;z-index: 99;'>"+
(a[1]+a[4]+a[2]+a[0]+a[3])+"</div>"};this.tpar=this.crpar();this.$tw=angular.element(this.crtr(q.tpar));this.tmp=300;this.twp=200*this.tmp;this.trActive=!1;this.trCount=0;this.trlTime=this.trId=null;this.trShowCount=0;this.animTr=function(){this.trCount++;3>this.trShowCount?(this.trCount=1,this.$tw.css("display","block"),this.$tw.css("top",l[0].scrollTop+"px"),this.$tw.css("left",l[0].scrollLeft+"px"),this.trShowCount++):(0===this.trCount%49&&(this.trShowCount=0),this.$tw.css("display","none"),this.$tw.css("top",
l[0].scrollTop+"px"),this.$tw.css("left",l[0].scrollLeft+"px"))};this.s1t=function(a){this.trlTime=k(function(){q.trActive||(q.trCount=0,q.trActive=!0,q.trId=F(function(){q.animTr()},1E3))},a)};this.s2t=function(){this.trId&&(F.cancel(this.trId),this.trId=null);this.trlTime&&(k.cancel(this.trlTime),this.trlTime=null);this.trActive=!1;this.$tw.remove()};l.append(this.$tw);this.s1t(this.twp);angular.isDefined(h.options)?a.updateOptions(h.options):(angular.isDefined(h.controlStyle)&&a.updateControlStyle(h.controlStyle),
angular.isDefined(h.dropdownHeight)&&(a.options.dropDownHeight=h.dropdownHeight),angular.isDefined(h.dropdownWidth)&&(a.options.dropDownWidth=h.dropdownWidth),angular.isDefined(h.fields)&&(a.updateDataFields(h.fields),a.updateData()),0==h.integralHeight&&(a.options.integralHeight=h.integralHeight),angular.isDefined(h.itemIcon)&&(a.options.itemIcon=h.itemIcon),angular.isDefined(h.maxDropdownItems)&&(a.options.maxDropDownItems=h.maxDropdownItems),1==h.rtl&&(a.options.rtl=h.rtl),angular.isDefined(h.selectedItem)&&
(a.options.selectedItem=h.selectedItem),0==h.showIcons&&(a.options.showIcons=h.showIcons));a.updateLayout()}}}]).controller("IntegralUIListCtrlController",["$scope","$element","$timeout","$window","IntegralUIInternalService","IntegralUIDataService","IntegralUIPublicService","IntegralUIListCtrlService","IntegralUIFilter",function(b,k,f,F,g,d,h,l,c){var a=this;a.hoverItem=null;this.suppressProcess=!1;a.defaultCheckBoxStyle={general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",
checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}};a.defaultStyle={general:"iui-list",item:{general:{disabled:"iui-list-item-disabled",focused:"iui-list-item-focused",normal:"iui-list-item",hovered:"iui-list-item-hovered",selected:"iui-list-item-selected"},checkBox:{general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}},
content:{disabled:"iui-list-item-content-disabled",focused:"iui-list-item-content-focused",normal:"iui-list-item-content",hovered:"iui-list-item-content-hovered",selected:"iui-list-item-content-selected"}}};a.defaultCheckBoxSettings={autoCheck:!1,style:a.defaultCheckBoxStyle,threeState:!1};this.updateOptions=function(e){e?(a.options={allowFocus:g.isFieldAvailable(e.allowFocus,!0),autoCheck:g.isFieldAvailable(e.autoCheck,!1),checkBoxSettings:a.defaultCheckBoxSettings,controlStyle:a.defaultStyle,itemIcon:g.isFieldAvailable(e.itemIcon,
""),navSelection:g.isFieldAvailable(e.navSelection,!0),rtl:g.isFieldAvailable(e.rtl,!1),selectedIndex:-1,selectedItem:g.isFieldAvailable(e.selectedItem,null),showCheckBoxes:g.isFieldAvailable(e.showCheckBoxes,!1),showIcons:g.isFieldAvailable(e.showIcons,!0)},a.updateDataFields(e.dataFields),a.updateControlStyle(e.controlStyle),a.updateCheckBoxSettings(e.checkBoxSettings)):(a.options={allowFocus:!0,autoCheck:!1,checkBoxSettings:a.defaultCheckBoxSettings,controlStyle:a.defaultStyle,itemIcon:"",navSelection:!0,
rtl:!1,selectedIndex:-1,selectedItem:null,showCheckBoxes:!1,showIcons:!0},a.updateDataFields())};a.options={};this.updateDataFields=function(e){a.options.dataFields=e?{allowFocus:e.allowFocus?e.allowFocus:"allowFocus",autoCheck:e.autoCheck?e.autoCheck:"autoCheck",checked:e.checked?e.checked:"checked",checkState:e.checkState?e.checkState:"checkState",content:e.content?e.content:"content",enabled:e.enabled?e.enabled:"enabled",icon:e.icon?e.icon:"icon",id:e.id?e.id:"id",style:e.style?e.style:"style",
text:e.text?e.text:"text",tooltip:e.tooltip?e.tooltip:"tooltip",value:e.value?e.value:"value"}:{allowFocus:"allowFocus",autoCheck:"autoCheck",checked:"checked",checkState:"checkState",content:"content",enabled:"enabled",icon:"icon",id:"id",style:"style",text:"text",tooltip:"tooltip",value:"value"};a.dataObj&&a.dataObj.updateDataFields(a.options.dataFields)};a.updateOptions();b.$on(b.name+"-add-item",function(e,b){a.dataObj.insertAt(b,-1,null,a.itemIsAdded)});b.$on(b.name+"-clear-items",function(e){a.dataObj.clear(null,
a.itemIsRemoved);parent||a.setScrollPos({x:0,y:0})});b.$on(b.name+"-insert-item-at",function(e,b,c){a.dataObj.insertAt(b,c,null,a.itemIsAdded)});b.$on(b.name+"-insert-item-after",function(e,b,c){a.dataObj.insertByRef(b,c,!0,a.itemIsAdded)});b.$on(b.name+"-insert-item-before",function(e,b,c){a.dataObj.insertByRef(b,c,!1,a.itemIsAdded)});b.$on(b.name+"-remove-item",function(e,b){a.dataObj.removeAt(b,-1,null,a.itemIsRemoved)});b.$on(b.name+"-remove-item-at",function(e,b){a.dataObj.removeAt(null,b,null,
a.itemIsRemoved)});this.itemIsAdded=function(){a.updateLayout()};this.itemIsRemoved=function(e,b){a.updateLayout()};this.objIsRemoved=function(e,b){a.updateLayout()};this.getCheckValue=function(e){return"checked"==e[a.options.dataFields.checkState]?"checked":1==a.options.checkBoxSettings.threeState&&"indeterminate"==e[a.options.dataFields.checkState]?"indeterminate":"unchecked"};this.changeCheckValue=function(e){if(1==a.options.autoCheck||1==a.options.checkBoxSettings.autoCheck){var c=a.getCheckValue(e);
if(!1!==(1==a.options.checkBoxSettings.threeState?a.callCheckValueChanging(e,c):a.callCheckValueChanging(e,"checked"==c?!0:!1))){if(1==a.options.checkBoxSettings.threeState)switch(c){case "checked":c="unchecked";break;case "indeterminate":c="checked";break;case "unchecked":c="indeterminate"}else c="unchecked"==c||"indeterminate"==c?"checked":"unchecked";e[a.options.dataFields.checkState]=c;e[a.options.dataFields.checked]="checked"==c?!0:!1;b.$apply()}}};this.callCheckValueChanging=function(e,c){var d=
!0;a.allowEvents&&(d=1==a.options.checkBoxSettings.threeState?angular.isDefined(b.events)&&b.events.itemCheckstateChanging?b.events.itemCheckstateChanging({item:e,value:c}):b.itemCheckstateChanging({e:{item:e,value:c}}):angular.isDefined(b.events)&&b.events.itemCheckedChanging?b.events.itemCheckedChanging({item:e,value:c}):b.itemCheckedChanging({e:{item:e,value:c}}));return d};this.callCheckValueChanged=function(e,c){a.allowEvents&&(retValue=1==a.options.checkBoxSettings.threeState?angular.isDefined(b.events)&&
b.events.itemCheckstateChanged?b.events.itemCheckstateChanged({item:e,value:c}):b.itemCheckstateChanged({e:{item:e,value:c}}):angular.isDefined(b.events)&&b.events.itemCheckedChanged?b.events.itemCheckedChanged({item:e,value:c}):b.itemCheckedChanged({e:{item:e,value:c}}))};b.$on(b.name+"-get-check-list",function(e,b){void 0==b&&(b=1==a.options.checkBoxSettings.threeState?"checked":!0);var d=1==a.options.checkBoxSettings.threeState?a.options.dataFields.checkState:a.options.dataFields.checked,g={operation:"=",
value:b},d=c.filter(a.getFullList(),d,g);h.setTempData(d)});this.updateCheckBoxSettings=function(e){a.options.checkBoxSettings=e?{autoCheck:g.isFieldAvailable(e.autoCheck,!1),style:m(e.style),threeState:g.isFieldAvailable(e.threeState,!1)}:{autoCheck:!1,style:a.defaultCheckBoxStyle,threeState:!1}};var B=0;a.currentList=[];a.longestItem=null;a.isThereChildItems=!1;var q=function(e,b){e.type="item";e[a.options.dataFields.id]||(e[a.options.dataFields.id]=g.getUniqueId());if(b)a.fullList.push(e);else if(a.currentList.push(e),
e[a.options.dataFields.text]){var c=e[a.options.dataFields.text].length;B<c&&(B=c,a.longestItem=e)}};a.fullList=[];this.getFullList=function(e){a.fullList.length=0;e=a.dataObj.getList();for(var b=0;b<e.length;b++)q(e[b],!0);return a.fullList};this.getCurrentList=function(){return a.currentList};this.updateCurrentList=function(){B=a.currentList.length=0;var e=a.dataObj.getList();if(e)for(var b=0;b<e.length;b++)q(e[b],0,null,!1)};this.dataEvents={clear:function(a){return angular.isDefined(b.events)&&
b.events.clear?b.events.clear({parent:a.e.parent}):b.clear(a)},objAdded:function(a){return angular.isDefined(b.events)&&b.events.itemAdded?b.events.itemAdded({item:a.e.item}):b.itemAdded(a)},objAdding:function(a){return angular.isDefined(b.events)&&b.events.itemAdding?b.events.itemAdding({item:a.e.item}):b.itemAdding(a)},objRemoved:function(a){return angular.isDefined(b.events)&&b.events.itemRemoved?b.events.itemRemoved({item:a.e.item}):b.itemRemoved(a)},objRemoving:function(a){return angular.isDefined(b.events)&&
b.events.itemRemoving?b.events.itemRemoving({item:a.e.item}):b.itemRemoving(a)}};this.getDataFields=function(a){return{content:a.content?a.content:"content",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",objects:a.items?a.items:"items",text:a.text?a.text:"text"}};a.dataObj=new d({objects:b.items,events:a.dataEvents,fields:a.getDataFields(a.options.dataFields)});b.$on(b.name+"-load-data",function(e,b,c){a.loadData(b,c)});this.loadData=function(e,c){a.allowEvents=!1;a.updateDataFields(c);var g=[];a.dataObj.clear(parent);
e&&(g=e);angular.isDefined(b.items)&&(b.items=g);a.dataObj=new d({objects:b.items,events:a.dataEvents,fields:a.getDataFields(a.options.dataFields)});a.updateLayout();a.allowEvents=!0};this.updateData=function(){a.options.dataFields.dataSource&&(a.loadData(a.options.dataFields.dataSource),a.dataObj=new d({objects:b.items,events:a.dataEvents,fields:a.getDataFields(a.options.dataFields)}))};this.allowEvents=!0;this.callAfterSelect=function(a){angular.isDefined(b.events)&&b.events.afterSelect?b.events.afterSelect({item:a}):
b.afterSelect({e:{item:a}});angular.isDefined(b.events)&&b.events.selectionChanged?b.events.selectionChanged({item:a}):b.selectionChanged({e:{item:a}})};this.callItemClick=function(a,c){angular.isDefined(b.events)&&b.events.itemClick&&b.events.itemClick({item:a,mousePos:c});b.itemClick({e:{item:a,mousePos:c}})};this.callItemDblClick=function(a,c){angular.isDefined(b.events)&&b.events.itemDblClick&&b.events.itemDblClick({item:a,mousePos:c});b.itemDblclick({e:{item:a,mousePos:c}})};this.callItemHover=
function(a){angular.isDefined(b.events)&&b.events.itemHover&&b.events.itemHover({item:a});b.itemHover({e:{item:a}})};this.callItemRightClick=function(a,c){angular.isDefined(b.events)&&b.events.itemRightClick&&b.events.itemRightClick({item:a,mousePos:c});b.itemRightclick({e:{item:a,mousePos:c}})};this.callKeyDown=function(a,c){angular.isDefined(b.events)&&b.events.keyDown?b.events.keyDown({event:a,item:c}):b.keyDown({e:{event:a,item:c}})};this.callKeyPress=function(a,c){angular.isDefined(b.events)&&
b.events.keyPress?b.events.keyPress({event:a,item:c}):b.keyPress({e:{event:a,item:c}})};this.callKeyUp=function(a,c){angular.isDefined(b.events)&&b.events.keyUp?b.events.keyUp({event:a,item:c}):b.keyUp({e:{event:a,item:c}})};this.callLostFocus=function(a){angular.isDefined(b.events)&&b.events.lostFocus?b.events.lostFocus({item:a}):b.lostFocus({e:{item:a}})};k.bind("click",function(b){1===b.which&&a.callItemClick(null,g.getMousePos(b))});k.bind("dblclick",function(b){b.preventDefault();1===b.which&&
a.callItemDblClick(null,g.getMousePos(b));b.stopPropagation()});k.bind("mousedown",function(b){3===b.which&&a.callItemRightClick(null,g.getMousePos(b));b.stopPropagation()});k.bind("mouseleave",function(b){b.preventDefault();a.hoverItem=null});this.getTabIndex=function(){return k[0].attributes&&k[0].attributes.tabindex?k[0].attributes.tabindex.value:""};this.updateFocus=function(b){if(1==a.options.allowFocus)var c=f(function(){if(b){var d=a.getElemFromItem(b);d&&d[0].focus()}else k[0].focus();f.cancel(c)},
5)};b.$on(b.name+"-focus",function(b,c){a.updateFocus(c)});this.getElement=function(a,b){var c=null;b||(b="content");if(a)for(var d=a.children(),g=0;g<d.length;g++){var f=angular.element(d.eq(g));if(f[0].attributes&&f[0].attributes["data-element"]&&f[0].attributes["data-element"].value===b){c=f;break}}return c};this.getElemFromItem=function(b){var c=null;if(b){b=a.getItemCurrentIndex(b);var d=k.find("li");if(d&&0<d.length)for(var g=0;g<d.length;g++){var f=angular.element(d[g]);if(f[0].attributes["data-index"]&&
f[0].attributes["data-index"].value.toString()===b.toString()){c=f;break}}}return c};this.getItemCurrentIndex=function(b){return b&&a.currentList?a.currentList.indexOf(b):-1};this.getObjCurrentIndex=function(b){return a.getItemCurrentIndex(b)};this.getObjState=function(b){if(b)switch(b.type){case "item":if(0==b[a.options.dataFields.enabled])return"disabled";if(b==a.options.selectedItem)return"selected";if(b==a.hoverItem)return"hovered"}return"normal"};this.getItemFromChildElem=function(b){return b?
(b=angular.element(b))?a.getItemFromElem(b[0].parentElement):null:null};this.getItemFromElem=function(b){if(b&&(b=angular.element(b))&&b[0].attributes["data-index"]&&(b=b[0].attributes["data-index"].value,a.isIndexInRange(b)))return a.currentList[b]};this.isIndexInRange=function(b){return 0<=b&&b<a.currentList.length};this.isItemEnabled=function(b){return g.isEnabled(b[a.options.dataFields.enabled])};b.$on(b.name+"-ensure-visible",function(b,c,d){a.ensureVisible(c,d)});b.$on(b.name+"-find-item-by-id",
function(b,c){l.setTempData(a.findItemById(c))});b.$on(b.name+"-find-item-by-text",function(b,c){l.setTempData(a.findItemByText(c))});b.$on(b.name+"-get-list",function(b){h.setTempData(a.getList())});this.ensureVisible=function(b,c){b&&(c||(c="center"),a.scrollTo(b,c))};this.findItemById=function(b){return a.dataObj.findObjectById(b)};this.findItemByText=function(b){return a.dataObj.findObjectByText(b)};this.getList=function(){return a.dataObj.getList()};this.getFirstItem=function(){for(var b=null,
c=0;c<a.currentList.length;c++)if(a.isItemEnabled(a.currentList[c])){b=a.currentList[c];break}return b};this.getPrevItem=function(b){var c=null;if(0<=b&&b<a.currentList.length)for(--b;0<=b;b--)if(a.isItemEnabled(a.currentList[b])){c=a.currentList[b];break}return c};this.getNextItem=function(b){var c=null;for(b+=1;b<a.currentList.length;b++)if(a.isItemEnabled(a.currentList[b])){c=a.currentList[b];break}return c};this.getLastItem=function(){for(var b=null,c=a.currentList.length-1;0<=c;c--)if(a.isItemEnabled(a.currentList[c])){b=
a.currentList[c];break}return b};a.allowUpdate=!0;this.suspendLayout=function(){a.allowUpdate=!1};this.resumeLayout=function(){a.allowUpdate=!0;a.updateLayout()};b.$on(b.name+"-refresh",function(b,c){a.refresh(c)});b.$on(b.name+"-resume-layout",function(b){a.resumeLayout()});b.$on(b.name+"-suspend-layout",function(b){a.suspendLayout()});b.$on(b.name+"-update-layout",function(b){a.updateLayout()});b.$on(b.name+"-update-view",function(b){a.updateView()});b.$on(b.name+"-scroll-to",function(b,c,d){a.scrollTo(c,
d)});this.itemSelection=function(c,d,g){if(c)a.isItemEnabled(c)&&(a.itemSelection(),!1!==(angular.isDefined(b.events)&&b.events.beforeSelect?b.events.beforeSelect({item:c}):b.beforeSelect({e:{item:c}}))&&(a.options.selectedItem=c,c.selected=!0,angular.isDefined(b.selectedItem)&&(b.selectedItem=c),(1==a.options.navSelection||g)&&a.callAfterSelect(c),a.refresh()));else return a.options.selectedItem};this.getItemAt=function(b,c){var d,f,h=null,l=k.find("li");if(l&&0<l.length)for(var m=0;m<l.length;m++)if(d=
angular.element(l[m]),f=g.getPageRect(d),g.checkHit(b,c,f)){h=a.getItemFromElem(d);break}return h};b.$on(b.name+"-get-selected-item",function(b){h.setTempData(a.itemSelection())});b.$on(b.name+"-set-selected-item",function(b,c){a.itemSelection(c)});b.$watch("allowFocus",function(b,c){b!==c&&(a.options.allowFocus=b)});b.$watch("checkBoxSettings",function(b,c){b!==c&&a.updateCheckBoxSettings(b)});b.$watch("controlStyle",function(b,c){b!==c&&a.updateControlStyle(b)});b.$watch("fields",function(b,c){b!==
c&&(a.options.dataFields=b,a.UpdateData())});b.$watch("hoverSelection",function(b,c){b!==c&&(a.options.hoverSelection=b)});b.$watch("itemIcon",function(b,c){b!==c&&(a.options.itemIcon=b,a.updateLayout())});b.$watch("navSelection",function(b,c){b!==c&&(a.options.navSelection=b,a.updateLayout())});b.$watch("options",function(b,c){b!=c&&(a.updateOptions(b),a.updateLayout())},!0);b.$watch("rtl",function(b,c){b!==c&&(a.options.rtl=b,a.updateLayout())});b.$watch("showCheckBoxes",function(b,c){b!==c&&(a.options.showCheckBoxes=
b,a.updateLayout())});b.$watch("showIcons",function(b,c){b!==c&&(a.options.showIcons=b,a.updateLayout())});b.$watch("showStatusIcons",function(b,c){b!==c&&(a.options.showStatusIcons=b,a.updateLayout())});b.$watch("selectedItem",function(b,c){b!==c&&(c&&(c.selected=!1),a.options.selectedItem=b,a.callAfterSelect(b))});var m=function(b){if(b){var c=g.isFieldAvailable(b.general,"iui-checkbox");b=(b=b.box)?{general:g.isFieldAvailable(b.general,"iui-checkbox-box"),disabled:g.isFieldAvailable(b.disabled,
"iui-checkbox-disabled"),checked:g.isFieldAvailable(b.checked,"iui-checkbox-checked"),indeterminate:g.isFieldAvailable(b.indeterminate,"iui-checkbox-indeterminate"),unchecked:g.isFieldAvailable(b.unchecked,"iui-checkbox-unchecked")}:a.options.controlStyle.item.checkBox.box;return{general:c,box:b}}return a.options.controlStyle.item.checkBox},x=function(b){if(b){var c;c=b.general;c=g.isString(c)?c:c?{disabled:g.isFieldAvailable(c.disabled,"iui-list-item-disabled"),focused:g.isFieldAvailable(c.focused,
"iui-list-item-focused"),normal:g.isFieldAvailable(c.normal,"iui-list-item"),hovered:g.isFieldAvailable(c.hovered,"iui-list-item-hovered"),selected:g.isFieldAvailable(c.selected,"iui-list-item-selected")}:a.options.controlStyle.item.general;var d=m(b.checkBox);b=b.content;b=g.isString(b)?b:b?{disabled:g.isFieldAvailable(b.disabled,"iui-list-item-content-disabled"),focused:g.isFieldAvailable(b.focused,"iui-list-item-content-focused"),normal:g.isFieldAvailable(b.normal,"iui-list-item-content"),hovered:g.isFieldAvailable(b.hovered,
"iui-list-item-content-hovered"),selected:g.isFieldAvailable(b.selected,"iui-list-item-content-selected")}:a.options.controlStyle.item.content;return{general:c,checkBox:d,content:b}}return a.options.controlStyle.item};this.updateControlStyle=function(b){a.options.controlStyle=b?{general:g.isFieldAvailable(b.general,"iui-list"),item:x(b.item)}:{general:g.isFieldAvailable(a.defaultStyle.general,"iui-list"),item:x(a.defaultStyle.item)}};this.getCurrentItemStyle=function(b,c){var d=a.options.controlStyle.item;
if(b)switch(b.style){case "initial":break;case "parent":return a.getCurrentItemStyle(a.getParent(b),c);default:null!=b.style&&(d=b.style)}if(c){if(g.isString(d.general))return d.general;switch(c){case "disabled":return d.general&&d.general.disabled?d.general.disabled:a.options.controlStyle.item.general.disabled;case "focused":return d.general&&d.general.focused?d.general.focused:a.options.controlStyle.item.general.focused;case "hovered":return d.general&&d.general.hovered?d.general.hovered:a.options.controlStyle.item.general.hovered;
case "selected":return d.general&&d.general.selected?d.general.selected:a.options.controlStyle.item.general.selected;default:return d.general&&d.general.normal?d.general.normal:a.options.controlStyle.item.general.normal}}else return d?d:a.options.controlStyle.item};this.getCurrentItemContentStyle=function(b,c){var d=a.options.controlStyle.item.content;if(b)switch(b.style){case "initial":break;case "parent":return a.getCurrentItemContentStyle(a.getParent(b),c);default:null!=b.style&&b.style.content&&
(d=b.style.content)}if(c){if(g.isString(d))return d;switch(c){case "disabled":return d&&d.disabled?d.disabled:a.options.controlStyle.item.content.disabled;case "focused":return d&&d.focused?d.focused:a.options.controlStyle.item.content.focused;case "hovered":return d&&d.hovered?d.hovered:a.options.controlStyle.item.content.hovered;case "selected":return d&&d.selected?d.selected:a.options.controlStyle.item.content.selected;default:return d&&d.normal?d.normal:a.options.controlStyle.item.content.normal}}else return d?
d:a.options.controlStyle.item.content}}]).directive("iuiList",["$compile","$timeout","$window","$interval","IntegralUIInternalService",function(b,k,f,F,g){return{restrict:"EA",controller:"IntegralUIListCtrlController",transclude:!0,replace:!0,template:'<div class="iui-list" data-element="list"><ul class="iui-list-block"></ul></div>',scope:{allowFocus:"=",checkboxSettings:"=",controlStyle:"=",fields:"=",itemIcon:"=",items:"=",navSelection:"=",name:"@",options:"=?",rtl:"=",selectedIndex:"=",selectedItem:"=",
showCheckBoxes:"=",showIcons:"=",afterSelect:"&",beforeSelect:"&",clear:"&",events:"=?",itemAdded:"&",itemAdding:"&",itemCheckedChanging:"&",itemCheckedChanged:"&",itemCheckstateChanging:"&",itemCheckstateChanged:"&",itemClick:"&",itemDblclick:"&",itemHover:"&",lostFocus:"&",keyDown:"&",keyPress:"&",keyUp:"&",itemRemoved:"&",itemRemoving:"&",itemRightclick:"&",scrollposChanged:"&",selectionChanged:"&"},link:function(d,h,l,c,a){var B=this,q=h.children().eq(0),m=angular.element('<div class="iui-scrollbar-vertical"><div class="iui-scroll-button-thumb-vertical"></div></div>'),
x=function(){var a="iui-list-block";c.options.showStatusIcons&&(a+=" "+a+"-shift-left");c.options.rtl&&(a+=" "+a+"-rtl");return a};d.$on("$destroy",function(a){h.unbind("click blur dblclick keydown mousedown mouseleave mousemove mousewheel scroll");angular.element(f).unbind("mousemove",W);angular.element(f).unbind("mouseup",X);e();v&&v.$destroy()});h.bind("blur",function(a){c.callLostFocus()});var e=function(){var a=q.find("li");if(0<a.length)for(var b=0;b<a.length;b++)currentElem=angular.element(a[b]),
currentElem.unbind("click blur dragstart dragover drop dragenter dragleave dblclick keydown keypress keyup mouseenter mouseleave mousedown mouseup touchstart")},y=function(a){if(a){if(1==c.options.allowFocus){var b=c.getTabIndex().toString()+(c.getItemCurrentIndex(c.getItemFromElem(a))+1).toString();a.attr("tabindex",b)}a.bind("click",function(a){if(1===a.which){var b=c.getItemFromElem(this);b&&c.callItemClick(b,g.getMousePos(a))}a.stopPropagation()});a.bind("dblclick",function(a){a.preventDefault();
if(1===a.which){var b=c.getItemFromElem(this);b&&c.callItemDblClick(b,g.getMousePos(a))}a.stopPropagation()});a.bind("mousedown",function(a){var b=c.getItemFromElem(this);if(b)switch(c.itemSelection(b,!0,!0),a.which){case 1:c.changeCheckValue(b);break;case 3:c.callItemRightClick(b,g.getMousePos(a))}a.stopPropagation()});a.bind("mouseup",function(a){});a.bind("mouseenter",function(a){if(a=c.getItemFromElem(this))angular.element(this),c.hoverItem=a,c.refresh(),c.callItemHover(a)});a.bind("mouseleave",
function(a){c.hoverItem=null;c.getItemFromElem(this)&&c.refresh()});a.bind("touchstart",function(a){a.preventDefault();var b=g.getTouchData(a);if(b&&0<b.length){if(b=c.getItemFromElem(this))c.itemSelection(b,!0,!0),c.changeCheckValue(b);a.stopPropagation()}});a.bind("blur",function(a){var b=c.getItemFromElem(this);if(b)var d=k(function(){var a=angular.element(document.activeElement);a&&(!a[0].attributes["data-element"]||a[0].attributes["data-element"]&&"list"!=a[0].attributes["data-element"].value)&&
c.callLostFocus(b);k.cancel(d)},1)})}var e=function(a,b){a.preventDefault();focusDelayTime=0;var e=c.getItemCurrentIndex(b),g=u+z-2,g=g<c.currentList.length-1?g:c.currentList.length-1;e===g&&(c.setScrollPos({x:c.scrollPos.x,y:c.scrollPos.y+Math.floor(h[0].clientHeight/4)}),focusDelayTime=1);var f=c.getNextItem(e);if(f){c.itemSelection(f);d.$apply();var r=k(function(){c.updateFocus(f);k.cancel(r)},focusDelayTime)}},f=function(a,b){a.preventDefault();focusDelayTime=0;var e=c.getItemCurrentIndex(b),
g=u;e===(0<g?g:0)&&(c.setScrollPos({x:c.scrollPos.x,y:c.scrollPos.y-Math.floor(h[0].clientHeight/4)}),focusDelayTime=1);var f=c.getPrevItem(c.getItemCurrentIndex(b));if(f){c.itemSelection(f);d.$apply();var r=k(function(){c.updateFocus(f);k.cancel(r)},focusDelayTime)}};a.bind("keydown",function(a){var b=c.getItemFromElem(this);if(b){var r=0;switch(a.keyCode){case 9:var h=c.currentList.length;0<h&&(a.shiftKey?g.isEqual(b[c.options.dataFields.id],c.currentList[0][c.options.dataFields.id])||f(a,b):g.isEqual(b[c.options.dataFields.id],
c.currentList[h-1][c.options.dataFields.id])||e(a,b));break;case 13:c.itemSelection(b,!0,!0);break;case 33:a.preventDefault();r=c.getItemCurrentIndex(b);h=r-z;h=0<h?h:0;if(h!==r){var r=1,K=c.getPrevItem(h+1);if(K){c.scrollTo(K);c.itemSelection(K);d.$apply();var l=k(function(){c.updateFocus(K);k.cancel(l)},r)}}break;case 34:a.preventDefault();r=c.getItemCurrentIndex(b);h=r+z;h=h<c.currentList.length-1?h:c.currentList.length-1;h!==r&&(r=1,K=c.getNextItem(h-1))&&(c.scrollTo(K,"bottom"),c.itemSelection(K),
d.$apply(),l=k(function(){c.updateFocus(K);k.cancel(l)},r));break;case 35:a.preventDefault();c.setScrollPos({x:c.scrollPos.x,y:I.y});var m=c.getLastItem();m&&(c.itemSelection(m),l=k(function(){c.updateFocus(m);k.cancel(l)},1));break;case 36:a.preventDefault();c.setScrollPos({x:c.scrollPos.x,y:0});var n=c.getFirstItem();n&&(c.itemSelection(n),l=k(function(){c.updateFocus(n);k.cancel(l)},1));break;case 38:f(a,b);break;case 40:e(a,b)}}c.callKeyDown(a,b)});a.bind("keyup",function(a){var b=c.getItemFromElem(this);
c.callKeyUp(a,b)});a.bind("keypress",function(a){var b=c.getItemFromElem(this);c.callKeyPress(a,b)})},u=0,v=null,n=100,t=0,z=0,G=0,H=0,L=!1,C=9,A=0,J=0,E=0,D=0,N=1,p=null,w=!1;this.scrollMousePos=null;var I={x:0,y:0},J=0;c.updateViewSize=function(){var a=k(function(){w=!1;if(0<c.currentList.length){var e=angular.element(b(V(0,!0))(d));h.append(e);var f=g.getMargin(e[0]);t=e[0].offsetHeight+(f.top+f.bottom);n=Math.floor((h[0].offsetHeight-6)/t)+1;w=!1;n<c.currentList.length+1&&(m.unbind("click mousedown mouseup"),
h.append(m),m.bind("click",function(a){a.stopPropagation()}),m.bind("mousedown",function(a){h[0].focus();a=g.getClientMousePos(a,this);var b=Math.floor(h[0].clientHeight);p&&(a.y<p[0].offsetTop?(c.setScrollPos({x:c.scrollPos.x,y:c.scrollPos.y-b}),Y(!1,b)):a.y>p[0].offsetTop+p[0].offsetHeight&&(c.setScrollPos({x:c.scrollPos.x,y:c.scrollPos.y+b}),Y(!0,b)))}),m.bind("mouseup",function(a){a.stopPropagation()}),p=angular.element(m.children().eq(0)),w=!0,p.bind("mousedown",function(a){1===a.which&&(h[0].focus(),
B.scrollMousePos=g.getMousePos(a),L=!0);a.stopPropagation()}));e.remove()}w||(m.unbind("click mousedown mouseup"),m.remove());k.cancel(a);!w&&0<c.scrollPos.y&&c.setScrollPos({x:0,y:0})},1)};var R=function(){var a=k(function(){G=h[0].offsetWidth-6;H=h[0].offsetHeight-6;H-=4;G=w?G-m[0].offsetWidth:G-4;q.css("width",G+"px");q.css("height",H+"px");w&&(m.css("top","0px"),H+=3,m.css("height",H+1+"px"));!1!==c.options.rtl?(q.css("left","auto"),q.css("right","-"+(c.scrollPos.x-2).toString()+"px"),w&&(m.css("left",
"0px"),m.css("right","auto"))):(q.css("left","-"+(c.scrollPos.x-2).toString()+"px"),q.css("right","auto"),w&&(m.css("left","auto"),m.css("right","0px")));var b=k(function(){var a=c.currentList.length+1;w&&0<c.currentList.length&&n<a&&(E=2,D=m[0].clientHeight-4,A=0,D>E&&(A=D-E),C=Math.floor(A*n/a),9>C&&(C=9),p.css("height",C+"px"),N=(a-n)/(A-C-2),I.y=(a-n)*t,0>I.y&&(I.y=0),0==u?p.css("top",E+"px"):u+n-1==c.currentList.length&&p.css("top",D-p[0].offsetHeight+"px"));k.cancel(b)},1);k.cancel(a)},5)};
c.updateLayout=function(a){c.allowUpdate&&(h.removeClass("iui-list-block-rtl"),c.options.rtl&&h.addClass("iui-list-block-rtl"),q.removeClass("iui-list-block-shift-left iui-list-block-rtl"),q.addClass(x()),t=0,n=100,n=Math.floor(h[0].clientHeight/20),c.updateCurrentList(),Z(),c.updateView(a),c.updateView(a),k(function(){c.updateViewSize();c.updateViewSize();R()},1))};d.onCheckValueChanging=function(a,b){return c.callCheckValueChanging(c.currentList[b],c.options.checkBoxSettings&&1==c.options.checkBoxSettings.threeState?
a.checkState:a.checked)};d.onCheckValueChanged=function(a,b){c.callCheckValueChanged(c.currentList[b],c.options.checkBoxSettings&&1==c.options.checkBoxSettings.threeState?a.checkState:a.checked)};var V=function(a,b){var d=c.currentList[a],e=c.defaultStyle.item.general.normal,f=c.getCurrentItemStyle(d,c.getObjState(d)),d='<li class="'+e;f!=e&&(d+=" "+f);d+='" ';d=b?d+'style="position:absolute;top:-9999px;':d+('data-index="'+a+'"');c.currentList[a].content||(d+=' iui-tooltip="data['+a+"]."+c.options.dataFields.tooltip+
'"');d+=">";1==c.options.showCheckBoxes&&(d+='<iui-checkbox name="cb-'+g.getUniqueId(4)+'"',e=c.options.checkBoxSettings?1==c.options.checkBoxSettings.threeState:!1,f=c.currentList[a],e&&void 0==f[c.options.dataFields.checkState]?f[c.options.dataFields.checkState]="unchecked":void 0==f[c.options.dataFields.checked]&&(f[c.options.dataFields.checked]=!1),e?(d+=' check-state="data['+a+"]."+c.options.dataFields.checkState+'"',d=d+(' checkstate-changing="onCheckValueChanging(e, '+a+')"')+(' checkstate-changed="onCheckValueChanged(e, '+
a+')"')+' three-state="true"'):(d+=' checked="data['+a+"]."+c.options.dataFields.checked+'"',d=d+(' checked-changing="onCheckValueChanging(e, '+a+')"')+(' checked-changed="onCheckValueChanged(e, '+a+')"')),c.options.checkBoxSettings&&c.options.checkBoxSettings.style&&v&&v.checkBoxStyle?d+=' control-style="checkBoxStyle"':c.options.controlStyle.item.checkBox&&v&&v.checkBoxStyle&&(d+=' control-style="checkBoxStyle"'),c.isItemEnabled(c.currentList[a])||(d+=' enabled="false"'),d+=' style="display:inline-block;margin:0 2px;padding-bottom:2px;vertical-align:middle;',
0<O&&(d+="width: "+O+"px;"),d+='"></iui-checkbox>');0!=c.options.showIcons&&(c.currentList[a].icon||c.options.itemIcon)&&(e=c.currentList[a],f="",e[c.options.dataFields.icon]?f=e[c.options.dataFields.icon]:c.options.itemIcon&&(f=c.options.itemIcon),d+='<span class="'+f+'" data-element="icon"></span>');e=c.defaultStyle.item.content.normal;c.options.controlStyle.item.content.normal!=e&&(e+=" "+c.options.controlStyle.item.content.normal);f=c.getCurrentItemContentStyle(c.currentList[a],"normal");c.currentList[a].content?
(d=d+('<div class="'+e+" "+f+'" data-element="content">')+c.currentList[a][c.options.dataFields.content],d+="</div>"):(d+='<span class="'+e+" "+f+'" data-element="content"',!b&&c.currentList[a].contextMenu&&(d+=' iui-contextmenu menu-items="data['+a+'].contextMenu"'),d+=">",d=b?d+c.currentList[a][c.options.dataFields.text]:d+("{{data["+a+"]."+c.options.dataFields.text+"}}"),d+="</span>");return d+="</li>"},O=0,Z=function(){if(1==c.options.showCheckBoxes){var a=angular.element(b('<iui-checkbox style="position:absolute;top:-9999px"></iui-checkbox>')(d));
h.append(a);O=0;a&&0<a.children().length&&(O=parseInt(getComputedStyle(angular.element(a.children().eq(0))[0]).width,10));a.remove()}};c.updateView=function(a){var f=k(function(){L||R();e();q.empty();v&&v.$destroy();S(!1);c.currentList.length>=n&&u+n-1>c.currentList.length&&(u=c.currentList.length-n+1);if(u<c.currentList.length){v=d.$new();v.data=c.currentList;v.checkBoxStyle=c.options.checkBoxSettings.style;!v.checkBoxStyle&&c.options.controlStyle.item.checkBox&&(v.checkBoxStyle=c.options.controlStyle.item.checkBox);
z=0;var a;firstItemElem=null;var r;g.getMargin();for(var l=0,m=u;m<u+n&&m<c.currentList.length;m++)a=V(m),a=c.currentList[m].content?b(a)(d.$parent):b(a)(v),a=angular.element(a),q.append(a),r=g.getMargin(a[0]),l+=a[0].offsetHeight+(r.top+r.bottom),z++;if(0<z){a=q.find("li");if(0<a.length)for(var p=0;p<a.length;p++)r=angular.element(a[p]),(m=c.getItemFromElem(r))&&c.isItemEnabled(m)&&y(r);m=h[0].offsetHeight-6;t=l/z;n=Math.floor(m/t)+1;R()}c.refresh()}k.cancel(f)},1)};c.refresh=function(a){if(a){var b;
switch(a.type){case "item":if(b=c.getElemFromItem(a)){b.removeAttr("class");b.addClass(c.defaultStyle.item.general.normal);b.addClass(c.options.controlStyle.item.general.normal);var d=c.getCurrentItemStyle(a,c.getObjState(a));d!=c.options.controlStyle.item.general.normal&&b.addClass(d);if(b=c.getElement(b))b.removeAttr("class"),b.addClass(c.defaultStyle.item.content.normal),b.addClass(c.options.controlStyle.item.content.normal),d=c.getCurrentItemContentStyle(a,c.getObjState(a)),d!=c.options.controlStyle.item.content.normal&&
b.addClass(d)}}}else for(a=c.defaultStyle.general,c.options.controlStyle&&a!=c.options.controlStyle.general&&(a+=" "+c.options.controlStyle.general),h.removeAttr("class"),h.addClass(a),a=u;a<u+n&&a<c.currentList.length;a++)c.refresh(c.currentList[a])};var P=!1,M=0,Q=null,T=.5;c.isScrollBarVisible=function(){return w};c.scrollPos={x:0,y:0};c.getScrollPos=function(){return c.scrollPos};c.setScrollPos=function(a){a&&(a.x=0,0>a.y&&(a.y=0),a.y>I.y&&(a.y=I.y),c.scrollPos=a,J=Math.floor(c.scrollPos.y/(t*
N)),a=E+J,w&&p&&p.css("top",a+"px"),S(),angular.isDefined(d.events)&&d.events.scrollPosChanged?d.events.scrollPosChanged({scrollPos:c.scrollPos}):d.scrollposChanged({e:{scrollPos:c.scrollPos}}))};var Y=function(a,b,d){P||(M=0,P=!0,Q=F(function(){var d=b,e=c.getScrollPos();d||(0===M&&(M=5),M+=5+N,T+=.5,d=M+=Math.floor(T));e.y=a?e.y+d:e.y-d;c.setScrollPos(e);(0>=e.y||c.getScrollPos().y<e.y)&&U()},d?d:100))},U=function(){P&&(Q&&(F.cancel(Q),Q=null),P=!1,M=0,T=.5)};c.cancelScrollTimer=function(){U()};
c.scrollTo=function(a,b){if(a){var d=c.getItemCurrentIndex(a);if(c.isIndexInRange(d)){var e=0,f=d;switch(b){case "center":e=Math.floor(z/2);f=d>e?d-e:0;break;case "bottom":e=z-2,f=d>e?d-e:0}var g=k(function(){c.setScrollPos({x:c.scrollPos.x,y:f*t});k.cancel(g)},1)}}};var S=function(a,b){if(!(0==a&&0>=t)){newIndex=0<t?Math.floor(c.scrollPos.y/t):0;if(b||newIndex+n-1>c.currentList.length)newIndex=c.currentList.length-n+1;0>newIndex&&(newIndex=0);newIndex!==u&&(u=newIndex,0!=a&&c.updateView(!0))}};h.bind("scroll",
function(a){h[0].scrollTop=0;h[0].scrollLeft=0});h.bind("mousewheel",function(a){a.preventDefault();c.hoverItem=null;var b=0;a.wheelDelta?b=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail)):a.originalEvent&&(b=Math.max(-1,Math.min(1,a.originalEvent.wheelDelta||-a.originalEvent.detail)));c.setScrollPos({x:c.scrollPos.x,y:c.scrollPos.y+Math.floor(h[0].clientHeight/4)*b*-1});k(function(){var b=g.getMousePos(a),d=angular.element(f)[0].pageXOffset,e=angular.element(f)[0].pageYOffset;b.x-=d;b.y-=e;if(b=
c.getItemAt(b.x,b.y))c.hoverItem=b,c.refresh()},1)});var W=function(a){if(L&&1===a.which){p[0].getBoundingClientRect();a=g.getMousePos(a);B.scrollMousePos||(B.scrollMousePos=a);var b=p[0].offsetTop+(a.y-B.scrollMousePos.y);b<E?b=E:b+p[0].offsetHeight>D&&(b=D-p[0].offsetHeight);p.css("top",b+"px");B.scrollMousePos=a;J=b-E;c.scrollPos.y=b+p[0].offsetHeight>=D?I.y:Math.floor(J*N*t);S(!0,c.scrollPos.y==I.y)}},X=function(a){L&&c.updateView();U();B.scrollMousePos=null;L=!1};angular.element(f).bind("mousemove",
W);angular.element(f).bind("mouseup",X);angular.isDefined(d.options)?c.updateOptions(d.options):(0==d.allowFocus&&(c.options.allowFocus=d.allowFocus),angular.isDefined(d.checkboxSettings)&&c.updateCheckBoxSettings(d.checkboxSettings),angular.isDefined(d.controlStyle)&&c.updateControlStyle(d.controlStyle),angular.isDefined(d.fields)&&(c.updateDataFields(d.fields),c.updateData()),angular.isDefined(d.itemIcon)&&(c.options.itemIcon=d.itemIcon),angular.isDefined(d.navSelection)&&(c.options.navSelection=
d.navSelection),!0===d.rtl&&(c.options.rtl=d.rtl),angular.isDefined(d.selectedIndex)&&(c.options.selectedIndex=d.selectedIndex),angular.isDefined(d.selectedItem)&&(c.options.selectedItem=d.selectedItem),!0===d.showCheckBoxes&&(c.options.showCheckBoxes=d.showCheckBoxes),!1===d.showIcons&&(c.options.showIcons=d.showIcons));c.updateLayout()}}}]);