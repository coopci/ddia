/*
  filename: angular.integralui.treeview.min.js
  version : 3.0.008
  Copyright © 2014-2016 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Studio for Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/studio/license-agreement.aspx.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
angular.module("integralui").factory("IntegralUITreeViewService",["$rootScope",function(c){var k=null;return{addItem:function(f,h,e){c.$broadcast(f+"-add-item",h,e)},clearItems:function(f,h){c.$broadcast(f+"-clear-items",h)},insertItemAt:function(f,h,e,k){c.$broadcast(f+"-insert-item-at",h,e,k)},insertItemBefore:function(f,h,e){c.$broadcast(f+"-insert-item-before",h,e)},insertItemAfter:function(f,h,e){c.$broadcast(f+"-insert-item-after",h,e)},removeItem:function(f,h){c.$broadcast(f+"-remove-item",
h)},removeItemAt:function(f,h,e){c.$broadcast(f+"-remove-item-at",h,e)},exportToJSON:function(f,h,e,k){c.$broadcast(f+"-export-json",h,e,k);f=this.getTempData();this.clearTempData();return f?f:""},loadData:function(f,h,e,k,g){c.$broadcast(f+"-load-data",h,e,k,g)},openEditor:function(f,h){c.$broadcast(f+"-open-editor",h)},closeEditor:function(f,h){c.$broadcast(f+"-close-editor",h)},collapse:function(f,h){c.$broadcast(f+"-collapse",h)},expand:function(f,h){c.$broadcast(f+"-expand",h)},toggle:function(f,
h){c.$broadcast(f+"-toggle",h)},findItemById:function(f,h){c.$broadcast(f+"-find-item-by-id",h);var e=this.getTempData();this.clearTempData();return e?e:null},findItemByText:function(f,h){c.$broadcast(f+"-find-item-by-text",h);var e=this.getTempData();this.clearTempData();return e?e:null},getItemParent:function(f,h){c.$broadcast(f+"-get-item-parent",h);var e=this.getTempData();this.clearTempData();return e?e:null},getItemAt:function(f,h){c.$broadcast(f+"-get-item-at",h);var e=this.getTempData();this.clearTempData();
return e?e:null},filter:function(f,h){c.$broadcast(f+"-filter",h)},focus:function(f,h){c.$broadcast(f+"-focus",h)},clearTempData:function(){k=null},ensureVisible:function(f,h,e){c.$broadcast(f+"-ensure-visible",h,e)},getCheckList:function(f,h){c.$broadcast(f+"-get-check-list",h);var e=this.getTempData();this.clearTempData();return e?e:[]},getItemLevel:function(f,h){c.$broadcast(f+"-get-item-level",h);var e=this.getTempData();this.clearTempData();return e?e:0},getFlatList:function(f,h){c.$broadcast(f+
"-get-flat-list",h);var e=this.getTempData();this.clearTempData();return e?e:[]},getFullPath:function(f,h){c.$broadcast(f+"-get-full-path",h);var e=this.getTempData();this.clearTempData();return e?e:""},getList:function(f,h,e){c.$broadcast(f+"-get-list",h,e);f=this.getTempData();this.clearTempData();return f?f:[]},getTempData:function(){return k},setTempData:function(c){k=c},beginLoad:function(f,h,e){c.$broadcast(f+"-begin-load",h,e)},endLoad:function(f,h){c.$broadcast(f+"-end-load",h)},moveItem:function(f,
h,e,k,g){c.$broadcast(f+"-move-item",h,e,k,g)},clearSelection:function(f){c.$broadcast(f+"-clear-selection")},selectedItem:function(f,h){if(h)c.$broadcast(f+"-set-selected-item",h);else{c.$broadcast(f+"-get-selected-item");var e=this.getTempData();this.clearTempData();return e?e:null}},selectedItems:function(f,h){if(h)c.$broadcast(f+"-set-selected-items",h);else{c.$broadcast(f+"-get-selected-items");var e=this.getTempData();this.clearTempData();return e?e:null}},getScrollPos:function(f){c.$broadcast(f+
"-get-scroll-pos");f=this.getTempData();this.clearTempData();return f?f:{x:0,y:0}},setScrollPos:function(f,h){c.$broadcast(f+"-set-scroll-pos",h)},scrollTo:function(f,h,e){c.$broadcast(f+"-scroll-to",h,e)},sort:function(f,h,e){c.$broadcast(f+"-sort",h,e)},updateCheckValues:function(f,h){c.$broadcast(f+"-update-check",h)},refresh:function(f,h,e){c.$broadcast(f+"-refresh",h,e)},resumeLayout:function(f){c.$broadcast(f+"-resume-layout")},suspendLayout:function(f){c.$broadcast(f+"-suspend-layout")},updateLayout:function(f){c.$broadcast(f+
"-update-layout")},updateView:function(f){c.$broadcast(f+"-update-view")}}}]).controller("IntegralUITreeViewController",["$scope","$element","$timeout","$window","IntegralUIInternalService","IntegralUIDataService","IntegralUITreeViewService","IntegralUIDragDrop","IntegralUIFilter",function(c,k,f,h,e,J,g,l,Ma){var a=this;a.hoverItem=null;this.suppressProcess=!1;a.defaultCheckBoxStyle={general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",
indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}};a.defaultStyle={general:"iui-treeview",item:{general:{disabled:"iui-treeview-item-disabled",focused:"iui-treeview-item-focused",normal:"iui-treeview-item",hovered:"iui-treeview-item-hovered",selected:"iui-treeview-item-selected"},checkBox:{general:"iui-checkbox",box:{general:"iui-checkbox-box",disabled:"iui-checkbox-box-disabled",checked:"iui-checkbox-checked",indeterminate:"iui-checkbox-indeterminate",unchecked:"iui-checkbox-unchecked"}},
expandBox:{general:"iui-treeview-expand-box",animated:"iui-treeview-expand-box-load",expanded:"iui-treeview-expand-box-open",collapsed:"iui-treeview-expand-box-close"},content:{disabled:"iui-treeview-item-content-disabled",focused:"iui-treeview-item-content-focused",normal:"iui-treeview-item-content",hovered:"iui-treeview-item-content-hovered",selected:"iui-treeview-item-content-selected"}}};a.defaultCheckBoxSettings={autoCheck:!1,style:a.defaultCheckBoxStyle,threeState:!1};this.updateOptions=function(b){b?
(a.options={allowAnimation:e.isFieldAvailable(b.allowAnimation,!0),allowDrag:e.isFieldAvailable(b.allowDrag,!1),allowDrop:e.isFieldAvailable(b.allowDrop,!0),allowFocus:e.isFieldAvailable(b.allowFocus,!0),animationSpeed:200,autoCheck:e.isFieldAvailable(b.autoCheck,!1),autoExpand:e.isFieldAvailable(b.autoExpand,!0),checkBoxSettings:a.defaultCheckBoxSettings,controlStyle:a.defaultStyle,editorSettings:{activate:"click"},hoverSelection:e.isFieldAvailable(b.hoverSelection,!1),indent:e.isFieldAvailable(b.indent,
15),itemIcon:e.isFieldAvailable(b.itemIcon,""),itemSpacing:e.isFieldAvailable(b.itemSpacing,1),labelEdit:e.isFieldAvailable(b.labelEdit,!1),loadItems:[],pathSeparator:e.isFieldAvailable(b.pathSeparator,"\\"),rtl:e.isFieldAvailable(b.rtl,!1),selectedIndex:-1,selectedItem:e.isFieldAvailable(b.selectedItem,a.options.selectedItem?a.options.selectedItem:null),selectedItems:[],selectionMode:e.isFieldAvailable(b.selectionMode,"one"),showCheckBoxes:e.isFieldAvailable(b.showCheckBoxes,!1),showExpandBoxes:e.isFieldAvailable(b.showExpandBoxes,
!0),showIcons:e.isFieldAvailable(b.showIcons,!0),showStatusIcons:e.isFieldAvailable(b.showStatusIcons,!1),sorting:e.isFieldAvailable(b.sorting,"none")},a.updateDataFields(b.dataFields),a.updateControlStyle(b.controlStyle),a.updateCheckBoxSettings(b.checkBoxSettings),a.updateTemplateSettings(b.templateSettings)):(a.options={allowAnimation:!0,allowDrag:!1,allowDrop:!0,allowFocus:!0,animationSpeed:200,autoCheck:!1,autoExpand:!0,checkBoxSettings:a.defaultCheckBoxSettings,controlStyle:a.defaultStyle,editorSettings:{activate:"click"},
hoverSelection:!1,indent:15,itemIcon:"",itemSpacing:1,labelEdit:!1,loadItems:[],pathSeparator:"\\",rtl:!1,selectedIndex:-1,selectedItem:null,selectedItems:[],selectionMode:"one",showCheckBoxes:!1,showExpandBoxes:!0,showIcons:!0,showStatusIcons:!1,sorting:"none",templateSettings:{url:null}},a.updateDataFields())};a.options={};this.updateDataFields=function(b){a.options.dataFields=b?{allowDrag:b.allowDrag?b.allowDrag:"allowDrag",allowDrop:b.allowDrop?b.allowDrop:"allowDrop",allowEdit:b.allowEdit?b.allowEdit:
"allowEdit",allowFocus:b.allowFocus?b.allowFocus:"allowFocus",autoCheck:b.autoCheck?b.autoCheck:"autoCheck",checkBoxSettings:b.checkBoxSettings?b.checkBoxSettings:"checkBoxSettings",checked:b.checked?b.checked:"checked",checkState:b.checkState?b.checkState:"checkState",content:b.content?b.content:"content",contextMenu:b.contextMenu?b.contextMenu:"contextMenu",enabled:b.enabled?b.enabled:"enabled",expanded:b.expanded?b.expanded:"expanded",hasChildren:b.hasChildren?b.hasChildren:"hasChildren",icon:b.icon?
b.icon:"icon",id:b.id?b.id:"id",items:b.items?b.items:"items",pid:b.pid?b.pid:"pid",statusIcon:b.statusIcon?b.statusIcon:"statusIcon",style:b.style?b.style:"style",templateObj:b.templateObj?b.templateObj:"templateObj",text:b.text?b.text:"text",value:b.value?b.value:"value"}:{allowDrag:"allowDrag",allowDrop:"allowDrop",allowEdit:"allowEdit",allowFocus:"allowFocus",autoCheck:"autoCheck",checkBoxSettings:"checkBoxSettings",checked:"checked",checkState:"checkState",content:"content",contextMenu:"contextMenu",
enabled:"enabled",expanded:"expanded",hasChildren:"hasChildren",icon:"icon",id:"id",items:"items",pid:"pid",statusIcon:"statusIcon",style:"style",templateObj:"templateObj",text:"text",value:"value"};a.dataObj&&a.dataObj.updateDataFields(a.options.dataFields)};this.updateTemplateSettings=function(b){a.options.templateSettings=b?{url:e.isFieldAvailable(b.url,null)}:{url:null}};a.updateOptions();c.$on(c.name+"-add-item",function(b,d,c){a.dataObj.insertAt(d,-1,c,a.itemIsAdded)});c.$on(c.name+"-clear-items",
function(b,d){a.dataObj.clear(d,a.listIsCleared)});c.$on(c.name+"-insert-item-at",function(b,d,c,m){a.dataObj.insertAt(d,c,m,a.itemIsAdded)});c.$on(c.name+"-insert-item-after",function(b,d,c){a.dataObj.insertByRef(d,c,!0,a.itemIsAdded)});c.$on(c.name+"-insert-item-before",function(b,d,c){a.dataObj.insertByRef(d,c,!1,a.itemIsAdded)});c.$on(c.name+"-remove-item",function(b,d){a.dataObj.removeAt(d,-1,null,a.itemIsRemoved)});c.$on(c.name+"-remove-item-at",function(b,d,c){a.dataObj.removeAt(null,d,c,a.itemIsRemoved)});
this.listIsCleared=function(b){b||(a.clearPrevSelection(),a.options.selectedItem=null,a.setScrollPos({x:0,y:0}));a.updateCurrentLayout()};this.itemIsAdded=function(){a.updateCurrentLayout()};this.itemIsRemoved=function(b,d,c,m){b&&(b.selected=!1,b==a.options.selectedItem&&(a.options.selectedItem=null));a.updateCurrentLayout()};this.objIsRemoved=function(b,d,c){a.updateCurrentLayout()};this.getCheckValue=function(b){return"checked"==b[a.options.dataFields.checkState]?"checked":1==a.options.checkBoxSettings.threeState&&
"indeterminate"==b[a.options.dataFields.checkState]?"indeterminate":"unchecked"};this.changeCheckValue=function(b){if(1==a.options.autoCheck||1==a.options.checkBoxSettings.autoCheck){var d=a.getCheckValue(b),r=!1,r=1==a.options.checkBoxSettings.threeState?a.callCheckValueChanging(b,d):a.callCheckValueChanging(b,"checked"==d?!0:!1);if(!1!==r){if(1==a.options.checkBoxSettings.threeState)switch(d){case "checked":d="unchecked";break;case "indeterminate":d="checked";break;case "unchecked":d="indeterminate"}else d=
"unchecked"==d||"indeterminate"==d?"checked":"unchecked";b[a.options.dataFields.checkState]=d;b[a.options.dataFields.checked]="checked"==d?!0:!1;c.$apply()}}};this.callCheckValueChanging=function(b,d){var r=!0;a.allowEvents&&(r=1==a.options.checkBoxSettings.threeState?angular.isDefined(c.events)&&c.events.itemCheckstateChanging?c.events.itemCheckstateChanging({item:b,value:d}):c.itemCheckstateChanging({e:{item:b,value:d}}):angular.isDefined(c.events)&&c.events.itemCheckedChanging?c.events.itemCheckedChanging({item:b,
value:d}):c.itemCheckedChanging({e:{item:b,value:d}}));return r};this.callCheckValueChanged=function(b,d){a.allowEvents&&(retValue=1==a.options.checkBoxSettings.threeState?angular.isDefined(c.events)&&c.events.itemCheckstateChanged?c.events.itemCheckstateChanged({item:b,value:d}):c.itemCheckstateChanged({e:{item:b,value:d}}):angular.isDefined(c.events)&&c.events.itemCheckedChanged?c.events.itemCheckedChanged({item:b,value:d}):c.itemCheckedChanged({e:{item:b,value:d}}))};var K=[],v=!1;this.fillCheckList=
function(b){if(a.allowEvents&&b&&1==a.options.checkBoxSettings.threeState&&!v){v=!0;K.length=0;K.push({item:b,value:b[a.options.dataFields.checkState]});a.updateListChildItemCheckValue(b);a.updateListParentItemCheckValue(b);for(var d=0,d=0;d<K.length;d++)K[d].item[a.options.dataFields.checkState]=K[d].value;var c=f(function(){d==K.length&&(v=!1);f.cancel(c)},1)}};this.getItemCheckValue=function(b){for(var d="unchecked",c=!1,m=0;m<K.length;m++)if(K[m].item==b){c=!0;d=K[m].value;break}c||(d=b[a.options.dataFields.checkState]);
return d};this.updateListParentItemCheckValue=function(b){for(b=a.getParent(b);b;){var d=b[a.options.dataFields.items];if(d){for(var c=0,m=0,e=0;e<d.length;e++){var f=a.getItemCheckValue(d[e]);"checked"==f?c++:"indeterminate"==f&&m++}e={item:b};e.value=c==d.length?"checked":0<c||0<m?"indeterminate":"unchecked";K.push(e)}b=a.getParent(b)}};this.updateListChildItemCheckValue=function(b){if(b){var d=b[a.options.dataFields.items];if(d)for(var c=0;c<d.length;c++){var m={item:d[c]};"checked"==a.getItemCheckValue(b)?
m.value="checked":m.value="unchecked";K.push(m);a.updateListChildItemCheckValue(d[c])}}};this.updateParentItemCheckValue=function(b){for(b=a.getParent(b);b;){var d=b[a.options.dataFields.items];if(d){for(var c=0,m=0,e=0;e<d.length;e++)"checked"==d[e][a.options.dataFields.checkState]?c++:"indeterminate"==d[e][a.options.dataFields.checkState]&&m++;b[a.options.dataFields.checkState]=c==d.length?"checked":0<c||0<m?"indeterminate":"unchecked"}b=a.getParent(b)}};this.updateItemCheckValue=function(b,d){if("checked"==
d||"unchecked"==d)b[a.options.dataFields.checkState]=d;var c=b[a.options.dataFields.items];if(c&&0<c.length)for(var m=0;m<c.length;m++)a.updateItemCheckValue(c[m],b[a.options.dataFields.checkState]);void 0!=b[a.options.dataFields.checkState]&&(c=a.getParent(b))&&c[a.options.dataFields.checkState]!=b[a.options.dataFields.checkState]&&a.updateParentItemCheckValue(b)};this.updateCheckValues=function(b){if(1==a.options.checkBoxSettings.threeState){b=a.dataObj.getList(b);for(var d=0;d<b.length;d++)a.updateItemCheckValue(b[d])}};
c.$on(c.name+"-update-check",function(b,d){a.updateCheckValues(d)});c.$on(c.name+"-get-check-list",function(b,d){a.updateCheckValues();void 0==d&&(d=1==a.options.checkBoxSettings.threeState?"checked":!0);var c=1==a.options.checkBoxSettings.threeState?a.options.dataFields.checkState:a.options.dataFields.checked,m={operation:"=",value:d},c=Ma.filter(a.getFullList(),c,m);g.setTempData(c)});this.updateCheckBoxSettings=function(b){a.options.checkBoxSettings=b?{autoCheck:e.isFieldAvailable(b.autoCheck,
!1),style:Na(b.style),threeState:e.isFieldAvailable(b.threeState,!1)}:{autoCheck:!1,style:a.defaultCheckBoxStyle,threeState:!1}};var x=function(a){return a?Ma.createTree(a.conditions,a.formula):null},w=function(b){var d=!0;b&&a.filterParams&&(d=(d=b[a.options.dataFields.value])?d:b[a.options.dataFields.text],d=a.filterParams.callback?a.filterParams.callback(d,b):Ma.match(d,a.filterParams.conditions,a.filterParams.formula,x(a.filterParams)));return d},q=0;a.currentList=[];a.indentList=[];a.longestItem=
null;a.isThereChildItems=!1;this.updateLongestItem=function(){a.longestItem=null;for(var b=q=0;b<a.currentList.length;b++){var d=a.currentList[b];if(d[a.options.dataFields.text]){var c=d[a.options.dataFields.text].length;0<a.options.indent&&(c+=a.indentList[b]/a.options.indent);q<c&&(q=c,a.longestItem=d)}}};var L=function(b,d,c,m){b.type="item";b[a.options.dataFields.id]||(b[a.options.dataFields.id]=e.getUniqueId());c&&(b[a.options.dataFields.pid]=c);if(c=w(b))m?a.fullList.push(b):(a.currentList.push(b),
a.indentList.push(d),b[a.options.dataFields.text]&&(m=b[a.options.dataFields.text].length,0<a.options.indent&&(m+=d/a.options.indent),q<m&&(q=m,a.longestItem=b)));return c};this.isThereVisibleChildren=function(b){var d=!1;if(b&&(b=b[a.options.dataFields.items]))for(var c=0;c<b.length;c++)if(w(b[c])){d=!0;break}return d};this.isThereChildItems=!1;var P=function(b,d,c,m){var e=!0;if(!b[a.options.dataFields.items])return e=L(b,d,c,m);if(e=L(b,d,c,m)){c=0;var f=!0;if(m||N(b)){var g=b[a.options.dataFields.items];
if(g){a.applySorting(g);for(var h=0;h<g.length;h++)(f=P(g[h],d+a.options.indent,b[a.options.dataFields.id],m))&&c++}}m||a.isThereChildItems||!(0<c||!N(b)&&b[a.options.dataFields.items]&&0<b[a.options.dataFields.items].length&&a.isThereVisibleChildren(b))||(a.isThereChildItems=!0)}return e};a.fullList=[];this.getFullList=function(b){a.fullList.length=0;b=a.dataObj.getList(b);for(var d=0;d<b.length;d++)P(b[d],0,null,!0);return a.fullList};this.getCurrentList=function(){return a.currentList};this.updateCurrentList=
function(){a.currentList.length=0;a.indentList.length=0;a.longestItem=null;a.isThereChildItems=!1;q=0;var b=a.dataObj.getList();if(b){a.applySorting(b);for(var d=0;d<b.length;d++)P(b[d],0,null,!1)}};this.dataEvents={clear:function(a){return angular.isDefined(c.events)&&c.events.clear?c.events.clear({parent:a.e.parent}):c.clear(a)},objAdded:function(a){return angular.isDefined(c.events)&&c.events.itemAdded?c.events.itemAdded({item:a.e.item}):c.itemAdded(a)},objAdding:function(a){return angular.isDefined(c.events)&&
c.events.itemAdding?c.events.itemAdding({item:a.e.item}):c.itemAdding(a)},objRemoved:function(a){return angular.isDefined(c.events)&&c.events.itemRemoved?c.events.itemRemoved({item:a.e.item}):c.itemRemoved(a)},objRemoving:function(a){return angular.isDefined(c.events)&&c.events.itemRemoving?c.events.itemRemoving({item:a.e.item}):c.itemRemoving(a)}};this.getDataFields=function(a){return{content:a.content?a.content:"content",icon:a.icon?a.icon:"icon",id:a.id?a.id:"id",pid:a.pid?a.pid:"pid",objects:a.items?
a.items:"items",statusIcon:a.statusIcon?a.statusIcon:"statusIcon",text:a.text?a.text:"text"}};a.dataObj=new J({objects:c.items,events:a.dataEvents,fields:a.getDataFields(a.options.dataFields)});c.$on(c.name+"-load-data",function(b,d,c,m,e){a.loadData(d,c,m,e)});c.$on(c.name+"-export-json",function(b,d,c,e){g.setTempData(a.exportToJSON(d,c,e))});this.exportToJSON=function(b,d,c){c=c?c:null;var e=!1!==d?a.getFullList():a.dataObj.getList();b=b?b:[a.options.dataFields.allowDrag,a.options.dataFields.allowDrop,
a.options.dataFields.allowEdit,a.options.dataFields.allowFocus,a.options.dataFields.autoCheck,a.options.dataFields.checkBoxSettings,a.options.dataFields.checked,a.options.dataFields.checkState,a.options.dataFields.content,a.options.dataFields.contextMenu,a.options.dataFields.enabled,a.options.dataFields.expanded,a.options.dataFields.hasChildren,a.options.dataFields.icon,a.options.dataFields.id,a.options.dataFields.pid,a.options.dataFields.statusIcon,a.options.dataFields.style,a.options.dataFields.text,
a.options.dataFields.value];!1===d&&b.push(a.options.dataFields.items);return JSON.stringify(e,b,c)};this.loadData=function(b,d,r,e){a.suspendLayout();a.allowEvents=!1;a.updateDataFields(r);var g=[],h=a.options.dataFields;a.dataObj.clear(d,a.listIsCleared);if(b)if(0!=e){var k=[];b.forEach(function(a,b){var d=a[h.pid];k[d]?(k[d][h.items]||(k[d][h.items]=[]),k[a[h.id]]=a,k[d][h.items].push(a)):(k[a[h.id]]=a,g.push(a))});k.length=0}else g=b;if(d)for(d[a.options.dataFields.items]=g,b=0;b<d[a.options.dataFields.items].length;b++)d[a.options.dataFields.items][b][a.options.dataFields.pid]=
d[a.options.dataFields.id];else if(angular.isDefined(c.items))for(b=c.items.length=0;b<g.length;b++)c.items.push(g[b]);a.dataObj=new J({objects:c.items,events:a.dataEvents,fields:a.getDataFields(a.options.dataFields)});if(a.getTemplateUrl())var l=f(function(){a.resumeLayout();a.allowEvents=!0;f.cancel(l)},100);else a.resumeLayout(),a.allowEvents=!0};this.updateData=function(){a.options.dataFields.dataSource&&(a.loadData(a.options.dataFields.dataSource),a.dataObj=new J({objects:c.items,events:a.dataEvents,
fields:a.getDataFields(a.options.dataFields)}))};var S=!1;this.dragDropStatus=function(a){if(void 0!=a)S=a;else return S};this.getDnDSource=function(a){return{text:a.dataTransfer?a.dataTransfer.getData("text"):a.originalEvent.dataTransfer?a.originalEvent.dataTransfer.getData("text"):""}};this.getTouchData=function(a){return a.changedTouches?a.changedTouches:a.originalEvent?a.originalEvent.changedTouches:null};var ja=angular.element('<div class="iui-drop-marker" data-element="dropmark"></div>');this.getDropMarkLine=
function(){return dropMarkLine};angular.element(h).bind("dragenter",function(b){a.dropMark()});angular.element(h).bind("dragend",function(b){a.removeDropMark();a.dragIcon&&angular.element(a.dragIcon).remove();a.cancelScrollTimer()});a.getMousePos=function(a){return{x:a.pageX?a.pageX:a.originalEvent?a.originalEvent.pageX:0,y:a.pageY?a.pageY:a.originalEvent?a.originalEvent.pageY:0}};this.getCtrlName=function(){return angular.isDefined(c.name)?c.name:""};k.bind("dragenter",function(b){b.preventDefault();
var d=l.getData();d.source||(d.source=a.getDnDSource(b));b={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getCtrlName():"",dragItem:d.source,targetTree:a.getCtrlName(),targetItem:d.target,mousePos:a.getMousePos(b)};a.callDragEnter(b)});k.bind("dragover",function(b){b.preventDefault();var d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d)if(b.dataTransfer?b.dataTransfer.dropEffect=
a.options.allowDrop?"move":"none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect=a.options.allowDrop?"move":"none"),d=l.getData(),d.source||(d.source=a.getDnDSource(b)),l.setData({source:d.source,sourceCtrl:d.sourceCtrl,target:null,dropPos:-1}),d={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getCtrlName():"",dragItem:d.source,targetTree:a.getCtrlName(),targetItem:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)},0==a.callDragOver(d))b.dataTransfer?
b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect="none"),a.dropMark();else{d=a.getMousePos(b);b=d.y+16;var d=d.x+20,r=a.getDropMarkWindow();r.empty();r.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(c.name?c.name:"TreeView")+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:b,left:d});a.dropMark(!0)}});k.bind("drop",function(b){b.preventDefault();a.dropMark();var d=!0;b.dataTransfer?
d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d&&(d=l.getData(),d.source||(d.source=a.getDnDSource(b)),d.source)){var r={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getCtrlName():"",dragItem:d.source,targetTree:a.getCtrlName(),targetItem:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:a.getMousePos(b)};!1!==a.callDragDrop(r)&&(a.drop(d),c.$$phase||c.$apply())}l.clearData();b.stopPropagation()});
k.bind("dragleave",function(b){b.preventDefault();a.dropMark();var d=l.getData();d.source||(d.source=a.getDnDSource(b));b={event:b,sourceTree:d.sourceCtrl?d.sourceCtrl.getCtrlName():"",dragItem:d.source,targetTree:a.getCtrlName(),targetItem:d.target,mousePos:a.getMousePos(b)};a.callDragLeave(b);a.cancelScrollTimer()});k.bind("dragend",function(b){b.preventDefault();a.dropMark();l.getData().source||l.clearData();a.dragDropStatus(!1)});k.bind("mouseleave",function(b){b.preventDefault();a.dropMark();
a.hoverItem=null});this.containsMousePos=function(a,d){return l.hitTest(a,d,{left:0,top:0,right:k[0].clientWidth,bottom:k[0].clientHeight})};this.isPopupActive=function(){return!1};var u=function(b,d){var c=a.options.dataFields;b[c.items]||(b[c.items]=[]);b[c.items].length=0;if(b[d.rows]&&0<b[d.rows].length)for(var e=0;e<b[d.rows].length;e++)b[c.items].push(u(b[d.rows][e],d));return b},Aa=function(b,d){var c=!1;d.sourceCtrl&&(c=d.sourceCollection.removeAt(b,-1,null,d.sourceCtrl.objIsRemoved));c&&
("row"==b.type&&(b=u(b,d.sourceCtrl.options.rowFields)),0===d.dropPos?a.dataObj.insertAt(b,-1,d.target,a.itemIsAdded):1===d.dropPos||2===d.dropPos?1===d.dropPos?a.dataObj.insertByRef(b,d.target,!1,a.itemIsAdded):a.dataObj.insertByRef(b,d.target,!0,a.itemIsAdded):a.dataObj.insertAt(b,-1,null,a.itemIsAdded))};this.setDropSelection=function(b,d){var c=b;!c&&0<=d&&d<a.currentList.length&&(c=a.currentList[d]);a.clearPrevSelection(c);a.itemSelection(null,c)};this.drop=function(b){if(b&&b.sourceCtrl){b.sourceCtrl.suppressProcess=
!0;b.sourceCtrl.suspendLayout();a.suspendLayout();var d=b.source;if(Array.isArray(b.source)){for(var r=[],e=0;e<b.source.length;e++){for(var g=!1,h=b.sourceCollection.getParent(b.source[e]);h;){if(b.sourceCtrl.isObjInSelList(h)){g=!0;break}h=b.sourceCollection.getParent(h)}g||r.push(b.source[e])}if(0<r.length)if(d=r[r.length-1],e=b.sourceCtrl.getObjCurrentIndex(r[0]),g=b.sourceCtrl.getObjCurrentIndex(d),e<=g)for(e=0;e<r.length;e++)Aa(r[e],b);else for(e=r.length-1;0<=e;e--)Aa(r[e],b)}else Aa(b.source,
b);b.sourceCtrl!==a?(a.allowUpdate=!0,b.sourceCtrl.allowUpdate=!0,a.updateCurrentLayout(),b.sourceCtrl.updateCurrentLayout()):(a.allowUpdate=!0,a.updateCurrentLayout());b.sourceCtrl.multiSelection(!1);var k=f(function(){if(d){b.sourceCtrl.clearPrevSelection(d);a.itemSelection(null,d);var r=a.getElemFromItem(d);r&&(r=a.getElement(r))&&r[0].focus();c.$apply();f.cancel(k)}},1);b.sourceCtrl.suppressProcess=!1}};this.isDragAllowed=function(b){return a.options.allowDrag?b&&(b[a.options.dataFields.allowDrag]||
void 0===b[a.options.dataFields.allowDrag])?!0:!1:!1};this.isChildOf=function(b,d){var c=!1;if(b&&d){var m=d[a.options.dataFields.items];if(m&&0<m.length)for(var f=0;f<m.length;f++){if(e.isEqual(b[a.options.dataFields.id],m[f][a.options.dataFields.id])){c=!0;break}else c=a.isChildOf(b,m[f]);if(c)break}}return c};this.isParentOf=function(b,d){var c=a.dataObj.getParent(d);return b&&d&&c&&e.isEqual(b[a.options.dataFields.id],c[a.options.dataFields.id])?!0:!1};this.isDropAllowed=function(b,d,c){var m=
a.options.allowDrop;if(m&&b&&d&&(m=d[a.options.dataFields.allowDrop]||void 0===d[a.options.dataFields.allowDrop]?!0:!1))if(Array.isArray(b))for(var f=0;f<b.length;f++){if(e.isEqual(b[f][a.options.dataFields.id],d[a.options.dataFields.id])||0===c&&a.isParentOf(d,b[f])||a.isChildOf(d,b[f])){m=!1;break}if(!m)break}else if(e.isEqual(b[a.options.dataFields.id],d[a.options.dataFields.id])||0===c&&a.isParentOf(d,b)||a.isChildOf(d,b))m=!1;return m};this.getDropMarkWindow=function(){for(var a=ja,d=angular.element(document.body).children(),
c=0;c<d.length;c++){var e=angular.element(d[c]);if(e[0].attributes&&e[0].attributes["data-element"]&&"dropmark"===e[0].attributes["data-element"].value){a=e;break}}return a};this.dropMark=function(b,d){d||(d=a.getDropMarkWindow());if(d){var c="none";this.options.allowDrop&&(c=b?"block":"none");angular.element(d).css("display",c)}};this.updateDropMarkElem=function(a,d){a&&d&&(a.css("top",d.top+"px"),a.css("left",d.left+"px"),a.css("width",d.width+"px"))};var pa=!1,T=angular.element('<input type="text" style="position:absolute" />');
this.labelEditStatus=function(a){if(void 0!=a)pa=a;else return pa};this.getEditBox=function(){return T};this.updateEditBox=function(a){T&&a&&(T.css("top",a.top+"px"),T.css("left",a.left+"px"),T.css("width",a.width+"px"),T.css("height",a.height+"px"))};c.$on(c.name+"-open-editor",function(b,d){a.openEditor(d)});c.$on(c.name+"-close-editor",function(b,d){a.closeEditor(d)});this.updateEditorSettings=function(b){a.options.editorSettings=b?{activate:e.isFieldAvailable(b.activate,"click")}:{activate:"click"}};
this.allowEvents=!0;this.callAfterCollapse=function(a){angular.isDefined(c.events)&&c.events.afterCollapse&&c.events.afterCollapse({item:a});c.afterCollapse({e:{item:a}})};this.callAfterExpand=function(a){angular.isDefined(c.events)&&c.events.afterExpand&&c.events.afterExpand({item:a});c.afterExpand({e:{item:a}})};this.callAfterEdit=function(a){angular.isDefined(c.events)&&c.events.afterEdit&&c.events.afterEdit({item:a});c.afterEdit({e:{item:a}})};this.callAfterLabelEdit=function(a){angular.isDefined(c.events)&&
c.events.afterLabelEdit&&c.events.afterLabelEdit({item:a});c.afterLabelEdit({e:{item:a}})};this.callAfterSelect=function(a){angular.isDefined(c.events)&&c.events.afterSelect?c.events.afterSelect({item:a}):c.afterSelect({e:{item:a}});angular.isDefined(c.events)&&c.events.selectionChanged?c.events.selectionChanged({item:a}):c.selectionChanged({e:{item:a}})};this.callBeforeCollapse=function(a){var d=!0;return d=angular.isDefined(c.events)&&c.events.beforeCollapse?c.events.beforeCollapse({item:a}):c.beforeCollapse({e:{item:a}})};
this.callBeforeExpand=function(a){var d=!0;return d=angular.isDefined(c.events)&&c.events.beforeExpand?c.events.beforeExpand({item:a}):c.beforeExpand({e:{item:a}})};this.callBeforeEdit=function(a){var d=!0;return d=angular.isDefined(c.events)&&c.events.beforeEdit?c.events.beforeEdit({item:a}):c.beforeEdit({e:{item:a}})};this.callBeforeLabelEdit=function(a){var d=!0;return d=angular.isDefined(c.events)&&c.events.beforeLabelEdit?c.events.beforeLabelEdit({item:a}):c.beforeLabelEdit({e:{item:a}})};this.callChange=
function(){angular.isDefined(c.events)&&c.events.change?c.events.change():c.change()};this.callDragEnter=function(a){angular.isDefined(c.events)&&c.events.dragEnter?c.events.dragEnter({event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,mousePos:a.mousePos}):c.dragEnter({e:{event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,mousePos:a.mousePos}})};this.callDragOver=function(a){var d=!0;return d=
angular.isDefined(c.events)&&c.events.dragOver?c.events.dragOver({event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}):c.dragOver({e:{event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}})};this.callDragDrop=function(a){var d=!0;return d=angular.isDefined(c.events)&&
c.events.dragDrop?c.events.dragDrop({event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}):c.dragDrop({e:{event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,isDropAllowed:a.isDropAllowed,dropPos:a.dropPos,mousePos:a.mousePos}})};this.callDragLeave=function(a){angular.isDefined(c.events)&&c.events.dragLeave?c.events.dragLeave({event:a.event,
sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,mousePos:a.mousePos}):c.dragLeave({e:{event:a.event,sourceTree:a.sourceTree,dragItem:a.dragItem,targetTree:a.targetTree,targetItem:a.targetItem,mousePos:a.mousePos}})};this.callItemClick=function(a,d,e){angular.isDefined(c.events)&&c.events.itemClick&&c.events.itemClick({event:a,item:d,mousePos:e});c.itemClick({e:{event:a,item:d,mousePos:e}})};this.callItemDblClick=function(a,d){var e=!0;return e=angular.isDefined(c.events)&&
c.events.itemDblClick?c.events.itemDblClick({item:a,mousePos:d}):c.itemDblclick({e:{item:a,mousePos:d}})};this.callItemHover=function(a){angular.isDefined(c.events)&&c.events.itemHover?c.events.itemHover({item:a}):c.itemHover({e:{item:a}})};this.callItemRightClick=function(a,d){angular.isDefined(c.events)&&c.events.itemRightClick&&c.events.itemRightClick({item:a,mousePos:d});c.itemRightclick({e:{item:a,mousePos:d}})};this.callKeyDown=function(a,d){angular.isDefined(c.events)&&c.events.keyDown?c.events.keyDown({event:a,
item:d}):c.keyDown({e:{event:a,item:d}})};this.callKeyPress=function(a,d){angular.isDefined(c.events)&&c.events.keyPress?c.events.keyPress({event:a,item:d}):c.keyPress({e:{event:a,item:d}})};this.callKeyUp=function(a,d){angular.isDefined(c.events)&&c.events.keyUp?c.events.keyUp({event:a,item:d}):c.keyUp({e:{event:a,item:d}})};this.callScrollPosChanged=function(){angular.isDefined(c.events)&&c.events.scrollPosChanged?c.events.scrollPosChanged({scrollPos:a.scrollPos}):c.scrollposChanged({e:{scrollPos:a.scrollPos}})};
k.bind("click",function(b){1===b.which&&a.callItemClick(b,null,a.getMousePos(b))});k.bind("dblclick",function(b){b.preventDefault();1===b.which&&a.callItemDblClick(null,a.getMousePos(b));b.stopPropagation()});k.bind("mousedown",function(b){3===b.which&&a.callItemRightClick(null,a.getMousePos(b));b.stopPropagation()});this.expandList=[];this.expandIndentList=[];var Ba=function(b,d,c){b.type="item";b[a.options.dataFields.id]||(b[a.options.dataFields.id]=e.getUniqueId());c&&(b[a.options.dataFields.pid]=
c);c=w(b);N(b)&&b[a.options.dataFields.items]&&0<b[a.options.dataFields.items].length&&(c=c&&a.isThereVisibleChildren(b));c&&(a.expandList.push(b),a.expandIndentList.push(d));return c},z=function(b,d,c){var e=!0;if(!b[a.options.dataFields.items])return e=Ba(b,d+a.options.indent,c);if(e=Ba(b,d+a.options.indent,c)){c=0;var f=!0;if(N(b)){var g=b[a.options.dataFields.items];if(g){a.applySorting(g);for(var h=0;h<g.length;h++)(f=z(g[h],d+a.options.indent,b[a.options.dataFields.id]))&&c++}}!a.isThereChildItems&&
(0<c||!N(b)&&b[a.options.dataFields.items]&&0<b[a.options.dataFields.items].length&&a.isThereVisibleChildren(b))&&(a.isThereChildItems=!0)}return e};this.expand=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(!N(b)){var d=a.getItemCurrentIndex(b);if(b=a.getList(b)){a.applySorting(b);for(var c=0;c<b.length;c++)z(b[c],a.indentList[d],null)}if(0<a.expandList.length){a.allowEvents=!1;d++;Array.prototype.splice.apply(a.currentList,[d,0].concat(a.expandList));Array.prototype.splice.apply(a.indentList,
[d,0].concat(a.expandIndentList));a.getItemScope()?a.updateView():a.updateLayout();var e=f(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();f.cancel(e);a.allowEvents=!0},1)}}};this.collapse=function(b){a.expandList.length=[];a.expandIndentList.length=[];if(N(b)){var d=null,c=!1,e=b,g=-1,h=a.getItemCurrentIndex(b);for(b=a.getParent(b);b&&!c;){d=a.getList(b);for(g=d.indexOf(e)+1;!c&&g<d.length;)e=d[g],0<a.getItemCurrentIndex(e)&&(c=!0),g++;c||(e=b);b=a.getParent(b)}if(!c&&e)for(d=
a.getList(),g=d.indexOf(e)+1;g<d.length;)if(e=d[g],0<a.getItemCurrentIndex(e)){c=!0;break}else g++;h++;d=a.currentList.length-h;c&&(d=a.getItemCurrentIndex(e)-h);if(0<d){a.currentList.splice(h,d);a.indentList.splice(h,d);a.getItemScope()?a.updateView():a.updateLayout();var k=f(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();f.cancel(k);a.allowEvents=!0},1)}}};this.toggle=function(b,d){if(b){if(b[a.options.dataFields.hasChildren]||b[a.options.dataFields.items]&&0!==b[a.options.dataFields.items].length)if(!d||
!1===b[a.options.dataFields.expanded])if(!1!==d||!1!==b[a.options.dataFields.expanded]){var c=void 0!==d?d:!1!==b[a.options.dataFields.expanded]?!0:!1,e=!0,e=void 0!==d?d?a.callBeforeExpand(b):a.callBeforeCollapse(b):c?a.callBeforeCollapse(b):a.callBeforeExpand(b);!1!==e&&(c=void 0!=d?d:!c,c!=b[a.options.dataFields.expanded]&&(0!=c?a.expand(b):a.collapse(b),b[a.options.dataFields.expanded]=c),N(b)?a.callAfterExpand(b):a.callAfterCollapse(b))}}else{c=a.getFullList();for(e=0;e<c.length;e++)c[e][a.options.dataFields.expanded]=
d;a.updateCurrentLayout()}};c.$on(c.name+"-collapse",function(b,d){a.toggle(d,!1)});c.$on(c.name+"-expand",function(b,d){a.toggle(d,!0)});c.$on(c.name+"-toggle",function(b,d){a.toggle(d)});this.filterParams=null;c.$on(c.name+"-filter",function(b,d){a.filter(d)});this.filter=function(b){a.filterParams=b;a.updateCurrentLayout();a.callChange()};this.callGotFocus=function(a,d,e,f){angular.isDefined(c.events)&&c.events.gotFocus?c.events.gotFocus({event:a,item:d,edit:void 0!=e?!0:!1,editValue:f}):c.gotFocus({e:{event:a,
item:d,edit:void 0!=e?!0:!1,editValue:f}})};this.callLostFocus=function(a,d,e,f){angular.isDefined(c.events)&&c.events.lostFocus?c.events.lostFocus({event:a,item:d,edit:void 0!=e?!0:!1,editValue:f}):c.lostFocus({e:{event:a,item:d,edit:void 0!=e?!0:!1,editValue:f}})};this.getTabIndex=function(){return k[0].attributes&&k[0].attributes.tabindex?k[0].attributes.tabindex.value:""};this.updateFocus=function(b){if(1==a.options.allowFocus)var d=f(function(){if(b){var c=a.getElemFromItem(b);c&&(c=a.getElement(c))&&
c[0].focus()}else k[0].focus();f.cancel(d)},5)};c.$on(c.name+"-focus",function(b,d){a.updateFocus(d)});var ka=!1,N=function(b){return b?b[a.options.dataFields.expanded]||void 0===b[a.options.dataFields.expanded]?!0:!1:!0};this.getElement=function(a,d){var c=null;d||(d="content");if(a)for(var e=a.children(),f=0;f<e.length;f++){var g=angular.element(e.eq(f));if(g[0].attributes&&g[0].attributes["data-element"]&&g[0].attributes["data-element"].value===d){c=g;break}}return c};this.getElemFromItem=function(b){var d=
null;if(b){b=a.getItemCurrentIndex(b);var c=k.find("li");if(c&&0<c.length)for(var e=0;e<c.length;e++){var f=angular.element(c[e]);if(f[0].attributes["data-index"]&&f[0].attributes["data-index"].value.toString()===b.toString()){d=f;break}}}return d};this.getIndent=function(b){var d=0;if(b&&0<a.options.indent)for(parent=a.dataObj.getParent(b);parent;)d+=a.options.indent,parent=a.dataObj.getParent(parent);return d};this.getItemCurrentIndex=function(b){return b&&a.currentList?a.currentList.indexOf(b):
-1};this.getObjCurrentIndex=function(b){return a.getItemCurrentIndex(b)};this.getObjState=function(b){if(b)switch(b.type){case "item":if(0==b[a.options.dataFields.enabled])return"disabled";if(1==b.selected&&a.isObjInSelList(b))return"selected";if(b==a.hoverItem)return"hovered"}return"normal"};this.getItemFromChildElem=function(b){return b?(b=angular.element(b))?a.getItemFromElem(b[0].parentElement):null:null};this.getItemFromElem=function(b){if(b&&(b=angular.element(b))&&b[0].attributes["data-index"]&&
(b=b[0].attributes["data-index"].value,a.isIndexInRange(b)))return a.currentList[b]};this.isIndexInRange=function(b){return 0<=b&&b<a.currentList.length};this.isItemEnabled=function(b){return e.isEnabled(b[a.options.dataFields.enabled])};this.mouseButtonStatus=function(a){ka=a};c.$on(c.name+"-ensure-visible",function(b,d,c){a.ensureVisible(d,c)});c.$on(c.name+"-find-item-by-id",function(b,d){g.setTempData(a.findItemById(d))});c.$on(c.name+"-find-item-by-text",function(b,d){g.setTempData(a.findItemByText(d))});
c.$on(c.name+"-get-full-path",function(b,d){g.setTempData(a.getFullPath(d))});c.$on(c.name+"-get-item-level",function(b,d){g.setTempData(a.getLevel(d))});c.$on(c.name+"-get-item-parent",function(b,d){g.setTempData(a.getParent(d))});c.$on(c.name+"-get-item-at",function(b,d){d?g.setTempData(a.getItemAt(d.x,d.y)):g.setTempData(null)});c.$on(c.name+"-get-flat-list",function(b,d){d?g.setTempData(a.getFullList()):g.setTempData(a.currentList)});c.$on(c.name+"-get-list",function(b,d,c){1==c?g.setTempData(a.getFullList(d)):
g.setTempData(a.getList(d))});this.ensureVisible=function(b,d){if(b){for(var c=[],e=a.getParent(b);e;)c.push(e),e=a.getParent(e);for(e=c.length-1;0<=e;e--)c[e][a.options.dataFields.expanded]=!0;a.updateCurrentLayout();var g=f(function(){d=void 0!=d?d:"center";a.scrollTo(b,d);f.cancel(g)},100)}};this.findItemById=function(b){return a.dataObj.findObjectById(b)};this.findItemByText=function(b){return a.dataObj.findObjectByText(b)};this.getFullPath=function(b){var d="";if(b)for(d=b[a.options.dataFields.text],
b=a.getParent(b);b;)d=[b[a.options.dataFields.text],a.options.pathSeparator,d].join(""),b=a.getParent(b);return d};this.getLevel=function(a){var d=0;for(a=this.getParent(a);a;)d++,a=this.getParent(a);return d};this.getParent=function(b){return a.dataObj.getParent(b)};this.getList=function(b){return a.dataObj.getList(b)};this.getFirstItem=function(){for(var b=null,d=0;d<a.currentList.length;d++)if(a.isItemEnabled(a.currentList[d])){b=a.currentList[d];break}return b};this.getPrevItem=function(b){var d=
null;if(0<=b&&b<a.currentList.length)for(--b;0<=b;b--)if(a.isItemEnabled(a.currentList[b])){d=a.currentList[b];break}return d};this.getNextItem=function(b){var d=null;for(b+=1;b<a.currentList.length;b++)if(a.isItemEnabled(a.currentList[b])){d=a.currentList[b];break}return d};this.getLastItem=function(){for(var b=null,d=a.currentList.length-1;0<=d;d--)if(a.isItemEnabled(a.currentList[d])){b=a.currentList[d];break}return b};this.updateSelectionStatus=function(b){switch(b){case "shift":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);
a.shiftKeyStatus(!1);break;case "multi-extended":a.multiSelection(!0);a.shiftKeyStatus(!0);break;default:a.multiSelection(!1),a.shiftKeyStatus(!1)}break;case "ctrl":switch(a.options.selectionMode){case "multi-simple":a.multiSelection(!0);break;case "multi-extended":a.multiSelection(!0);break;default:a.multiSelection(!1)}}};k.bind("keydown",function(b){switch(b.keyCode){case 16:a.updateSelectionStatus("shift");break;case 17:a.updateSelectionStatus("ctrl");break;default:(b.ctrlKey||b.metaKey)&&a.updateSelectionStatus("ctrl"),
b.shiftKey&&a.updateSelectionStatus("shift")}});a.allowUpdate=!0;this.suspendLayout=function(){a.allowUpdate=!1};this.resumeLayout=function(){a.allowUpdate=!0;a.updateLayout()};c.$on(c.name+"-refresh",function(b,d,c){a.refresh(d,c)});c.$on(c.name+"-resume-layout",function(b){a.resumeLayout()});c.$on(c.name+"-suspend-layout",function(b){a.suspendLayout()});c.$on(c.name+"-update-layout",function(b){a.updateLayout()});c.$on(c.name+"-update-view",function(b){a.updateView()});c.$on(c.name+"-begin-load",
function(b,d,c){d?(0>a.options.loadItems.indexOf(d)&&a.options.loadItems.push(d),a.updateView()):a.beginLoad(c)});c.$on(c.name+"-end-load",function(b,d){a.endLoad(d)});this.callLoadComplete=function(){angular.isDefined(c.events)&&c.events.loadComplete?c.events.loadComplete():c.loadComplete()};this.callUpdateComplete=function(){angular.isDefined(c.events)&&c.events.updateComplete?c.events.updateComplete():c.updateComplete()};c.$on(c.name+"-get-scroll-pos",function(b){g.setTempData(a.getScrollPos())});
c.$on(c.name+"-set-scroll-pos",function(b,d){a.setScrollPos(d)});c.$on(c.name+"-scroll-to",function(b,d,c){a.scrollTo(d,c)});var X=!1,Y=!1;this.shiftKeyStatus=function(a){if(void 0!=a)X=a;else return X};this.multiSelection=function(a){if(void 0!=a)Y=a;else return Y};this.isItemSelected=function(a){return e.isSelected(a)};this.clearPrevSelection=function(b){for(var d=0;d<a.options.selectedItems.length;d++)b&&!e.isEqual(a.options.selectedItems[d][a.options.dataFields.id],b[a.options.dataFields.id])?
a.options.selectedItems[d].selected=!1:b||(a.options.selectedItems[d].selected=!1);a.options.selectedItems.length=0;b&&a.isItemEnabled(b)&&a.options.selectedItems.push(b);a.refresh()};this.selectionCancelled=!1;this.itemSelection=function(b,d,f){if(d){if("none"!==a.options.selectionMode)if(a.isItemEnabled(d)){var g=a.itemSelection(),h=!0;g&&(h=!e.isEqual(g[a.options.dataFields.id],d[a.options.dataFields.id]));var k=!0,k=angular.isDefined(c.events)&&c.events.beforeSelect?c.events.beforeSelect({item:d}):
c.beforeSelect({e:{item:d}});a.selectionCancelled=0==k;if(0!=k)if(h){var l=b&&(b.shiftKey||b.ctrlKey||b.metaKey)?!0:!1,h=!0;"multi-extended"===a.options.selectionMode&&(h=!a.isObjInSelList(d));h&&(ka&&(X||b&&b.shiftKey)?a.clearPrevSelection():Y||l||"multi-simple"===a.options.selectionMode||a.clearPrevSelection());a.options.selectedItem=d;if(ka&&(X||b&&b.shiftKey)&&"one"!=a.options.selectionMode){if(b=a.getItemCurrentIndex(g),f=a.getItemCurrentIndex(d),b>f&&(g=b,b=f,f=g),a.isIndexInRange(b)&&a.isIndexInRange(f))for(;b<=
f;b++)a.currentList[b].selected=!0,a.options.selectedItems.push(a.currentList[b])}else ka&&(Y||l||"multi-simple"===a.options.selectionMode)?(b=null===d.selected||"undefined"===d.selected?!1:d.selected,d.selected=!b,d.selected?a.isObjInSelList(d)||a.options.selectedItems.push(d):a.options.selectedItems=a.options.selectedItems.filter(function(a){return a!=d})):(d.selected=!0,a.isObjInSelList(d)||a.options.selectedItems.push(d));angular.isDefined(c.selectedItem)&&(c.selectedItem=d);a.callAfterSelect(d);
a.refresh(null,null,!0)}else if(Y||l||"multi-simple"===a.options.selectionMode)b=null===d.selected||"undefined"===d.selected?!1:d.selected,f&&"undefined"!==f&&(b=f),d[a.options.dataFields.selected]=!b,d[a.options.dataFields.selected]?a.isObjInSelList(d)||a.options.selectedItems.push(d):a.options.selectedItems=a.options.selectedItems.filter(function(a){return a!=d}),a.callAfterSelect(d),a.refresh(null,null,!0)}else a.clearPrevSelection()}else return a.options.selectedItem};this.updateSelection=function(b,
d){var c=b&&(b.shiftKey||b.metaKey)?!0:!1;!("multi-simple"!==a.options.selectionMode&&0<a.options.selectedItems.length)||X||b.shiftKey||Y||c||a.selectionCancelled||(a.clearPrevSelection(d),a.refresh(null,null,!0));a.selectionCancelled=!1};this.selectFirstItem=function(){for(var b=null,d=0;d<a.currentList.length;d++)if(a.isItemEnabled(a.currentList[d])){b=a.currentList[d];break}this.itemSelection(null,b);return a.options.selectedItem};this.isObjInSelList=function(b){var d=!1,c=a.options.selectedItems;
if(b&&c)for(var f=0;f<c.length;f++)if(e.isEqual(c[f][a.options.dataFields.id],b[a.options.dataFields.id])){d=!0;break}return d};this.getItemAt=function(b,d){var c=null,f=null,g=null,h=k.find("li");if(h&&0<h.length)for(var l=0;l<h.length;l++)if(c=angular.element(h[l]),f=e.getPageRect(c),e.checkHit(b,d,f)){g=a.getItemFromElem(c);break}return g};this.resetSelection=function(){switch(a.options.selectionMode){case "none":a.clearPrevSelection();break;default:a.clearPrevSelection(a.itemSelection())}};c.$on(c.name+
"-clear-selection",function(b){a.clearPrevSelection();a.options.selectedItem=null});c.$on(c.name+"-get-selected-item",function(b){g.setTempData(a.itemSelection())});c.$on(c.name+"-set-selected-item",function(b,d){var c=f(function(){a.itemSelection(null,d);f.cancel(c)},1)});c.$on(c.name+"-get-selected-items",function(b){g.setTempData(a.options.selectedItems)});c.$on(c.name+"-set-selected-items",function(b,d){d&&Array.isArray(d)&&f(function(){for(var b=a.options.selectedItems.length=0;b<d.length;b++)d[b].selected=
!0,a.options.selectedRows.push(d[b]);0<d.length?(a.options.selectedItem=d[d.length-1],a.callAfterSelect(a.options.selectedItem)):a.options.selectedItem=null;a.refresh(null,null,!0)},1)});c.$on(c.name+"-move-item",function(b,d,c,e,f){a.moveItem(d,c,e,f)});c.$watch("options",function(b,d){b!==d&&(a.updateOptions(b),a.updateLayout())},!0);c.$watch("allowDrag",function(b,d){b!==d&&(a.options.allowDrag=b,a.updateView())});c.$watch("allowDrop",function(b,d){b!==d&&(a.options.allowDrop=b,a.updateView())});
c.$watch("allowFocus",function(b,d){b!==d&&(a.options.allowFocus=b)});c.$watch("autoCheck",function(b,d){b!==d&&(a.options.autoCheck=b,a.updateView())});c.$watch("autoExpand",function(b,d){b!==d&&(a.options.autoExpand=b)});c.$watch("checkBoxSettings",function(b,d){b!==d&&a.updateCheckBoxSettings(b)});c.$watch("controlStyle",function(b,d){b!==d&&a.updateControlStyle(b)});c.$watch("editorSettings",function(b,d){b!==d&&a.updateEditorSettings(b)});c.$watch("fields",function(b,d){b!==d&&(a.options.dataFields=
b,a.UpdateData())});c.$watch("hoverSelection",function(b,d){b!==d&&(a.options.hoverSelection=b)});c.$watch("indent",function(b,d){b!==d&&(a.options.indent=b,a.updateLayout())});c.$watch("itemIcon",function(b,d){b!==d&&(a.options.itemIcon=b,a.updateLayout())});c.$watch("labelEdit",function(b,d){b!==d&&(a.options.labelEdit=b)});c.$watch("pathSeparator",function(b,d){b!==d&&(a.options.pathSeparator=b)});c.$watch("rtl",function(b,d){b!==d&&(a.options.rtl=b,a.updateLayout())});c.$watch("selectionMode",
function(b,d){b!==d&&(a.options.selectionMode=b,a.resetSelection())});c.$watch("showCheckBoxes",function(b,d){b!==d&&(a.options.showCheckBoxes=b,a.updateLayout())});c.$watch("showExpandBoxes",function(b,d){b!==d&&(a.options.showExpandBoxes=b,a.updateLayout())});c.$watch("showIcons",function(b,d){b!==d&&(a.options.showIcons=b,a.updateLayout())});c.$watch("showStatusIcons",function(b,d){b!==d&&(a.options.showStatusIcons=b,a.updateLayout())});c.$watch("selectedItem",function(b,d){b!==d&&(d&&(d.selected=
!1),a.options.selectedItem=b,a.callAfterSelect(b))});c.$watch("templateSettings",function(b,d){b!==d&&(a.updateTemplateSettings(b),a.updateLayout())});this.sortComparer=null;c.$watch("sorting",function(b,d){b!==d&&(a.options.sorting=b)});c.$on(c.name+"-sort",function(b,d,c){a.sort(d,c)});this.sort=function(b,d){a.sortComparer=d;if("ascending"==b||"descending"==b||"none"==b)a.options.sorting=b;a.updateCurrentLayout();a.callChange()};this.isSortingAllowed=function(){return"ascending"==a.options.sorting||
"descending"==a.options.sorting};this.applySorting=function(b){b&&(a.sortComparer?b.sort(a.sortComparer):a.isSortingAllowed()&&b.sort(function(b,c){var f=null,g=null;(f=b[a.options.dataFields.value])||(f=b[a.options.dataFields.text]);e.isObject(f)&&(f=f.value?f.value:f.text);(g=c[a.options.dataFields.value])||(g=c[a.options.dataFields.text]);e.isObject(g)&&(g=g.value?g.value:g.text);f=void 0!=f?f:null;g=void 0!=g?g:null;switch(a.options.sorting){case "ascending":if(f<g)return-1;if(f>g)return 1;break;
case "descending":if(f>g)return-1;if(f<g)return 1;break;default:return 0}}))};var Na=function(b){if(b){var d=e.isFieldAvailable(b.general,"iui-checkbox");b=(b=b.box)?{general:e.isFieldAvailable(b.general,"iui-checkbox-box"),disabled:e.isFieldAvailable(b.disabled,"iui-checkbox-disabled"),checked:e.isFieldAvailable(b.checked,"iui-checkbox-checked"),indeterminate:e.isFieldAvailable(b.indeterminate,"iui-checkbox-indeterminate"),unchecked:e.isFieldAvailable(b.unchecked,"iui-checkbox-unchecked")}:a.options.controlStyle.item.checkBox.box;
return{general:d,box:b}}return a.options.controlStyle.item.checkBox};this.getExpandBoxStyle=function(b){return b?{general:e.isFieldAvailable(b.general,"iui-treeview-expand-box"),animated:e.isFieldAvailable(b.animated,"iui-treeview-expand-box-load"),expanded:e.isFieldAvailable(b.expanded,"iui-treeview-expand-box-open"),collapsed:e.isFieldAvailable(b.collapsed,"iui-treeview-expand-box-close")}:a.options.controlStyle.item.expandBox};var Pa=function(b){if(b){var d;d=b.general;d=e.isString(d)?d:d?{disabled:e.isFieldAvailable(d.disabled,
"iui-treeview-item-disabled"),focused:e.isFieldAvailable(d.focused,"iui-treeview-item-focused"),normal:e.isFieldAvailable(d.normal,"iui-treeview-item"),hovered:e.isFieldAvailable(d.hovered,"iui-treeview-item-hovered"),selected:e.isFieldAvailable(d.selected,"iui-treeview-item-selected")}:a.options.controlStyle.item.general;var c=Na(b.checkBox),f=a.getExpandBoxStyle(b.expandBox);b=b.content;b=e.isString(b)?b:b?{disabled:e.isFieldAvailable(b.disabled,"iui-treeview-item-content-disabled"),focused:e.isFieldAvailable(b.focused,
"iui-treeview-item-content-focused"),normal:e.isFieldAvailable(b.normal,"iui-treeview-item-content"),hovered:e.isFieldAvailable(b.hovered,"iui-treeview-item-content-hovered"),selected:e.isFieldAvailable(b.selected,"iui-treeview-item-content-selected")}:a.options.controlStyle.item.content;return{general:d,checkBox:c,expandBox:f,content:b}}return a.options.controlStyle.item};this.updateControlStyle=function(b){a.options.controlStyle=b?{general:e.isFieldAvailable(b.general,"iui-treeview"),item:Pa(b.item)}:
{general:e.isFieldAvailable(a.defaultStyle.general,"iui-treeview"),item:Pa(a.defaultStyle.item)}};this.getCurrentItemStyle=function(b,d){var c=a.options.controlStyle.item;if(b)switch(b.style){case "initial":break;case "parent":return a.getCurrentItemStyle(a.getParent(b),d);default:null!=b.style&&(c=b.style)}if(d){if(e.isString(c.general))return c.general;switch(d){case "disabled":return c.general&&c.general.disabled?c.general.disabled:a.options.controlStyle.item.general.disabled;case "focused":return c.general&&
c.general.focused?c.general.focused:a.options.controlStyle.item.general.focused;case "hovered":return c.general&&c.general.hovered?c.general.hovered:a.options.controlStyle.item.general.hovered;case "selected":return c.general&&c.general.selected?c.general.selected:a.options.controlStyle.item.general.selected;default:return c.general&&c.general.normal?c.general.normal:a.options.controlStyle.item.general.normal}}else return c?c:a.options.controlStyle.item};this.getCurrentItemContentStyle=function(b,
d){var c=a.options.controlStyle.item.content;if(b)switch(b.style){case "initial":break;case "parent":return a.getCurrentItemContentStyle(a.getParent(b),d);default:null!=b.style&&b.style.content&&(c=b.style.content)}if(d){if(e.isString(c))return c;switch(d){case "disabled":return c&&c.disabled?c.disabled:a.options.controlStyle.item.content.disabled;case "focused":return c&&c.focused?c.focused:a.options.controlStyle.item.content.focused;case "hovered":return c&&c.hovered?c.hovered:a.options.controlStyle.item.content.hovered;
case "selected":return c&&c.selected?c.selected:a.options.controlStyle.item.content.selected;default:return c&&c.normal?c.normal:a.options.controlStyle.item.content.normal}}else return c?c:a.options.controlStyle.item.content}}]).directive("iuiTreeview",["$compile","$timeout","$interval","IntegralUIInternalService","IntegralUIDragDrop","$window",function(c,k,f,h,e,J){return{restrict:"EA",controller:"IntegralUITreeViewController",transclude:!0,replace:!0,template:'<div class="iui-treeview" data-element="treeview"><ul class="iui-treeview-block"></ul></div>',
scope:{allowAnimation:"=",allowDrag:"=",allowDrop:"=",allowFocus:"=",animationSpeed:"=",autoCheck:"=",autoExpand:"=",checkboxSettings:"=",controlStyle:"=",editorSettings:"=",fields:"=",hoverSelection:"=",itemIcon:"=",indent:"=",items:"=",labelEdit:"=",name:"@",options:"=?",pathSeparator:"@",rtl:"=",selectedIndex:"=",selectedItem:"=",selectionMode:"@",showCheckBoxes:"=",showExpandBoxes:"=",showIcons:"=",showStatusIcons:"=",sorting:"@",templateSettings:"=",afterCollapse:"&",afterEdit:"&",afterExpand:"&",
afterLabelEdit:"&",afterSelect:"&",beforeCollapse:"&",beforeEdit:"&",beforeExpand:"&",beforeLabelEdit:"&",beforeSelect:"&",change:"&",clear:"&",dragDrop:"&",dragEnter:"&",dragLeave:"&",dragOver:"&",events:"=?",itemAdded:"&",itemAdding:"&",itemCheckedChanging:"&",itemCheckedChanged:"&",itemCheckstateChanging:"&",itemCheckstateChanged:"&",itemClick:"&",itemDblclick:"&",itemHover:"&",loadComplete:"&",gotFocus:"&",keyDown:"&",keyPress:"&",keyUp:"&",lostFocus:"&",itemRemoved:"&",itemRemoving:"&",itemRightclick:"&",
scrollposChanged:"&",selectionChanged:"&",updateComplete:"&"},link:function(g,l,Ma,a,K){var v=this,x=l.children().eq(0),w=angular.element('<div class="iui-scrollbar-vertical"><div class="iui-scroll-button-thumb-vertical"></div></div>'),q=angular.element('<div class="iui-scrollbar-horizontal"><div class="iui-scroll-button-thumb-horizontal"></div></div>'),L=angular.element('<div class="iui-scrollbar-corner"></div>'),P=null,S=null,ja=null,u=a.getEditBox(),Aa=function(){var b="iui-treeview-block";a.options.showStatusIcons&&
(b+=" "+b+"-shift-left");a.options.rtl&&(b+=" "+b+"-rtl");return b};g.$on("$destroy",function(a){v.s2t();l.unbind("click dblclick dragenter dragleave dragend drop keydown mousedown mouseleave mousemove mousewheel scroll touchstart touchmove touchend");angular.element(J).unbind("dragenter dragover dragend mousemove mouseup");u&&u.unbind("blur focus keydown mousedown");X();p&&p.$destroy()});l.append(a.getDropMarkWindow());a.dropMark();var pa=function(){P&&(k.cancel(P),P=null)};a.addDropMark=function(){var b;
b=l[0];for(var c=null;b;){if(b===document.getElementsByTagName("body")[0]){c=b;break}b=b.offsetParent}if(b=c)angular.element(b).append(a.getDropMarkWindow()),a.dropMark()};a.removeDropMark=function(){a.getDropMarkWindow().remove()};var T=function(b,c){a.labelEditStatus()&&a.closeEditor();b.preventDefault();var d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d){var B=a.getItemFromChildElem(c);
if(B){var d=c[0].getBoundingClientRect(),E=bb(),f=a.getMousePos(b);f.x-=d.left+E.x;f.y-=d.top+E.y;var E=e.getDropPos(f,{x:0,y:0,width:c[0].offsetWidth,height:c[0].offsetHeight}),f=e.getData(),d=a.isDropAllowed(f.source,B,E),g={event:b,sourceTree:f.sourceCtrl?f.sourceCtrl.getCtrlName():"",dragItem:f.source,targetTree:a.getCtrlName(),targetItem:B,isDropAllowed:d,dropPos:E,mousePos:a.getMousePos(b)},g=a.callDragOver(g);if(d&&0!=g){var h=a.getMousePos(b),g=h.y+16,h=h.x+20,k=a.getDropMarkWindow();k.empty();
var l="iui-drop-marker-move-in";switch(E){case 1:l="iui-drop-marker-move-up";break;case 2:l="iui-drop-marker-move-down"}k.append("<span class='"+l+"'></span><span class='iui-drop-marker-title'>"+B[a.options.dataFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),{top:g,left:h});a.dropMark(d);e.setData({source:f.source,sourceList:f.sourceList,target:B,dropPos:E})}else b.dataTransfer?b.dataTransfer.dropEffect="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.dropEffect=
"none"),a.dropMark()}}},Ba=function(b,c){b.preventDefault();pa();a.dropMark();var d=!0;b.dataTransfer?d="none"===b.dataTransfer.effectAllowed?!1:!0:b.originalEvent&&b.originalEvent.dataTransfer&&(d="none"===b.originalEvent.dataTransfer.effectAllowed?!1:!0);if(d){var B=a.getItemFromChildElem(c);if(B){var E=e.getData(),f=E.source;f||(f=a.getDnDSource(b));(d=a.isDropAllowed(f,B,E.dropPos))&&f&&(d={event:b,sourceTree:E.sourceCtrl?E.sourceCtrl.getCtrlName():"",dragItem:f,targetTree:a.getCtrlName(),targetItem:B,
isDropAllowed:d,dropPos:E.dropPos,mousePos:a.getMousePos(b)},!1!==a.callDragDrop(d)&&(a.drop(E),g.$$phase||g.$apply()))}}e.clearData();a.dragDropStatus(!1);b.stopPropagation()},z=angular.element('<div style="opacity:0.75;position:absolute;z-index:999"></div>'),ka=function(){z&&(z.remove(),z.css("top","-9999999px"),z.css("left","-9999999px"))},N=function(b){var c="";if(a.options.showExpandBoxes){var d=a.defaultStyle.item.expandBox.general;b[a.options.dataFields.style]&&b[a.options.dataFields.style].expandBox&&
b[a.options.dataFields.style].expandBox.general!=d?d+=" "+b[a.options.dataFields.style].expandBox.general:a.options.controlStyle.item.expandBox.general!=d&&(d+=" "+a.options.controlStyle.item.expandBox.general);var B=a.getCurrentItemStyle(b),B=a.getExpandBoxStyle(B.expandBox);if(a.isThereChildItems||b&&b[a.options.dataFields.hasChildren])c=d;b&&(b[a.options.dataFields.hasChildren]||b[a.options.dataFields.items]&&0<b[a.options.dataFields.items].length&&a.isThereVisibleChildren(b))&&(0<=a.options.loadItems.indexOf(b)?
c+=" "+B.animated:(c=b[a.options.dataFields.hasChildren]&&void 0===b[a.options.dataFields.expanded]?c+(" "+B.expanded):0!=b[a.options.dataFields.expanded]?c+(" "+B.collapsed):c+(" "+B.expanded),!0===a.options.rtl&&(c+="-rtl"),a.isItemEnabled(b)||(c+="-disabled")))}return c},X=function(){var b=x.find("li");if(0<b.length)for(var c=0;c<b.length;c++){currentElem=angular.element(b[c]);currentElem.unbind("dragover drop dragenter dragleave dragend");var d=a.getElement(currentElem,"expandbox");d&&d.unbind("click touchend");
(d=a.getElement(currentElem))&&d.unbind("blur click dragstart dragover drop dragenter dragleave dragend dblclick focus keydown keypress keyup mouseenter mouseleave mousedown mouseup touchstart touchmove touchend")}},Y=function(){var c=x.find("li");if(0<c.length){var d=null,n=c.length-1,B="content";a.getTemplateUrl()&&(B="template-content");for(var E=0;E<=n;E++)d=angular.element(c[E]),Na(d),Pa(a.getElement(d,"expandbox")),b(a.getElement(d,"icon")),ub(a.getElement(d,B))}},Na=function(b){b&&(b.bind("dragover",
function(b){var c=a.getItemFromElem(this);if(c&&a.isItemEnabled(c)){if(a.isScrollBarVisible("vertical")){var c=a.getMousePos(b),d=l[0].getBoundingClientRect();c.x-=angular.element(J)[0].pageXOffset;c.y-=angular.element(J)[0].pageYOffset;c.y<d.top+40?Qa(!1):c.y>d.bottom-40?Qa(!0):qa()}else qa();b.stopPropagation()}}),b.bind("dragend",function(b){var c=a.getItemFromElem(this);c&&a.isItemEnabled(c)&&(b.preventDefault(),a.dragDropStatus(!1),a.dropMark(),e.getData().source||e.clearData())}))},Pa=function(b){b&&
(b.bind("click",function(b){var c=angular.element(this);(c=a.getItemFromChildElem(c))&&a.isItemEnabled(c)&&(a.toggle(c),b.stopPropagation())}),b.bind("touchend",function(b){b.preventDefault();var c=angular.element(this);(c=a.getItemFromChildElem(c))&&a.isItemEnabled(c)&&(a.toggle(c),b.stopPropagation())}))},b=function(b){b&&(b.bind("dragover",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&T(b,angular.element(this))}),b.bind("drop",function(b){var c=a.getItemFromChildElem(this);
c&&a.isItemEnabled(c)&&Ba(b,angular.element(this))}))};a.dragIcon=document.createElement("img");a.dragIcon.width=1;var d={x:0,y:0},r={x:0,y:0},m=!1,ab=!1,W=null,bb=function(){return{x:angular.element(J)[0].pageXOffset,y:angular.element(J)[0].pageYOffset}},oa=function(a){var b=bb();return{x:a.x-b.x,y:a.y-b.y}},ub=function(b){if(b){b.bind("dragstart",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c))if(c=angular.element(this),a.labelEditStatus())b.preventDefault();else{e.clearData();
if(c=a.getItemFromChildElem(c))if(Oa(),a.isDragAllowed(c)){a.dragDropStatus(!0);a.addDropMark();b.dataTransfer?(b.dataTransfer.effectAllowed="move",b.dataTransfer.setData("text",c[a.options.dataFields.id]?c[a.options.dataFields.id].toString():"")):b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="move",b.originalEvent.dataTransfer.setData("text",c[a.options.dataFields.id]?c[a.options.dataFields.id].toString():""));c={source:c,sourceCtrl:a,sourceCollection:a.dataObj};
switch(a.options.selectionMode){case "multi-simple":c.source=a.options.selectedItems;break;case "multi-extended":c.source=a.options.selectedItems}e.setData(c)}else b.dataTransfer?b.dataTransfer.effectAllowed="none":b.originalEvent&&b.originalEvent.dataTransfer&&(b.originalEvent.dataTransfer.effectAllowed="none");b.stopPropagation()}});b.bind("dragover",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&T(b,angular.element(this))});b.bind("drop",function(b){var c=a.getItemFromChildElem(this);
c&&a.isItemEnabled(c)&&Ba(b,angular.element(this))});b.bind("dragenter",function(b){b.preventDefault();var c=angular.element(this),d=a.getItemFromChildElem(c);if(d&&a.isItemEnabled(d)&&(Ca||(a.hoverItem=d,a.refresh(d)),a.options.autoExpand))var t=k(function(){P||(P=k(function(){P&&a.toggle(d,!0)},750));k.cancel(t)},1);c=e.getData();c.source||(c.source=a.getDnDSource(b));c={event:b,sourceTree:c.sourceCtrl?c.sourceCtrl.getCtrlName():"",dragItem:c.source,targetTree:a.getCtrlName(),targetItem:c.target,
mousePos:a.getMousePos(b)};a.callDragEnter(c);b.stopPropagation()});b.bind("dragleave",function(b){b.preventDefault();a.hoverItem=null;var c=angular.element(this);(c=a.getItemFromChildElem(c))&&a.isItemEnabled(c)&&a.refresh(c);pa();c=e.getData();c.source||(c.source=a.getDnDSource(b));c={event:b,sourceTree:c.sourceCtrl?c.sourceCtrl.getCtrlName():"",dragItem:c.source,targetTree:a.getCtrlName(),targetItem:c.target,mousePos:a.getMousePos(b)};a.callDragLeave(c);b.stopPropagation()});b.bind("dragend",function(b){(b=
a.getItemFromChildElem(this))&&a.isItemEnabled(b)&&a.dragDropStatus(!1)});b.bind("touchstart",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c)&&(b.preventDefault(),(c=a.getTouchData(b))&&0<c.length)){ab=!0;var t=k(function(){ab=!1;k.cancel(t)},750);d=oa({x:c[0].pageX,y:c[0].pageY});a.mouseButtonStatus(!0);c=d;if((c=a.getItemAt(c.x,c.y))&&a.isItemEnabled(c)){var e=angular.element(this);a.itemSelection(b,c);W=c;e[0].focus();a.changeCheckValue(c);"click"==a.options.editorSettings.activate&&
za(b,angular.element(this))}}});b.bind("touchmove",function(b){var c,t,n=a.getItemFromChildElem(this);if(n&&a.isItemEnabled(n)&&(n=a.getTouchData(b))&&0<n.length){r=oa({x:n[0].pageX,y:n[0].pageY});var n=Math.abs(r.x-d.x),f=Math.abs(r.y-d.y),Z=l[0].getBoundingClientRect();if(e.hitTest(r.x,r.y,Z)){if(b.preventDefault(),z&&z.css("display","block"),!ab)if(!m&&(2<n||2<f)&&W&&a.isItemEnabled(W))if(angular.element(this),a.labelEditStatus())b.preventDefault();else{m=!0;e.clearData();if((n=a.getTouchData(b))&&
0<n.length&&(oa({x:n[0].pageX,y:n[0].pageY}),W&&(Oa(),a.isDragAllowed(W)))){a.dragDropStatus(!0);a.addDropMark();n={source:W,sourceCtrl:a,sourceCollection:a.dataObj};switch(a.options.selectionMode){case "multi-simple":n.source=a.options.selectedItems;break;case "multi-extended":n.source=a.options.selectedItems}e.setData(n);if(n=a.getElemFromItem(W))if(n=a.getElement(n))z.empty(),z.append(n.clone()),z.css("display","none"),l.append(z)}b.stopPropagation()}else if(m){angular.element(this);a.labelEditStatus()&&
a.closeEditor();b.preventDefault();if((n=a.getTouchData(b))&&0<n.length){var Z=bb(),h=oa({x:n[0].pageX,y:n[0].pageY});if(n=a.getItemAt(h.x,h.y)){if(f=a.getElemFromItem(n)){var k=f[0].getBoundingClientRect(),k=e.getDropPos({x:h.x-k.left,y:h.y-k.top},{x:0,y:0,width:f[0].offsetWidth,height:f[0].offsetHeight}),f=e.getData(),p=a.isDropAllowed(f.source,n,k),q={event:b,sourceTree:f.sourceCtrl?f.sourceCtrl.getCtrlName():"",dragItem:f.source,targetTree:a.getCtrlName(),targetItem:n,isDropAllowed:p,dropPos:k,
mousePos:h},q=a.callDragOver(q);t=l[0].getBoundingClientRect();c=h.x-t.left;t=h.y-t.top;z.css("top",t-16+"px");z.css("left",c+"px");z.css("display","block");if(p&&0!=q){c=h;h=c.y+Z.y+16;Z=c.x+Z.x+20;c=a.getDropMarkWindow();c.empty();t="iui-drop-marker-move-in";switch(k){case 1:t="iui-drop-marker-move-up";break;case 2:t="iui-drop-marker-move-down"}c.append("<span class='"+t+"'></span><span class='iui-drop-marker-title'>"+n[a.options.dataFields.text]+"</span>");a.updateDropMarkElem(a.getDropMarkWindow(),
{top:h,left:Z});a.dropMark(p);e.setData({source:f.source,sourceList:f.sourceList,target:n,dropPos:k})}else a.dropMark()}}else n=e.getData(),f={source:n.source,sourceCtrl:n.sourceCtrl,target:null,dropPos:-1},e.setData(f),q={event:b,sourceTree:n.sourceCtrl?n.sourceCtrl.getCtrlName():"",dragItem:n.source,targetTree:a.getCtrlName(),targetItem:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:h},t=l[0].getBoundingClientRect(),c=h.x-t.left,t=h.y-t.top,z.css("top",t-16+"px"),z.css("left",c+"px"),
q=a.callDragOver(q),0==q?a.dropMark():(c=h,h=c.y+16,Z=c.x+20,c=a.getDropMarkWindow(),c.empty(),c.append("<span class='iui-drop-marker-move-end'></span><span class='iui-drop-marker-title'>"+(g.name?g.name:"TreeView")+"</span>"),a.updateDropMarkElem(a.getDropMarkWindow(),{top:h,left:Z}),a.dropMark(!0))}b.stopPropagation()}}else b.preventDefault(),a.dropMark(),a.cancelScrollTimer(),z&&z.css("display","none")}});b.bind("touchend",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c)){c=
!1;if((c=a.getTouchData(b))&&0<c.length){var c=oa({x:c[0].pageX,y:c[0].pageY}),d=l[0].getBoundingClientRect();if(e.hitTest(c.x,c.y,d))if(m){angular.element(this);b.preventDefault();pa();a.dropMark();ka();if((c=a.getTouchData(b))&&0<c.length){var d=oa({x:c[0].pageX,y:c[0].pageY}),t=a.getItemAt(d.x,d.y);if(t){var c=e.getData(),n=c.source,f=a.isDropAllowed(n,t,c.dropPos);f&&n&&(d={event:b,sourceTree:c.sourceCtrl?c.sourceCtrl.getCtrlName():"",dragItem:n,targetTree:a.getCtrlName(),targetItem:t,isDropAllowed:f,
dropPos:c.dropPos,mousePos:d},d=a.callDragDrop(d),!1!==d&&(a.drop(c),g.$$phase||g.$apply()))}else c=e.getData(),c.source&&(d={event:b,sourceTree:c.sourceCtrl?c.sourceCtrl.getCtrlName():"",dragItem:c.source,targetTree:a.getCtrlName(),targetItem:null,isDropAllowed:a.options.allowDrop,dropPos:-1,mousePos:d},d=a.callDragDrop(d),!1!==d&&(a.drop(c),g.$$phase||g.$apply())),e.clearData()}e.clearData();a.dragDropStatus(!1);b.stopPropagation()}else a.mouseButtonStatus(!1),(c=a.getItemAt(c.x,c.y))&&a.updateSelection(b,
c),Oa()}c=m;a.removeDropMark();ka();r={x:0,y:0};m=!1;W=null;c&&b.stopPropagation()}});b.bind("dblclick",function(b){b.preventDefault();if(1===b.which){var c=a.getItemFromChildElem(this);if(c){var d="dblclick"==a.options.editorSettings.activate;d&&za(b,angular.element(this),0);0==a.callItemDblClick(c,a.getMousePos(b))||d||a.toggle(c)}}b.stopPropagation()});b.bind("mouseenter",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&(angular.element(this),a.hoverItem=c,a.refresh(c),a.callItemHover(c),
a.options.hoverSelection&&(ja=k(function(){ja&&a.itemSelection(b,c)},500)))});b.bind("mouseleave",function(b){a.hoverItem=null;(b=a.getItemFromChildElem(this))&&a.isItemEnabled(b)&&a.refresh(b);ja&&(k.cancel(ja),ja=null)});var c=function(b,c){b.preventDefault();focusDelayTime=0;var d=a.getItemCurrentIndex(c),t=F+aa-2,t=t<a.currentList.length-1?t:a.currentList.length-1;d===t&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+Math.floor(l[0].clientHeight/4)}),focusDelayTime=1);var n=a.getNextItem(d);
if(n){a.itemSelection(b,n);g.$apply();var e=k(function(){a.updateFocus(n);k.cancel(e)},focusDelayTime)}},n=function(b,c){b.preventDefault();focusDelayTime=0;var d=a.getItemCurrentIndex(c),t=F;d===(0<t?t:0)&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-Math.floor(l[0].clientHeight/4)}),focusDelayTime=1);var n=a.getPrevItem(a.getItemCurrentIndex(c));if(n){a.itemSelection(b,n);g.$apply();var e=k(function(){a.updateFocus(n);k.cancel(e)},focusDelayTime)}};b.bind("keydown",function(d){var e=a.getItemFromChildElem(this);
if(e&&a.isItemEnabled(e)){a.callKeyDown(d,e);var f=0;switch(d.keyCode){case 9:f=a.currentList.length;0<f&&(d.shiftKey?h.isEqual(e[a.options.dataFields.id],a.currentList[0][a.options.dataFields.id])||n(d,e):h.isEqual(e[a.options.dataFields.id],a.currentList[f-1][a.options.dataFields.id])||c(d,e));break;case 13:za(d,b,0);break;case 16:a.updateSelectionStatus(d,"shift");break;case 17:a.updateSelectionStatus(d,"ctrl");break;case 33:d.preventDefault();f=a.getItemCurrentIndex(e);e=f-aa;e=0<e?e:0;if(e!==
f){var f=1,l=a.getPrevItem(e+1);if(l){a.scrollTo(l);a.itemSelection(d,l);g.$apply();var m=k(function(){a.updateFocus(l);k.cancel(m)},f)}}break;case 34:d.preventDefault();f=a.getItemCurrentIndex(e);e=f+aa;e=e<a.currentList.length-1?e:a.currentList.length-1;e!==f&&(f=1,l=a.getNextItem(e-1))&&(a.scrollTo(l,"bottom"),a.itemSelection(d,l),g.$apply(),m=k(function(){a.updateFocus(l);k.cancel(m)},f));break;case 35:d.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:C.y});var p=a.getLastItem();p&&(a.itemSelection(d,
p),m=k(function(){a.updateFocus(p);k.cancel(m)},1));break;case 36:d.preventDefault();a.setScrollPos({x:a.scrollPos.x,y:0});var q=a.getFirstItem();q&&(a.itemSelection(d,q),m=k(function(){a.updateFocus(q);k.cancel(m)},1));break;case 37:d.preventDefault();e[a.options.dataFields.items]&&0<e[a.options.dataFields.items].length&&(a.toggle(e,!1),a.updateFocus(e));break;case 32:d.preventDefault();a.itemSelection(d,e,e.selected);g.$apply();break;case 38:n(d,e);break;case 39:d.preventDefault();e[a.options.dataFields.items]&&
0<e[a.options.dataFields.items].length&&(a.toggle(e,!0),a.updateFocus(e));break;case 40:c(d,e);break;default:(d.ctrlKey||d.metaKey)&&a.updateSelectionStatus(d,"ctrl"),d.shiftKey&&a.updateSelectionStatus(d,"shift")}}});b.bind("keyup",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c)){switch(b.keyCode){case 16:a.multiSelection(!1);a.shiftKeyStatus(!1);break;case 17:a.multiSelection(!1);break;default:b.ctrlKey||b.metaKey||a.multiSelection(!1),b.shiftKey||(a.multiSelection(!1),a.shiftKeyStatus(!1))}a.callKeyUp(b,
c)}});b.bind("keypress",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&a.callKeyPress(b,c)});b.bind("click",function(b){if(1===b.which){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&a.callItemClick(b,c,a.getMousePos(b))}b.stopPropagation()});b.bind("mousedown",function(b){var c=a.getItemFromChildElem(this);if(c&&a.isItemEnabled(c)){a.mouseButtonStatus(!0);a.itemSelection(b,c);switch(b.which){case 1:a.changeCheckValue(c);"click"==a.options.editorSettings.activate&&
za(b,angular.element(this));break;case 3:a.callItemRightClick(c,a.getMousePos(b))}b.stopPropagation()}});b.bind("mouseup",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&(a.mouseButtonStatus(!1),a.updateSelection(b,c),1===b.which&&Oa())});b.bind("focus",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&a.callGotFocus(b,c)});b.bind("blur",function(b){var c=a.getItemFromChildElem(this);c&&a.isItemEnabled(c)&&a.callLostFocus(b,c)})}};a.openEditor=function(b){if(b){var c=
a.getElemFromItem(b);c&&0!=b[a.options.dataFields.allowEdit]&&(b=a.getElement(c))&&za(null,b,0)}};a.closeEditor=function(b){b?(b=a.getElemFromItem(b))&&(b=a.getElement(b))&&ra(null,b,!1):ra(null,null,!1)};var za=function(b,c,d){a.options.labelEdit&&(void 0===d&&(d=500),S=k(function(){if(S)var a=k(function(){ra(b,c,!0);k.cancel(a)},d);k.cancel(S)},d/3))},Oa=function(){S&&(k.cancel(S),S=null)},sa=null,ra=function(b,c,d){if(a.dragDropStatus())d=u[0].value,a.labelEditStatus(!1),u.unbind("blur focus keydown mousedown"),
u.remove(),sa=null;else{var e=a.getItemFromChildElem(c);if(e)if(d){if(d="",0!=a.callBeforeLabelEdit(e)){sa=e;a.labelEditStatus(!0);u.unbind("blur focus keydown mousedown");l.append(u);e[a.options.dataFields.text]&&""!=e[a.options.dataFields.text]||(b=h.getMargin(c[0].parentElement),d=h.getPadding(c[0]),c.css("height",H-(b.top+b.bottom+2)-(d.top+d.bottom)+"px"));b=c[0].offsetHeight-4;d=c[0].offsetTop;var f=a.scrollPos.x+c[0].offsetLeft,g=l[0].clientWidth-c[0].offsetLeft-6;A&&(g-=16);a.updateEditBox({top:d,
left:f,width:g,height:b});u[0].value=e[a.options.dataFields.text];u.bind("keydown",function(b){switch(b.keyCode){case 13:e[a.options.dataFields.text]=u[0].value?u[0].value:"null";ra(b,c,!1);break;case 27:ra(b,c,!1)}b.stopPropagation()});u.bind("focus",function(b){var c=angular.element(this);a.callGotFocus(b,sa,!0,c[0].value)});u.bind("blur",function(a){ra(a)});u.bind("mousedown",function(a){a.stopPropagation()});var m=k(function(){u[0].focus();u[0].select();k.cancel(m)},10)}}else d=u[0].value,a.labelEditStatus(!1),
u.unbind("blur focus keydown mousedown"),u.remove(),a.updateView(),a.updateFocus(e),a.callAfterLabelEdit(e),a.callLostFocus(b,e,!0,d),sa=null;else d=u[0].value,a.labelEditStatus(!1),u.unbind("blur focus keydown mousedown"),u.remove(),a.callAfterLabelEdit(),a.updateView(),a.callLostFocus(b,sa,!0,d),sa=null}},gb=function(b){var c="";b[a.options.dataFields.icon]?c=b[a.options.dataFields.icon]:a.options.itemIcon&&(c=a.options.itemIcon);return c},hb=function(b){return b="iui-treeview-status-icon "+b[a.options.dataFields.statusIcon]},
ib=function(b){return b?b[a.options.dataFields.icon]||a.options.itemIcon:!1},F=0,p=null,y=100,H=0,U=0,aa=0,M=0,ba=0,Ra=!1,Da=!1,Ea=9,Fa=9,Sa=0,ca=0,la=0,Ga=1,Ta=0,Ha=0,da=0,ta=0,Ua=1,G=null,I=null,D=!1,A=!1;this.scrollMousePos=null;var C={x:0,y:0},Ha=0;g.verScrollVisibility=!1;g.$watch("verScrollVisibility",function(b,c){b!=c&&a.updateCurrentLayout()});a.updateViewSize=function(){var b=k(function(){U=0;A=D=!1;a.getTemplateUrl()||a.updateLongestItem();if(!a.getTemplateUrl()&&a.longestItem&&0<a.currentList.length){var c=
a.getItemCurrentIndex(a.longestItem),c=angular.element(vb(c,!0));l.append(c);U=c[0].offsetWidth;var d=l[0].offsetWidth-6;A&&w&&(d-=w[0].offsetWidth);U>d&&(q.unbind("click mousedown"),l.append(q),q.bind("click",function(a){a.stopPropagation()}),q.bind("mousedown",function(b){b=h.getClientMousePos(b,this);var c=Math.floor(l[0].clientWidth);G&&(b.x<G[0].offsetLeft?a.setScrollPos({x:a.scrollPos.x-c,y:a.scrollPos.y}):b.x>G[0].offsetLeft+G[0].offsetWidth&&a.setScrollPos({x:a.scrollPos.x+c,y:a.scrollPos.y}))}),
G=angular.element(q.children().eq(0)),D=!0,G.bind("mousedown",function(b){1===b.which&&(v.scrollMousePos=a.getMousePos(b),Ra=!0);b.stopPropagation()}));c.remove()}g.verScrollVisibility=!1;0<a.currentList.length&&(c=l[0].offsetHeight-6,D&&q&&(c-=q[0].offsetHeight),d=(ua.top+ua.bottom)/2,y=0<H?Math.floor(c/(H+d))+1:100,y<a.currentList.length+1&&(w.unbind("click mousedown"),l.append(w),w.bind("click",function(a){a.stopPropagation()}),w.bind("mousedown",function(b){b=h.getClientMousePos(b,this);var c=
Math.floor(l[0].clientHeight);I&&(b.y<I[0].offsetTop?(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y-c}),Qa(!1,c)):b.y>I[0].offsetTop+I[0].offsetHeight&&(a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+c}),Qa(!0,c)))}),I=angular.element(w.children().eq(0)),A=!0,I.bind("mousedown",function(b){1===b.which&&(v.scrollMousePos=a.getMousePos(b),Da=!0);b.stopPropagation()})));D||(q.unbind("mousedown"),q.remove(),C.x=0);A||(w.unbind("mousedown"),w.remove(),C.y=0);D&&A?l.append(L):L.remove();k.cancel(b);
!D&&0<a.scrollPos.x&&a.setScrollPos({x:0,y:a.scrollPos.y});!A&&0<a.scrollPos.y&&a.setScrollPos({x:a.scrollPos.x,y:0})},1)};a.updateScrollView=function(){jb()};var jb=function(){var b=k(function(){M=l[0].offsetWidth-6;ba=l[0].offsetHeight-6;ba=D?ba-q[0].offsetHeight:ba-4;M=A?M-w[0].offsetWidth:M-4;M<U?x.css("width",U+"px"):x.css("width",M+"px");x.css("height",ba+"px");D&&(q.css("bottom","0px"),A||(M+=3),q.css("width",M+1+"px"));A&&(w.css("top","0px"),D||(ba+=3),w.css("height",ba+1+"px"));D&&A&&L.css("bottom",
"0px");!1!==a.options.rtl?(x.css("left","auto"),x.css("right","-"+(a.scrollPos.x-2).toString()+"px"),D&&(q.css("left","auto"),q.css("right","0px")),A&&(w.css("left","0px"),w.css("right","auto")),D&&A&&(L.css("left","0px"),L.css("right","auto"))):(x.css("left","-"+(a.scrollPos.x-2).toString()+"px"),x.css("right","auto"),D&&(q.css("left","0px"),q.css("right","auto")),A&&(w.css("left","auto"),w.css("right","0px")),D&&A&&(L.css("left","auto"),L.css("right","0px")));var c=k(function(){D&&M<U&&(Sa=0,ca=
2,la=q[0].clientWidth-4,la>ca&&(Sa=la-ca),Ea=Math.floor(Sa*(M-4)/U),9>Ea&&(Ea=9),G.css("width",Ea+"px"),C.x=U-M,0>C.x&&(C.x=0),Ga=C.x/(Sa-Ea-2));var b=a.currentList.length+1;A&&0<a.currentList.length&&y<b&&(da=2,ta=w[0].clientHeight-4,Ta=0,ta>da&&(Ta=ta-da),Fa=Math.floor(Ta*y/b),9>Fa&&(Fa=9),I.css("height",Fa+"px"),Ua=(b-y+1)/(Ta-Fa-2),C.y=Math.floor((b-y+1)*H),0>C.y&&(C.y=0),0==F?I.css("top",da+"px"):F+y-1==a.currentList.length&&I.css("top",ta-I[0].offsetHeight+"px"));k.cancel(c)},1);k.cancel(b)},
5)},kb=5,Va=0,ma=0,Wa=0,lb=0,na=!1,Xa=!1,va="none",Ia="normal",Ja=0,cb=null,O=!1,ea=!1,fa=angular.element('<ul class="iui-treeview-block" style="position:absolute;top:-9999999px"></ul>');a.updateActive=!1;a.updateStatus=0;var mb=function(b){var c=f(function(){b?ma++:ma--;Wa=(l[0].clientHeight-ma)/2+2;Ka.css("height",ma+"px");V.css("top",Wa+"px");b&&ma>=kb?(O=!0,ga(0),ea=na=!1,f.cancel(c)):!b&&0>=ma&&(V&&V.remove(),wa=0,ea=!0,a.callLoadComplete(),f.cancel(c))},20)},nb=function(){cb&&f.cancel(cb);Q&&
Q.remove()};a.beginLoad=function(a){if(!na)switch(na=!0,a?(va=void 0!=a.type?a.type:"none",Ia=void 0!=a.speed?a.speed:"normal",Ja=void 0!=a.opacity?a.opacity:0):(va="none",Ia="normal",Ja=0),db(Ja),va){case "circular":nb();l.append(Q);Q.css("top",(l[0].clientHeight-Q[0].offsetHeight)/2+"px");Q.css("left",(l[0].clientWidth-Q[0].offsetWidth)/2+"px");O=!0;ea=na=!1;var b=0,c=3;switch(Ia){case "veryfast":c=7;break;case "fast":c=5;break;case "slow":c=2;break;case "veryslow":c=1}cb=f(function(){b+=c;360<
b&&(b=0);var a="rotate("+b+"deg)";Q.css("-ms-transform",a);Q.css("-webkit-transform",a);Q.css("transform",a)},1);break;case "linear":a=angular.element('<div class="iui-load-block-progress" style="position:absolute;left:-9999px"></div>');l.append(a);kb=parseInt(getComputedStyle(a[0]).height,10);a.remove();Ka.css("width","0px");Ka.css("height","0px");l.append(V);wa=0;Va=Math.floor(.5*l[0].clientWidth);ma=0;Wa=l[0].clientHeight/2+2;lb=(l[0].clientWidth-Va)/2;V.css("width",Va+"px");V.css("top",Wa+"px");
V.css("left",lb+"px");V.css("opacity","1");mb(!0);break;default:O=!0,ea=na=!1}};a.endLoad=function(b){if(!Xa)if(Xa=!0,b=a.options.loadItems.indexOf(b),0<=b&&a.options.loadItems.splice(b,1),O){O=!1;var c=3,d=Ja,e=f(function(){ea&&(10<c||1<=d?(db(1),Xa=na=ea=!1,va="none",Ia="normal",Ja=void 0,f.cancel(e)):(d+=c/10,db(d),c+=3))},1)}else Xa=!1};var db=function(a){x&&x.css("opacity",a);q&&q.css("opacity",a);w&&w.css("opacity",a);L&&L.css("opacity",a)},Ka=angular.element('<div class="iui-load-block-progress"></div>'),
V=angular.element('<div class="iui-load-block"></div>');V.append(Ka);var wa=0,xa=!1,Q=angular.element('<div class="iui-load-circular"></div>'),ga=function(a){if(O&&"linear"==va){xa=!1;var b=Math.floor(Va*a/100),c=wa;a=10;switch(Ia){case "veryfast":a=2;break;case "fast":a=5;break;case "slow":a=15;break;case "veryslow":a=20}var d=b>c?Math.floor((b-c)/a):1,d=0<d?d:1,e=f(function(){c+=d;Ka.css("width",c+"px");c>=b&&(wa=b,xa=!0,f.cancel(e))},1)}else xa=!0},ua={top:0,bottom:0},wb=function(){H=0;ua={top:0,
bottom:0};if(0<a.currentList.length&&p){for(var b=[],d=[],e=0,f=0;f<a.currentList.length&&10>f;f++)b.push(ob(f,!0)),d.push(c(b[f])(p)),l.append(d[f]),e++;if(0<e)var g=k(function(){var a=0;ua=h.getMargin(d[0][0]);for(var b=0;b<e;b++)a+=d[b][0].offsetHeight,d[b].remove();H=Math.floor(a/e);k.cancel(g)},1)}},xb=function(){l.append(fa);var b=k(function(){if(0<a.currentList.length){p=g.$new();p.data=pb();p.checkBoxStyle=a.options.checkBoxSettings.style;!p.checkBoxStyle&&a.options.controlStyle.item.checkBox&&
(p.checkBoxStyle=a.options.controlStyle.item.checkBox);a.refresh();p.$apply();wb();var d=k(function(){var a=l[0].offsetHeight-6;D&&q&&(a-=q[0].offsetHeight);var b=(ua.top+ua.bottom)/2;y=0<H?Math.floor(a/(H+b))+1:100;aa=0;a="";for(b=0;b<y;b++)a+=ob(b),aa++;0<aa&&fa.append(c(a)(p));ga(70);R("scroll");k.cancel(d)},1)}else ga(70),R("scroll");k.cancel(b)},1)},R=function(b){if(xa&&!na)switch(b){case "start":a.updateCurrentList();yb();ga(10);R("init");break;case "init":fa&&fa.remove();Ra||Da||jb();X();p&&
p.$destroy();a.currentList.length>=y&&F+y-1>a.currentList.length&&(F=a.currentList.length-y+1);ga(20);R("items");break;case "items":xb();break;case "scroll":a.updateViewSize();a.updateViewSize();a.updateScrollView();ga(80,"complete");R("complete");break;case "complete":ga(90);R("events");break;case "events":fa&&(x.empty(),x.append(fa.children()));a.allowEvents=!0;0<a.currentList.length&&Y();ga(100);R("end");break;case "end":fa&&fa.remove();a.callUpdateComplete();switch(va){case "circular":nb();wa=
0;ea=!0;a.callLoadComplete();break;case "linear":mb(!1);break;default:wa=0,ea=!0,a.callLoadComplete()}a.updateActive=!1;a.updateStatus--;0<a.updateStatus&&(xa=a.updateActive=!0,R("start"))}else k(function(){R(b)},1)};a.updateCurrentLayout=function(){if(a.allowUpdate)if(0==a.currentList.length)a.updateLayout();else{a.updateCurrentList();a.updateView();var b=k(function(){a.updateViewSize();a.updateViewSize();a.updateScrollView();k.cancel(b)},1)}};a.updateLayout=function(b){b=!0;for(var c=l.parent();"body"!=
c[0].tagName.toLowerCase();){if("none"==getComputedStyle(c[0]).display){b=!1;break}c=c.parent()}if(b&&a.allowUpdate&&(a.updateStatus++,!a.updateActive)){a.updateActive=!0;l.removeClass("iui-treeview-block-rtl");a.options.rtl&&l.addClass("iui-treeview-block-rtl");x.removeClass("iui-treeview-block-shift-left iui-treeview-block-rtl");x.addClass(Aa());a.allowEvents=!1;H=U=0;y=100;if(a.options.showCheckBoxes)for(a.updateCheckValues(),b=a.getFullList(),c=0;c<b.length;c++)a.setDefaultCheckValue(b[c]);xa=
!0;R("start")}};g.$watch(function(){return l[0].offsetWidth},function(b,c){100==y?a.updateLayout():b!=c&&a.updateCurrentLayout()});var Ya=null;g.$watch(function(){return l[0].offsetHeight},function(b,c){b!=c&&(Ya=k(function(){Ya&&(a.updateLayout(),k.cancel(Ya),Ya=null)},1E3))});g.onCheckValueChanging=function(b,c){var d=!1,e=c+F;if(a.isIndexInRange(e)){if((d=a.currentList[e])&&0==d[a.options.dataFields.allowEdit])return!1;d=a.callCheckValueChanging(a.currentList[e],a.options.checkBoxSettings&&1==
a.options.checkBoxSettings.threeState?b.checkState:b.checked)}return d};g.onCheckValueChanged=function(b,c){var d=c+F;a.isIndexInRange(d)&&(a.callCheckValueChanged(a.currentList[d],a.options.checkBoxSettings&&1==a.options.checkBoxSettings.threeState?b.checkState:b.checked),a.fillCheckList(a.currentList[d]))};a.setDefaultCheckValue=function(b){a.options.checkBoxSettings&&1==a.options.checkBoxSettings.threeState?void 0==b[a.options.dataFields.checkState]&&(b[a.options.dataFields.checkState]="unchecked"):
void 0==b[a.options.dataFields.checked]&&(b[a.options.dataFields.checked]=!1)};var vb=function(b,c){var d=a.currentList[b],e=a.defaultStyle.item.general.normal,f=a.getCurrentItemStyle(d,a.getObjState(d)),d='<li class="'+e;f!=e&&(d+=" "+f);d+='" ';d=c?d+('style="position:absolute;top:-9999px;padding-left:'+a.indentList[b]+'px"'):d+('data-index="'+b+'"');!c&&0<a.indentList[b]&&(d=a.options.rtl?d+(' style="padding-right:'+a.indentList[b]+'px"'):d+(' style="padding-left:'+a.indentList[b]+'px"'));d+=">";
!1!==a.options.showStatusIcons&&(d+='<span class="'+hb(a.currentList[b])+'" data-element="statusicon"></span>');d+='<span class="'+N(a.currentList[b])+'" data-element="expandbox"></span>';1==a.options.showCheckBoxes&&(d+='<iui-checkbox name="cb-'+h.getUniqueId(4)+'"',e=a.options.checkBoxSettings?1==a.options.checkBoxSettings.threeState:!1,f=a.currentList[b],e&&void 0==f[a.options.dataFields.checkState]?f[a.options.dataFields.checkState]="unchecked":void 0==f[a.options.dataFields.checked]&&(f[a.options.dataFields.checked]=
!1),e?(d+=' check-state="data['+b+"]."+a.options.dataFields.checkState+'"',d=d+(' checkstate-changing="onCheckValueChanging(e, '+b+')"')+(' checkstate-changed="onCheckValueChanged(e, '+b+')"'),d+=' three-state="true"'):(d+=' checked="data['+b+"]."+a.options.dataFields.checked+'"',d+=' checked-changing="onCheckValueChanging(e, '+b+')"',d+=' checked-changed="onCheckValueChanged(e, '+b+')"'),p&&(a.options.checkBoxSettings&&a.options.checkBoxSettings.style&&p.checkBoxStyle?d+=' control-style="checkBoxStyle"':
a.options.controlStyle.item.checkBox&&p.checkBoxStyle&&(d+=' control-style="checkBoxStyle"')),a.isItemEnabled(a.currentList[b])||(d+=' enabled="false"'),d+=' style="display:inline-block;margin:0 2px;padding-bottom:2px;vertical-align:middle;',0<ya&&(d+="width: "+ya+"px;"),d+='"></iui-checkbox>');!1!==a.options.showIcons&&ib(a.currentList[b])&&(d+='<span class="'+gb(a.currentList[b])+'" data-element="icon"></span>');e=a.defaultStyle.item.content.normal;a.options.controlStyle.item.content.normal!=e&&
(e+=" "+a.options.controlStyle.item.content.normal);f=a.getCurrentItemContentStyle(a.currentList[b],"normal");a.currentList[b].content?(d+='<div class="'+e+" "+f+'" data-element="content">',d+=a.currentList[b][a.options.dataFields.content],d+="</div>"):(d+='<span class="'+e+" "+f+'" data-element="content"',!c&&a.currentList[b].contextMenu&&(d+=' iui-contextmenu menu-items="data['+b+'].contextMenu"'),d+=">",d=c?d+a.currentList[b][a.options.dataFields.text]:d+("{{data["+b+"]."+a.options.dataFields.text+
"}}"),d+="</span>");return d+="</li>"},ob=function(b,c){var d='<li iui-class="{{data['+b+'].style.general}}" data-index="{{data['+b+'].index}}"',d=c?d+(' iui-style="position:absolute;top:-9999px;padding-left:{{data['+b+'].indent}}px"'):a.options.rtl?d+(' iui-style="padding-right:{{data['+b+'].indent}}px"'):d+(' iui-style="padding-left:{{data['+b+'].indent}}px"'),d=d+(' iui-contextmenu menu-items="data['+b+"].item."+a.options.dataFields.contextMenu+'" menu-update="{{data['+b+'].updateContextMenu}}"'),
d=d+(' ng-show="data['+b+'].visible">');0!=a.options.showStatusIcons&&(d+='<span iui-class="{{data['+b+'].statusIcon}}" data-element="status-icon"></span>');a.getTemplateUrl()||(d+='<span iui-class="{{data['+b+'].expandBox}}" data-element="expandbox"></span>');1==a.options.showCheckBoxes&&(d+='<iui-checkbox name="cb-'+h.getUniqueId(4)+'"',a.options.checkBoxSettings&&1==a.options.checkBoxSettings.threeState?(d+=' check-state="data['+b+"].item."+a.options.dataFields.checkState+'"',d=d+(' checkstate-changing="onCheckValueChanging(e, '+
b+')"')+(' checkstate-changed="onCheckValueChanged(e, '+b+')"'),d+=' three-state="true"'):(d+=' checked="data['+b+"].item."+a.options.dataFields.checked+'"',d+=' checked-changing="onCheckValueChanging(e, '+b+')"',d+=' checked-changed="onCheckValueChanged(e, '+b+')"'),p&&(a.options.checkBoxSettings&&a.options.checkBoxSettings.style&&p.checkBoxStyle?d+=' control-style="checkBoxStyle"':a.options.controlStyle.item.checkBox&&p.checkBoxStyle&&(d+=' control-style="checkBoxStyle"')),d+=' enabled="data['+
b+"].item."+a.options.dataFields.enabled+'"',d+=' style="display:inline-block;margin:0 2px;padding-bottom:2px;',0<ya&&(d+="width: "+ya+"px;"),d+='" iui-show="{{data['+b+'].visible}}" show-default="true"></iui-checkbox>');a.getTemplateUrl()||0==a.options.showIcons||(d+='<span iui-class="{{data['+b+'].icon}}" data-element="icon"></span>');a.getTemplateUrl()?d+='<iui-item-content obj="data['+b+"].item."+a.options.dataFields.templateObj+'" template-url="{{data['+b+'].templateUrl}}" iui-show="{{data['+
b+'].templateVisible}}" draggable="{{data['+b+'].draggable}}" tabindex="{{data['+b+'].tabindex}}" data-element="template-content"></iui-item-content>':(d+='<span iui-class="{{data['+b+'].style.content}}" draggable="{{data['+b+'].draggable}}" tabindex="{{data['+b+'].tabindex}}" data-element="content">',d+="{{data["+b+"].item."+a.options.dataFields.text+"}}",d+="</span>");return d+="</li>"},ya=0,yb=function(){if(1==a.options.showCheckBoxes){var b=angular.element(c('<iui-checkbox style="position:absolute;top:-9999px"></iui-checkbox>')(g));
l.append(b);ya=0;b&&0<b.children().length&&(ya=parseInt(getComputedStyle(angular.element(b.children().eq(0))[0]).width,10));b.remove()}};a.getTemplateUrl=function(){return a.options.templateSettings?a.options.templateSettings.url:null};var zb=function(b,c,d){var e=d?N(b):"",f=d?a.isItemEnabled(b)&&a.isDragAllowed(b):!1,g=d?gb(b):"",h=d?0!=a.options.showIcons&&ib(b):!1,k=d?a.indentList[c]:0,l=d?hb(b):"",m=d?0!=a.options.showStatusIcons&&(b?b[a.options.dataFields.statusIcon]:!1):!1,p;p=d?1==a.options.allowFocus&&
a.isItemEnabled(a.currentList[c])?a.getTabIndex().toString()+(c+1).toString():"":"";var q=a.getTemplateUrl(),r;if(d){r=a.getTemplateUrl();var u=a.currentList[c];r=r&&""!=r&&void 0!=u[a.options.dataFields.templateObj]&&null!=u[a.options.dataFields.templateObj]?!0:!1}else r=!1;return{expandBox:e,draggable:f,icon:g,iconVisible:h,indent:k,index:c,item:d?b:{},statusIcon:l,statusIconVisible:m,style:{},tabindex:p,templateUrl:q,templateVisible:r,updateContextMenu:d?null!=b[a.options.dataFields.contextMenu]:
!1,visible:d}},pb=function(){for(var b=[],c=F;c<F+y;c++)b.push(zb(a.currentList[c],c,c<a.currentList.length));return b};a.getItemScope=function(){return p};var rb=function(){p&&(a.allowEvents=!1,qb(!1),p.data=pb(),a.options.selectedItem&&!a.isItemEnabled(a.options.selectedItem)&&(a.options.selectedItem[a.options.dataFields.selected]=!1,a.options.selectedItem=null,a.updateSelectionList()),a.refresh(null,null,!1),p.$apply(),a.allowEvents=!0)};a.updateView=function(a){if(a)rb();else var b=k(function(){rb();
k.cancel(b)},1)};a.refresh=function(b,c,d){if(b)switch(b.type){case "item":if(p&&(c=a.getItemCurrentIndex(b)-F,0<=c&&c<p.data.length&&p.data[c].visible)){c=p.data[c];var e=a.getObjState(b),f={content:"",general:"",label:""},g="",g=a.defaultStyle.item.general.normal;a.options.controlStyle.item.general.normal!=g&&(g+=" "+a.options.controlStyle.item.general.normal);f.general=g;g=a.defaultStyle.item.content.normal;a.options.controlStyle.item.content.normal!=g&&(g+=" "+a.options.controlStyle.item.content.normal);
f.content=g;g=a.getCurrentItemStyle(b,e);g!=a.options.controlStyle.item.general.normal&&(f.general+=" "+g);b=a.getCurrentItemContentStyle(b,e);b!=a.options.controlStyle.item.content.normal&&(f.content+=" "+b);c.style=f;void 0==d&&p&&p.$apply()}}else{for(b=F;b<F+y;b++)b<a.currentList.length?a.refresh(a.currentList[b],null,!1):p&&(c=b-F,0<=c&&c<p.data.length&&p.data[c].visible&&(p.data[c].style=a.defaultStyle.item.general.normal));1==d&&p&&p.$apply()}};a.moveItem=function(b,c,d,e){if(b){a.allowUpdate=
!1;var f=-1;switch(d){case "first":f=0;break;case "at":f=e}if(Array.isArray(b)){e=[];for(var g=0;g<b.length;g++){for(var h=!1,k=a.getParent(b[g]);k;){if(0<=b.indexOf(k)){h=!0;break}k=a.getParent(k)}h||e.push(b[g])}if(0<e.length)if(b=a.getObjCurrentIndex(e[0]),g=a.getObjCurrentIndex(e[e.length-1]),b<=g)for(g=0;g<e.length;g++)eb(e[g],c,f,d);else for(g=e.length-1;0<=g;g--)eb(e[g],c,f,d)}else eb(b,c,f,d);a.allowUpdate=!0;a.updateCurrentLayout();a.callChange()}};var eb=function(b,c,d,e){a.dataObj.removeAt(b,
-1,null,a.objIsRemoved)&&("first"==e||"last"==e||"at"==e?a.dataObj.insertAt(b,d,c,a.itemIsAdded):"before"==e?a.dataObj.insertByRef(b,c,!1,a.itemIsAdded):"after"==e&&a.dataObj.insertByRef(b,c,!0,a.itemIsAdded))},Ca=!1,ha=0,Za=null,$a=.5;a.isScrollBarVisible=function(a){switch(a){case "horizontal":return D;case "vertical":return A}return D&&A};a.prevScrollPos={x:0,y:0};a.scrollPos={x:0,y:0};a.getScrollPos=function(){return a.scrollPos};a.setScrollPos=function(b,c){if(!O&&b){var d=!0;0>b.x&&(b.x=0,d=
!1);b.x>C.x&&(b.x=C.x,d=!1);0>b.y&&(b.y=0,d=!1);b.y>C.y&&(b.y=C.y,d=!1);a.scrollPos=b;Ha=Math.floor(a.scrollPos.y/(H*Ua));var e=0,f=da+Ha;D&&G&&(e=!1!==a.options.rtl?Math.floor(a.scrollPos.x/Ga)-(la-G[0].offsetWidth-ca):Math.floor(a.scrollPos.x/Ga)+ca,G.css("left",e+"px"));A&&I&&I.css("top",f+"px");sb();qb(!0,c);d&&a.callScrollPosChanged()}};var fb=function(a){return 0<a.x&&a.x<C.x||0<a.y&&a.y<C.y},Qa=function(b,c,d){Ca||(ha=0,Ca=!0,Za=f(function(){var d=c,e=a.getScrollPos();d||(0===ha&&(ha=5),ha+=
5+Ua,$a+=.5,d=ha+=Math.floor($a));e.y=b?e.y+d:e.y-d;a.setScrollPos(e);(0>=e.y||a.getScrollPos().y<e.y)&&qa()},d?d:100))},qa=function(){Ca&&(Za&&(f.cancel(Za),Za=null),Ca=!1,ha=0,$a=.5)};a.cancelScrollTimer=function(){qa()};a.scrollTo=function(b,c){if(b){var d=a.getItemCurrentIndex(b);if(a.isIndexInRange(d)){var e=0,f=d;switch(c){case "center":e=Math.floor(aa/2);f=d>e?d-e:0;break;case "bottom":e=aa-2,f=d>e?d-e:0}var g=k(function(){a.setScrollPos({x:a.scrollPos.x,y:f*H});k.cancel(g)},1)}}};var sb=function(){if(x){var b=
a.scrollPos.x;0>b&&(b=0);b>C.x&&(b=C.x);b=2-b;!1!==a.options.rtl?x.css("right",b+"px"):x.css("left",b+"px")}},qb=function(b,c){if(!(0==b&&0>=H)){newIndex=0<H?Math.floor(a.scrollPos.y/H):0;a.scrollPos.y==C.y&&newIndex--;if(a.currentList.length>=y&&newIndex+y-1>a.currentList.length){newIndex=a.currentList.length-y+1;var d=x.find("li");d&&0<d.length&&(d=angular.element(d[d.length-1]),d[0].offsetTop+d[0].offsetHeight>l[0].clientHeight&&newIndex++)}0>newIndex&&(newIndex=0);newIndex!==F&&(F=newIndex,0!=
b&&a.updateView(c))}};l.bind("scroll",function(a){l[0].scrollTop=0;l[0].scrollLeft=0});var tb=function(b,c){if(A){document.activeElement&&document.activeElement.blur();var d=a.hoverItem;a.hoverItem=null;a.refresh(d);d=Math.floor(l[0].clientHeight/4);a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y};a.setScrollPos({x:a.scrollPos.x,y:a.scrollPos.y+d*c*-1});fb(a.scrollPos)||a.scrollPos.y==a.prevScrollPos.y||a.callScrollPosChanged()}};l.bind("mousewheel",function(a){a.preventDefault();if(!O){var b=0;
a.wheelDelta?b=Math.max(-1,Math.min(1,a.wheelDelta||-a.detail)):a.originalEvent&&(b=Math.max(-1,Math.min(1,a.originalEvent.wheelDelta||-a.originalEvent.detail)));tb(a,b)}});l.bind("DOMMouseScroll",function(a){a.preventDefault();if(!O){var b=0;a.detail?b=Math.max(-1,Math.min(1,-a.detail)):a.originalEvent&&(b=Math.max(-1,Math.min(1,-a.originalEvent.detail)));tb(a,b)}});angular.element(J).bind("dragover",function(a){qa()});angular.element(J).bind("dragend",function(b){a.dragDropStatus(!1)});angular.element(J).bind("mousemove",
function(b){if(Ra){if(!O&&1===b.which){G[0].getBoundingClientRect();b=a.getMousePos(b);v.scrollMousePos||(v.scrollMousePos=b);var c=G[0].offsetLeft+(b.x-v.scrollMousePos.x);c<ca?c=ca:c+G[0].offsetWidth>la&&(c=la-G[0].offsetWidth);G.css("left",c+"px");v.scrollMousePos=b;a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y};a.scrollPos.x=!1!==a.options.rtl?parseInt((la-G[0].offsetLeft-G[0].offsetWidth)*Ga,10):parseInt((G[0].offsetLeft-ca)*Ga,10);sb();(fb(a.scrollPos)||a.scrollPos.x!=a.prevScrollPos.x)&&
a.callScrollPosChanged()}}else Da&&(O||1!==b.which||(I[0].getBoundingClientRect(),b=a.getMousePos(b),v.scrollMousePos||(v.scrollMousePos=b),c=I[0].offsetTop+(b.y-v.scrollMousePos.y),c<da?c=da:c+I[0].offsetHeight>ta&&(c=ta-I[0].offsetHeight),I.css("top",c+"px"),v.scrollMousePos=b,Ha=c-da,a.prevScrollPos={x:a.scrollPos.x,y:a.scrollPos.y},a.scrollPos.y=Math.floor(Ha*Ua*H),(fb(a.scrollPos)||a.scrollPos.y!=a.prevScrollPos.y)&&a.callScrollPosChanged(),newIndex=0<H?Math.floor(a.scrollPos.y/H):0,newIndex+
y-1>=a.currentList.length&&(newIndex=a.currentList.length-y+1,newIndex+=5),0>newIndex&&(newIndex=0),newIndex!==F&&(F=newIndex,a.updateView(!0))))});angular.element(J).bind("mouseup",function(b){a.dropMark();Da&&a.updateView();qa();v.scrollMousePos=null;Da=Ra=!1});var La={x:0,y:0},ia={x:0,y:0};l.bind("touchstart",function(b){b.preventDefault();(b=a.getTouchData(b))&&0<b.length&&(La={x:b[0].pageX,y:b[0].pageY})});l.bind("touchend",function(b){(b=a.getTouchData(b))&&0<b.length&&(ia={x:b[0].pageX,y:b[0].pageY});
var c=ia.x-La.x,d=ia.y-La.y;(20<Math.abs(c)||20<Math.abs(d))&&document.activeElement&&document.activeElement.blur();var e=!1,g=!1,h=La,k=f(function(){var b=a.scrollPos;-20>c?(h.x-=10,h.x>ia.x?b.x+=10:(b.x-=c,e=!0)):20<c?(h.x+=10,h.x<ia.x?b.x-=10:(b.x-=c,e=!0)):e=!0;-20>d?(h.y-=10,h.y>ia.y?b.y+=10:(b.y-=d,g=!0)):20<d?(h.y+=10,h.y<ia.y?b.y-=10:(b.y-=d,g=!0)):g=!0;a.setScrollPos(b);e&&g&&f.cancel(k)},10);La=ia});v=this;this.crpar=function(){return["si","tri","ver","on","al "]};this.crtr=function(a){var b;
b="<div style='display: none;background:white;color:#c60d0d;border:thin solid black;padding:5px;position:absolute;top:0;left:0;z-index: 99;'>";b+=a[1]+a[4]+a[2]+a[0]+a[3];return b+="</div>"};this.tpar=this.crpar();this.$tw=angular.element(this.crtr(v.tpar));this.tmp=300;this.twp=200*tmp;this.trActive=!1;this.trCount=0;this.trlTime=this.trId=null;this.trShowCount=0;this.animTr=function(){this.trCount++;3>this.trShowCount?(this.trCount=1,this.$tw.css("display","block"),this.$tw.css("top",l[0].scrollTop+
"px"),this.$tw.css("left",l[0].scrollLeft+"px"),this.trShowCount++):(0===this.trCount%49&&(this.trShowCount=0),this.$tw.css("display","none"),this.$tw.css("top",l[0].scrollTop+"px"),this.$tw.css("left",l[0].scrollLeft+"px"))};this.s1t=function(a){this.trlTime=k(function(){v.trActive||(v.trCount=0,v.trActive=!0,v.trId=f(function(){v.animTr()},1E3))},a)};this.s2t=function(){this.trId&&(f.cancel(this.trId),this.trId=null);this.trlTime&&(k.cancel(this.trlTime),this.trlTime=null);this.trActive=!1;this.$tw.remove()};
l.append(this.$tw);this.s1t(this.twp);angular.isDefined(g.options)?a.updateOptions(g.options):(0==g.allowAnimation&&(a.options.allowAnimation=g.allowAnimation),1==g.allowDrag&&(a.options.allowDrag=g.allowDrag),0==g.allowDrop&&(a.options.allowDrop=g.allowDrop),angular.isDefined(g.animationSpeed)&&200!==g.animationSpeed&&(a.options.animationSpeed=g.animationSpeed),0==g.allowFocus&&(a.options.allowFocus=g.allowFocus),1==g.autoCheck&&(a.options.autoCheck=g.autoCheck),0==g.autoExpand&&(a.options.autoExpand=
g.autoExpand),angular.isDefined(g.checkboxSettings)&&a.updateCheckBoxSettings(g.checkboxSettings),angular.isDefined(g.controlStyle)&&a.updateControlStyle(g.controlStyle),angular.isDefined(g.editorSettings)&&a.updateEditorSettings(g.editorSettings),angular.isDefined(g.fields)&&(a.updateDataFields(g.fields),a.updateData()),!0===g.hoverSelection&&(a.options.hoverSelection=g.hoverSelection),angular.isDefined(g.indent)&&(a.options.indent=g.indent),angular.isDefined(g.itemIcon)&&(a.options.itemIcon=g.itemIcon),
angular.isDefined(g.labelEdit)&&(a.options.labelEdit=g.labelEdit),!0===g.rtl&&(a.options.rtl=g.rtl),angular.isDefined(g.selectedIndex)&&(a.options.selectedIndex=g.selectedIndex),angular.isDefined(g.selectedItem)&&(a.options.selectedItem=g.selectedItem),angular.isDefined(g.selectionMode)&&(a.options.selectionMode=g.selectionMode),!0===g.showCheckBoxes&&(a.options.showCheckBoxes=g.showCheckBoxes),!1===g.showExpandBoxes&&(a.options.showExpandBoxes=g.showExpandBoxes),!1===g.showIcons&&(a.options.showIcons=
g.showIcons),!0===g.showStatusIcons&&(a.options.showStatusIcons=g.showStatusIcons),angular.isDefined(g.sorting)&&(a.options.sorting=g.sorting),angular.isDefined(g.templateSettings)&&a.updateTemplateSettings(g.templateSettings));var Ab=k(function(){a.updateLayout();k.cancel(Ab)},250)}}}]);